(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define("Debugger", [], factory);
	else if(typeof exports === 'object')
		exports["Debugger"] = factory();
	else
		root["Debugger"] = factory();
})(typeof self !== 'undefined' ? self : this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 45);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = require("debug");

/***/ }),
/* 1 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/regenerator");

/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/helpers/toConsumableArray");

/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/helpers/defineProperty");

/***/ }),
/* 4 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/helpers/slicedToArray");

/***/ }),
/* 5 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/core-js/object/entries");

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.prefixName = prefixName;
exports.keccak256 = keccak256;

var _utils = __webpack_require__(15);

function prefixName(prefix, fn) {
  Object.defineProperty(fn, 'name', {
    value: prefix + "." + fn.name,
    configurable: true
  });

  return fn;
}

/**
 * @return 0x-prefix string of keccak256 hash
 */
function keccak256() {
  return (0, _utils.toHexString)(_utils.keccak256.apply(undefined, arguments));
}

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _extends2 = __webpack_require__(13);

var _extends3 = _interopRequireDefault(_extends2);

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _entries = __webpack_require__(5);

var _entries2 = _interopRequireDefault(_entries);

var _assign = __webpack_require__(8);

var _assign2 = _interopRequireDefault(_assign);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _reselectTree = __webpack_require__(12);

var _selectors = __webpack_require__(24);

var _selectors2 = _interopRequireDefault(_selectors);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:evm:selectors");

var WORD_SIZE = 0x20;

/**
 * create EVM-level selectors for a given trace step selector
 * may specify additional selectors to include
 */
function createStepSelectors(step) {
  var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

  var base = {
    /**
     * .trace
     *
     * trace step info related to operation
     */
    trace: (0, _reselectTree.createLeaf)([step], function (_ref) {
      var gasCost = _ref.gasCost,
          op = _ref.op,
          pc = _ref.pc;
      return { gasCost: gasCost, op: op, pc: pc };
    }),

    /**
     * .programCounter
     */
    programCounter: (0, _reselectTree.createLeaf)(["./trace"], function (step) {
      return step.pc;
    }),

    /**
     * .isJump
     */
    isJump: (0, _reselectTree.createLeaf)(["./trace"], function (step) {
      return step.op != "JUMPDEST" && step.op.indexOf("JUMP") == 0;
    }),

    /**
     * .isCall
     *
     * whether the opcode will switch to another calling context
     */
    isCall: (0, _reselectTree.createLeaf)(["./trace"], function (step) {
      return step.op == "CALL" || step.op == "DELEGATECALL";
    }),

    /**
     * .isCreate
     */
    isCreate: (0, _reselectTree.createLeaf)(["./trace"], function (step) {
      return step.op == "CREATE";
    }),

    /**
     * .isHalting
     *
     * whether the instruction halts or returns from a calling context
     */
    isHalting: (0, _reselectTree.createLeaf)(["./trace"], function (step) {
      return step.op == "STOP" || step.op == "RETURN";
    })
  };

  if (state) {
    var isRelative = function isRelative(path) {
      return typeof path == "string" && (path.startsWith("./") || path.startsWith("../"));
    };

    if (isRelative(state)) {
      state = "../" + state;
    }

    (0, _assign2.default)(base, {
      /**
       * .callAddress
       *
       * address transferred to by call operation
       */
      callAddress: (0, _reselectTree.createLeaf)(["./isCall", "./trace", state], function (matches, step, _ref2) {
        var stack = _ref2.stack;

        if (!matches) return null;

        var address = stack[stack.length - 2];
        address = "0x" + address.substring(24);
        return address;
      }),

      /**
       * .createBinary
       *
       * binary code to execute via create operation
       */
      createBinary: (0, _reselectTree.createLeaf)(["./isCreate", "./trace", state], function (matches, step, _ref3) {
        var stack = _ref3.stack,
            memory = _ref3.memory;

        if (!matches) return null;

        // Get the code that's going to be created from memory.
        // Note we multiply by 2 because these offsets are in bytes.
        var offset = parseInt(stack[stack.length - 2], 16) * 2;
        var length = parseInt(stack[stack.length - 3], 16) * 2;

        return "0x" + memory.join("").substring(offset, offset + length);
      })
    });
  }

  return base;
}

var evm = (0, _reselectTree.createSelectorTree)({
  /**
   * evm.state
   */
  state: function state(_state) {
    return _state.evm;
  },

  /**
   * evm.info
   */
  info: {
    /**
     * evm.info.contexts
     */
    contexts: (0, _reselectTree.createLeaf)(['/state'], function (state) {
      return state.info.contexts.byContext;
    }),

    /**
     * evm.info.instances
     */
    instances: (0, _reselectTree.createLeaf)(['/state'], function (state) {
      return state.info.instances.byAddress;
    }),

    /**
     * evm.info.binaries
     */
    binaries: {
      _: (0, _reselectTree.createLeaf)(['/state'], function (state) {
        return state.info.contexts.byBinary;
      }),

      /**
       * evm.info.binaries.search
       *
       * returns function (binary) => context
       */
      search: (0, _reselectTree.createLeaf)(['./_'], function (binaries) {
        // HACK ignore link references for search
        // link references come in two forms: with underscores or all zeroes
        // the underscore format is used by Truffle to reference links by name
        // zeroes are used by solc directly, as libraries inject their own
        // address at CREATE-time
        var toRegExp = function toRegExp(binary) {
          return new RegExp("^" + binary.replace(/__.{38}|0{40}/g, ".{40}"));
        };

        var matchers = (0, _entries2.default)(binaries).map(function (_ref4) {
          var _ref5 = (0, _slicedToArray3.default)(_ref4, 2),
              binary = _ref5[0],
              context = _ref5[1].context;

          return {
            context: context,
            regex: toRegExp(binary)
          };
        });

        return function (binary) {
          return matchers.filter(function (_ref6) {
            var context = _ref6.context,
                regex = _ref6.regex;
            return binary.match(regex);
          }).map(function (_ref7) {
            var context = _ref7.context;
            return { context: context };
          })[0] || null;
        };
      })
    }
  },

  /**
   * evm.current
   */
  current: {

    /**
     * evm.current.callstack
     */
    callstack: function callstack(state) {
      return state.evm.proc.callstack;
    },

    /**
     * evm.current.call
     */
    call: (0, _reselectTree.createLeaf)(["./callstack"], function (stack) {
      return stack.length ? stack[stack.length - 1] : {};
    }),

    /**
     * evm.current.context
     */
    context: (0, _reselectTree.createLeaf)(["./call", "/info/instances", "/info/binaries/search", "/info/contexts"], function (_ref8, instances, search, contexts) {
      var address = _ref8.address,
          binary = _ref8.binary;

      var record = void 0;
      if (address) {
        record = instances[address];
        binary = record.binary;
      } else {
        record = search(binary);
      }

      var context = contexts[(record || {}).context];

      return (0, _extends3.default)({}, context, {
        binary: binary
      });
    }),

    /**
     * evm.current.state
     *
     * evm state info: as of last operation, before op defined in step
     */
    state: _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)(["depth", "error", "gas", "memory", "stack", "storage"].map(function (param) {
      return (0, _defineProperty3.default)({}, param, (0, _reselectTree.createLeaf)([_selectors2.default.step], function (step) {
        return step[param];
      }));
    })))),

    /**
     * evm.current.step
     */
    step: createStepSelectors(_selectors2.default.step, "./state")
  },

  /**
   * evm.next
   */
  next: {

    /**
     * evm.next.state
     *
     * evm state as a result of next step operation
     */
    state: _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)(["depth", "error", "gas", "memory", "stack", "storage"].map(function (param) {
      return (0, _defineProperty3.default)({}, param, (0, _reselectTree.createLeaf)([_selectors2.default.next], function (step) {
        return step[param];
      }));
    })))),

    step: createStepSelectors(_selectors2.default.next, "./state")
  }
});

exports.default = evm;

/***/ }),
/* 8 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/core-js/object/assign");

/***/ }),
/* 9 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _getIterator2 = __webpack_require__(16);

var _getIterator3 = _interopRequireDefault(_getIterator2);

var _extends2 = __webpack_require__(13);

var _extends3 = _interopRequireDefault(_extends2);

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _entries = __webpack_require__(5);

var _entries2 = _interopRequireDefault(_entries);

var _assign = __webpack_require__(8);

var _assign2 = _interopRequireDefault(_assign);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _reselectTree = __webpack_require__(12);

var _truffleSolidityUtils = __webpack_require__(58);

var _truffleSolidityUtils2 = _interopRequireDefault(_truffleSolidityUtils);

var _truffleCodeUtils = __webpack_require__(59);

var _truffleCodeUtils2 = _interopRequireDefault(_truffleCodeUtils);

var _selectors = __webpack_require__(7);

var _selectors2 = _interopRequireDefault(_selectors);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:solidity:selectors");

function getSourceRange() {
  var instruction = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

  return {
    start: instruction.start || 0,
    length: instruction.length || 0,
    lines: instruction.range || {
      start: {
        line: 0, column: 0
      },
      end: {
        line: 0, column: 0
      }
    }
  };
}

var solidity = (0, _reselectTree.createSelectorTree)({
  /**
   * solidity.state
   */
  state: function state(_state) {
    return _state.solidity;
  },

  /**
   * solidity.info
   */
  info: {
    /**
     * solidity.info.sources
     */
    sources: (0, _reselectTree.createLeaf)(['/state'], function (state) {
      return state.info.sources.byId;
    }),

    /**
     * solidity.info.sourceMaps
     */
    sourceMaps: (0, _reselectTree.createLeaf)(['/state'], function (state) {
      return state.info.sourceMaps.byContext;
    })
  },

  /**
   * solidity.current
   */
  current: {

    /**
     * solidity.current.sourceMap
     */
    sourceMap: (0, _reselectTree.createLeaf)([_selectors2.default.current.context, "/info/sourceMaps"], function (_ref, sourceMaps) {
      var context = _ref.context;
      return sourceMaps[context] || {};
    }),

    /**
     * solidity.current.functionDepth
     */
    functionDepth: function functionDepth(state) {
      return state.solidity.proc.functionDepth;
    },

    /**
     * solidity.current.instructions
     */
    instructions: (0, _reselectTree.createLeaf)(["/info/sources", _selectors2.default.current.context, "./sourceMap"], function (sources, _ref2, _ref3) {
      var binary = _ref2.binary;
      var sourceMap = _ref3.sourceMap;

      var instructions = _truffleCodeUtils2.default.parseCode(binary);

      if (!sourceMap) {
        // Let's create a source map to use since none exists. This source map
        // maps just as many ranges as there are instructions, and ensures every
        // instruction is marked as "jumping out". This will ensure all
        // available debugger commands step one instruction at a time.
        //
        // This is kindof a hack; perhaps this should be broken out into separate
        // context types. TODO
        sourceMap = "";
        for (var i = 0; i < instructions.length; i++) {
          sourceMap += i + ":" + i + ":1:-1;";
        }
      }

      var lineAndColumnMappings = _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(sources).map(function (_ref4) {
        var _ref5 = (0, _slicedToArray3.default)(_ref4, 2),
            id = _ref5[0],
            source = _ref5[1].source;

        return (0, _defineProperty3.default)({}, id, _truffleSolidityUtils2.default.getCharacterOffsetToLineAndColumnMapping(source || ""));
      }))));
      var humanReadableSourceMap = _truffleSolidityUtils2.default.getHumanReadableSourceMap(sourceMap);

      var primaryFile = humanReadableSourceMap[0].file;
      debug("primaryFile %o", primaryFile);

      return instructions.map(function (instruction, index) {
        // lookup source map by index and add `index` property to
        // instruction
        //

        var sourceMap = humanReadableSourceMap[index] || {};

        return {
          instruction: (0, _extends3.default)({}, instruction, { index: index }),
          sourceMap: sourceMap
        };
      }).map(function (_ref7) {
        var instruction = _ref7.instruction,
            sourceMap = _ref7.sourceMap;

        // add source map information to instruction, or defaults
        //

        var jump = sourceMap.jump,
            _sourceMap$start = sourceMap.start,
            start = _sourceMap$start === undefined ? 0 : _sourceMap$start,
            _sourceMap$length = sourceMap.length,
            length = _sourceMap$length === undefined ? 0 : _sourceMap$length,
            _sourceMap$file = sourceMap.file,
            file = _sourceMap$file === undefined ? primaryFile : _sourceMap$file;

        var lineAndColumnMapping = lineAndColumnMappings[file] || {};
        var range = {
          start: lineAndColumnMapping[start] || { line: null, column: null },
          end: lineAndColumnMapping[start + length] || { line: null, column: null }
        };

        if (range.start.line === null) {
          debug("sourceMap %o", sourceMap);
        }

        return (0, _extends3.default)({}, instruction, {

          jump: jump,
          start: start,
          length: length,
          file: file,
          range: range
        });
      });
    }),

    /**
     * solidity.current.instructionAtProgramCounter
     */
    instructionAtProgramCounter: (0, _reselectTree.createLeaf)(["./instructions"], function (instructions) {
      var map = [];
      instructions.forEach(function (instruction) {
        map[instruction.pc] = instruction;
      });

      // fill in gaps in map by defaulting to the last known instruction
      var lastSeen = null;
      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = (0, _getIterator3.default)(map.entries()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var _ref8 = _step.value;

          var _ref9 = (0, _slicedToArray3.default)(_ref8, 2);

          var pc = _ref9[0];
          var instruction = _ref9[1];

          if (instruction) {
            lastSeen = instruction;
          } else {
            map[pc] = lastSeen;
          }
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }

      return map;
    }),

    /**
     * solidity.current.instruction
     */
    instruction: (0, _reselectTree.createLeaf)(["./instructionAtProgramCounter", _selectors2.default.current.step.programCounter], function (map, pc) {
      return map[pc] || {};
    }),

    /**
     * solidity.current.source
     */
    source: (0, _reselectTree.createLeaf)(["/info/sources", "./instruction"], function (sources, _ref10) {
      var id = _ref10.file;
      return sources[id] || {};
    }),

    /**
     * solidity.current.sourceRange
     */
    sourceRange: (0, _reselectTree.createLeaf)(["./instruction"], getSourceRange),

    /**
     * solidity.current.isSourceRangeFinal
     */
    isSourceRangeFinal: (0, _reselectTree.createLeaf)(["./instructionAtProgramCounter", _selectors2.default.current.step.programCounter, _selectors2.default.next.step.programCounter], function (map, current, next) {
      if (!map[next]) {
        return true;
      }

      current = map[current];
      next = map[next];

      return current.start != next.start || current.length != next.length || current.file != next.file;
    }),

    /**
     * solidity.current.isMultiline
     */
    isMultiline: (0, _reselectTree.createLeaf)(["./sourceRange"], function (_ref11) {
      var lines = _ref11.lines;
      return lines.start.line != lines.end.line;
    }),

    /**
     * solidity.current.willJump
     */
    willJump: (0, _reselectTree.createLeaf)([_selectors2.default.current.step.isJump], function (isJump) {
      return isJump;
    }),

    /**
     * solidity.current.jumpDirection
     */
    jumpDirection: (0, _reselectTree.createLeaf)(["./instruction"], function () {
      var i = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return i.jump || "-";
    })
  }
});

exports.default = solidity;

/***/ }),
/* 10 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/helpers/asyncToGenerator");

/***/ }),
/* 11 */
/***/ (function(module, exports) {

module.exports = require("web3");

/***/ }),
/* 12 */
/***/ (function(module, exports) {

module.exports = require("reselect-tree");

/***/ }),
/* 13 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/helpers/extends");

/***/ }),
/* 14 */
/***/ (function(module, exports) {

module.exports = require("redux-saga/effects");

/***/ }),
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.MAX_WORD = exports.WORD_SIZE = undefined;

var _getIterator2 = __webpack_require__(16);

var _getIterator3 = _interopRequireDefault(_getIterator2);

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _entries = __webpack_require__(5);

var _entries2 = _interopRequireDefault(_entries);

var _assign = __webpack_require__(8);

var _assign2 = _interopRequireDefault(_assign);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _typeof2 = __webpack_require__(35);

var _typeof3 = _interopRequireDefault(_typeof2);

exports.cleanBigNumbers = cleanBigNumbers;
exports.typeIdentifier = typeIdentifier;
exports.typeClass = typeClass;
exports.allocateDeclarations = allocateDeclarations;
exports.specifiedSize = specifiedSize;
exports.storageSize = storageSize;
exports.isReference = isReference;
exports.referenceType = referenceType;
exports.baseDefinition = baseDefinition;
exports.toBigNumber = toBigNumber;
exports.toSignedBigNumber = toSignedBigNumber;
exports.toHexString = toHexString;
exports.toBytes = toBytes;
exports.keccak256 = keccak256;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _bignumber = __webpack_require__(25);

var _web = __webpack_require__(11);

var _web2 = _interopRequireDefault(_web);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:data:decode:utils");

var WORD_SIZE = exports.WORD_SIZE = 0x20;
var MAX_WORD = exports.MAX_WORD = new _bignumber.BigNumber(2).pow(256).minus(1);

/**
 * recursively converts big numbers into something nicer to look at
 */
function cleanBigNumbers(value) {
  if (_bignumber.BigNumber.isBigNumber(value)) {
    return value.toNumber();
  } else if (value && value.map != undefined) {
    return value.map(function (inner) {
      return cleanBigNumbers(inner);
    });
  } else if (value && (typeof value === "undefined" ? "undefined" : (0, _typeof3.default)(value)) == "object") {
    return _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(value).map(function (_ref) {
      var _ref2 = (0, _slicedToArray3.default)(_ref, 2),
          key = _ref2[0],
          inner = _ref2[1];

      return (0, _defineProperty3.default)({}, key, cleanBigNumbers(inner));
    }))));
  } else {
    return value;
  }
}

function typeIdentifier(definition) {
  return definition.typeDescriptions.typeIdentifier;
}

/**
 * returns basic type class for a variable definition node
 * e.g.:
 *  `t_uint256` becomes `uint`
 *  `t_struct$_Thing_$20_memory_ptr` becomes `struct`
 */
function typeClass(definition) {
  return typeIdentifier(definition).match(/t_([^$_0-9]+)/)[1];
}

/**
 * Allocate storage for given variable declarations
 *
 * Postcondition: starts a new slot and occupies whole slots
 */
function allocateDeclarations(declarations, refs) {
  var slot = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
  var index = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : WORD_SIZE - 1;
  var path = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];

  if (index < WORD_SIZE - 1) {
    // starts a new slot
    slot++;
    index = WORD_SIZE - 1;
  }

  var parentFrom = { slot: slot, index: 0 };
  var parentTo = { slot: slot, index: WORD_SIZE - 1 };
  var mapping = {};

  var _iteratorNormalCompletion = true;
  var _didIteratorError = false;
  var _iteratorError = undefined;

  try {
    for (var _iterator = (0, _getIterator3.default)(declarations), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
      var declaration = _step.value;

      var _allocateDeclaration = allocateDeclaration(declaration, refs, slot, index),
          from = _allocateDeclaration.from,
          to = _allocateDeclaration.to,
          next = _allocateDeclaration.next,
          children = _allocateDeclaration.children;

      mapping[declaration.id] = { from: from, to: to, name: declaration.name };
      if (children !== undefined) {
        mapping[declaration.id].children = children;
      }

      slot = next.slot;
      index = next.index;

      parentTo = { slot: to.slot, index: WORD_SIZE - 1 };
    }
  } catch (err) {
    _didIteratorError = true;
    _iteratorError = err;
  } finally {
    try {
      if (!_iteratorNormalCompletion && _iterator.return) {
        _iterator.return();
      }
    } finally {
      if (_didIteratorError) {
        throw _iteratorError;
      }
    }
  }

  if (index < WORD_SIZE - 1) {
    slot++;
    index = WORD_SIZE - 1;
  }

  return {
    from: parentFrom,
    to: parentTo,
    next: { slot: slot, index: index },
    children: mapping
  };
}

function allocateValue(slot, index, bytes) {
  var from = index - bytes + 1 >= 0 ? { slot: slot, index: index - bytes + 1 } : { slot: slot + 1, index: WORD_SIZE - bytes };

  var to = { slot: from.slot, index: from.index + bytes - 1 };

  var next = from.index == 0 ? { slot: from.slot + 1, index: WORD_SIZE - 1 } : { slot: from.slot, index: from.index - 1 };

  return { from: from, to: to, next: next };
}

function allocateDeclaration(declaration, refs, slot, index) {
  var definition = refs[declaration.id].definition;
  var byteSize = storageSize(definition); // yum

  if (typeClass(definition) != "struct") {
    return allocateValue(slot, index, byteSize);
  }

  var struct = refs[definition.typeName.referencedDeclaration];
  debug("struct: %O", struct);

  var result = allocateDeclarations(struct.variables || [], refs, slot, index);
  debug("struct result %o", result);
  return result;
}

/**
 * e.g. uint48 -> 6
 * @return size in bytes for explicit type size, or `null` if not stated
 */
function specifiedSize(definition) {
  var specified = typeIdentifier(definition).match(/t_[a-z]+([0-9]+)/);

  if (!specified) {
    return null;
  }

  var num = specified[1];

  switch (typeClass(definition)) {
    case "int":
    case "uint":
      return num / 8;

    case "bytes":
      return num;

    default:
      debug("Unknown type for size specification: %s", typeIdentifier(definition));
  }
}

function storageSize(definition) {
  switch (typeClass(definition)) {
    case "bool":
      return 1;

    case "address":
      return 20;

    case "int":
    case "uint":
      // is this a HACK? ("256" / 8)
      return typeIdentifier(definition).match(/t_[a-z]+([0-9]+)/)[1] / 8;

    case "string":
    case "bytes":
    case "array":
      return WORD_SIZE;
  }
}

function isReference(definition) {
  return typeIdentifier(definition).match(/_(memory|storage)(_ptr)?$/) != null;
}

function referenceType(definition) {
  return typeIdentifier(definition).match(/_([^_]+)(_ptr)?$/)[1];
}

function baseDefinition(definition) {
  var baseIdentifier = typeIdentifier(definition)
  // first dollar sign     last dollar sign
  //   `---------.       ,---'
  .match(/^[^$]+\$_(.+)_\$[^$]+$/)[1];
  //              `----' greedy match

  // HACK - internal types for memory or storage also seem to be pointers
  if (baseIdentifier.match(/_(memory|storage)$/) != null) {
    baseIdentifier = baseIdentifier + "_ptr";
  }

  // another HACK - we get away with it becausewe're only using that one property
  return {
    typeDescriptions: {
      typeIdentifier: baseIdentifier
    }
  };
}

function toBigNumber(bytes) {
  if (bytes == undefined) {
    return undefined;
  } else if (typeof bytes == "string") {
    return new _bignumber.BigNumber(bytes, 16);
  } else if (typeof bytes == "number" || _bignumber.BigNumber.isBigNumber(bytes)) {
    return new _bignumber.BigNumber(bytes);
  } else if (bytes.reduce) {
    return bytes.reduce(function (num, byte) {
      return num.times(0x100).plus(byte);
    }, new _bignumber.BigNumber(0));
  }
}

function toSignedBigNumber(bytes) {
  if (bytes[0] < 128) {
    // first bit is 0
    return toBigNumber(bytes);
  } else {
    return toBigNumber(bytes.map(function (b) {
      return 0xff - b;
    })).plus(1).negated();
  }
}

/**
 * @param bytes - Uint8Array
 * @param length - desired byte length (pad with zeroes)
 * @param trim - omit leading zeroes
 */
function toHexString(bytes) {
  var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
  var trim = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

  if (typeof length == "boolean") {
    trim = length;
    length = 0;
  }

  if (_bignumber.BigNumber.isBigNumber(bytes)) {
    bytes = toBytes(bytes);
  }

  var pad = function pad(s) {
    return "" + "00".slice(0, 2 - s.length) + s;
  };

  //                                          0  1  2  3  4
  //                                 0  1  2  3  4  5  6  7
  // bytes.length:        5  -  0x(          e5 c2 aa 09 11 )
  // length (preferred):  8  -  0x( 00 00 00 e5 c2 aa 09 11 )
  //                                `--.---'
  //                                     offset 3
  if (bytes.length < length) {
    var prior = bytes;
    bytes = new Uint8Array(length);

    bytes.set(prior, length - prior.length);
  }

  debug("bytes: %o", bytes);

  var string = bytes.reduce(function (str, byte) {
    return "" + str + pad(byte.toString(16));
  }, "");

  if (trim) {
    string = string.replace(/^(00)+/, "");
  }

  if (string.length == 0) {
    string = "00";
  }

  return "0x" + string;
}

function toBytes(number) {
  var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

  if (number < 0) {
    return [];
  }

  var hex = number.toString(16);
  if (hex.length % 2 == 1) {
    hex = "0" + hex;
  }

  var bytes = new Uint8Array(hex.match(/.{2}/g).map(function (byte) {
    return parseInt(byte, 16);
  }));

  if (bytes.length < length) {
    var prior = bytes;
    bytes = new Uint8Array(length);
    bytes.set(prior, length - prior.length);
  }

  return bytes;
}

function keccak256() {
  var _web3$utils;

  for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  var web3 = new _web2.default();

  debug("args %o", args);

  args = args.map(function (arg) {
    if (typeof arg == "number" || _bignumber.BigNumber.isBigNumber(arg)) {
      return toHexString(toBytes(arg, WORD_SIZE)).slice(2);
    } else if (typeof arg == "string") {
      return web3.utils.toHex(arg).slice(2);
    } else {
      return "";
    }
  });

  debug("processed args %o", args);

  var sha = (_web3$utils = web3.utils).soliditySha3.apply(_web3$utils, (0, _toConsumableArray3.default)(args));
  debug("sha %o", sha);
  return toBigNumber(sha);
}

/***/ }),
/* 16 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/core-js/get-iterator");

/***/ }),
/* 17 */
/***/ (function(module, exports) {

module.exports = require("chai");

/***/ }),
/* 18 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.gatherArtifacts = exports.migrate = exports.compile = exports.defaultMigrations = exports.addMigrations = exports.addContracts = exports.createSandbox = exports.prepareContracts = undefined;

var _getIterator2 = __webpack_require__(16);

var _getIterator3 = _interopRequireDefault(_getIterator2);

var _promise = __webpack_require__(27);

var _promise2 = _interopRequireDefault(_promise);

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _keys = __webpack_require__(22);

var _keys2 = _interopRequireDefault(_keys);

var _asyncToGenerator2 = __webpack_require__(10);

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var prepareContracts = exports.prepareContracts = function () {
  var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee(provider) {
    var sources = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var migrations = arguments[2];

    var config, accounts, _ref2, contracts, files, contractNames, artifacts, abstractions;

    return _regenerator2.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.next = 2;
            return createSandbox();

          case 2:
            config = _context.sent;
            _context.next = 5;
            return getAccounts(provider);

          case 5:
            accounts = _context.sent;


            config.networks["debugger"] = {
              provider: provider,
              network_id: "*",
              from: accounts[0]
            };
            config.network = "debugger";

            _context.next = 10;
            return addContracts(config, sources);

          case 10:
            _context.next = 12;
            return compile(config);

          case 12:
            _ref2 = _context.sent;
            contracts = _ref2.contracts;
            files = _ref2.files;
            contractNames = (0, _keys2.default)(contracts);

            if (migrations) {
              _context.next = 20;
              break;
            }

            _context.next = 19;
            return defaultMigrations(contractNames);

          case 19:
            migrations = _context.sent;

          case 20:
            _context.next = 22;
            return addMigrations(config, migrations);

          case 22:
            _context.next = 24;
            return migrate(config);

          case 24:
            _context.next = 26;
            return gatherArtifacts(config);

          case 26:
            artifacts = _context.sent;

            debug("artifacts: %o", artifacts.map(function (a) {
              return a.contractName;
            }));

            abstractions = {};

            contractNames.forEach(function (name) {
              abstractions[name] = config.resolver.require(name);
            });

            return _context.abrupt("return", {
              files: files,
              abstractions: abstractions,
              artifacts: artifacts,
              config: config
            });

          case 31:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));

  return function prepareContracts(_x2) {
    return _ref.apply(this, arguments);
  };
}();

var createSandbox = exports.createSandbox = function () {
  var _ref3 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {
    var config;
    return _regenerator2.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            _context2.next = 2;
            return new _promise2.default(function (accept, reject) {
              _truffleBox2.default.sandbox(function (err, result) {
                if (err) return reject(err);
                result.resolver = new _truffleResolver2.default(result);
                result.artifactor = new _truffleArtifactor2.default(result.contracts_build_directory);
                result.networks = {};

                accept(result);
              });
            });

          case 2:
            config = _context2.sent;
            _context2.next = 5;
            return _fsExtra2.default.remove(_path2.default.join(config.contracts_directory, "MetaCoin.sol"));

          case 5:
            _context2.next = 7;
            return _fsExtra2.default.remove(_path2.default.join(config.contracts_directory, "ConvertLib.sol"));

          case 7:
            _context2.next = 9;
            return _fsExtra2.default.remove(_path2.default.join(config.migrations_directory, "2_deploy_contracts.js"));

          case 9:
            return _context2.abrupt("return", config);

          case 10:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  }));

  return function createSandbox() {
    return _ref3.apply(this, arguments);
  };
}();

var addContracts = exports.addContracts = function () {
  var _ref4 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3(config) {
    var sources = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    var promises, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, filename, source;

    return _regenerator2.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            promises = [];
            _iteratorNormalCompletion = true;
            _didIteratorError = false;
            _iteratorError = undefined;
            _context3.prev = 4;

            for (_iterator = (0, _getIterator3.default)((0, _keys2.default)(sources)); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
              filename = _step.value;
              source = sources[filename];

              promises.push(_fsExtra2.default.outputFile(_path2.default.join(config.contracts_directory, filename), source));
            }

            _context3.next = 12;
            break;

          case 8:
            _context3.prev = 8;
            _context3.t0 = _context3["catch"](4);
            _didIteratorError = true;
            _iteratorError = _context3.t0;

          case 12:
            _context3.prev = 12;
            _context3.prev = 13;

            if (!_iteratorNormalCompletion && _iterator.return) {
              _iterator.return();
            }

          case 15:
            _context3.prev = 15;

            if (!_didIteratorError) {
              _context3.next = 18;
              break;
            }

            throw _iteratorError;

          case 18:
            return _context3.finish(15);

          case 19:
            return _context3.finish(12);

          case 20:
            _context3.next = 22;
            return _promise2.default.all(promises);

          case 22:
            return _context3.abrupt("return", _context3.sent);

          case 23:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, this, [[4, 8, 12, 20], [13,, 15, 19]]);
  }));

  return function addContracts(_x4) {
    return _ref4.apply(this, arguments);
  };
}();

var addMigrations = exports.addMigrations = function () {
  var _ref5 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee4(config) {
    var migrations = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    var promises, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, filename, source;

    return _regenerator2.default.wrap(function _callee4$(_context4) {
      while (1) {
        switch (_context4.prev = _context4.next) {
          case 0:
            promises = [];
            _iteratorNormalCompletion2 = true;
            _didIteratorError2 = false;
            _iteratorError2 = undefined;
            _context4.prev = 4;

            for (_iterator2 = (0, _getIterator3.default)((0, _keys2.default)(migrations)); !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
              filename = _step2.value;
              source = migrations[filename];

              promises.push(_fsExtra2.default.outputFile(_path2.default.join(config.migrations_directory, filename), source));
            }

            _context4.next = 12;
            break;

          case 8:
            _context4.prev = 8;
            _context4.t0 = _context4["catch"](4);
            _didIteratorError2 = true;
            _iteratorError2 = _context4.t0;

          case 12:
            _context4.prev = 12;
            _context4.prev = 13;

            if (!_iteratorNormalCompletion2 && _iterator2.return) {
              _iterator2.return();
            }

          case 15:
            _context4.prev = 15;

            if (!_didIteratorError2) {
              _context4.next = 18;
              break;
            }

            throw _iteratorError2;

          case 18:
            return _context4.finish(15);

          case 19:
            return _context4.finish(12);

          case 20:
            _context4.next = 22;
            return _promise2.default.all(promises);

          case 22:
            return _context4.abrupt("return", _context4.sent);

          case 23:
          case "end":
            return _context4.stop();
        }
      }
    }, _callee4, this, [[4, 8, 12, 20], [13,, 15, 19]]);
  }));

  return function addMigrations(_x6) {
    return _ref5.apply(this, arguments);
  };
}();

var defaultMigrations = exports.defaultMigrations = function () {
  var _ref6 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee5(contractNames) {
    var migrations;
    return _regenerator2.default.wrap(function _callee5$(_context5) {
      while (1) {
        switch (_context5.prev = _context5.next) {
          case 0:
            contractNames = contractNames.filter(function (name) {
              return name != "Migrations";
            });

            migrations = {};


            contractNames.forEach(function (contractName, i) {
              var index = i + 2; // start at 2 cause Migrations migration
              var filename = index + "_migrate_" + contractName + ".js";
              var source = "\n      var " + contractName + " = artifacts.require(\"" + contractName + "\");\n\n      module.exports = function(deployer) {\n        deployer.deploy(" + contractName + ");\n      };\n    ";

              migrations[filename] = source;
            });

            return _context5.abrupt("return", migrations);

          case 4:
          case "end":
            return _context5.stop();
        }
      }
    }, _callee5, this);
  }));

  return function defaultMigrations(_x7) {
    return _ref6.apply(this, arguments);
  };
}();

var compile = exports.compile = function () {
  var _ref7 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee6(config) {
    return _regenerator2.default.wrap(function _callee6$(_context6) {
      while (1) {
        switch (_context6.prev = _context6.next) {
          case 0:
            return _context6.abrupt("return", new _promise2.default(function (accept, reject) {
              _truffleWorkflowCompile2.default.compile(config.with({
                all: true,
                quiet: true
              }), function (err, contracts, files) {
                if (err) return reject(err);
                return accept({ contracts: contracts, files: files });
              });
            }));

          case 1:
          case "end":
            return _context6.stop();
        }
      }
    }, _callee6, this);
  }));

  return function compile(_x8) {
    return _ref7.apply(this, arguments);
  };
}();

var migrate = exports.migrate = function () {
  var _ref8 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee7(config) {
    return _regenerator2.default.wrap(function _callee7$(_context7) {
      while (1) {
        switch (_context7.prev = _context7.next) {
          case 0:
            return _context7.abrupt("return", new _promise2.default(function (accept, reject) {
              _truffleMigrate2.default.run(config.with({
                quiet: true
              }), function (err, contracts) {
                if (err) return reject(err);
                accept(contracts);
              });
            }));

          case 1:
          case "end":
            return _context7.stop();
        }
      }
    }, _callee7, this);
  }));

  return function migrate(_x9) {
    return _ref8.apply(this, arguments);
  };
}();

var gatherArtifacts = exports.gatherArtifacts = function () {
  var _ref9 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee8(config) {
    return _regenerator2.default.wrap(function _callee8$(_context8) {
      while (1) {
        switch (_context8.prev = _context8.next) {
          case 0:
            return _context8.abrupt("return", _truffleDebugUtils2.default.gatherArtifacts(config));

          case 1:
          case "end":
            return _context8.stop();
        }
      }
    }, _callee8, this);
  }));

  return function gatherArtifacts(_x10) {
    return _ref9.apply(this, arguments);
  };
}();

exports.getAccounts = getAccounts;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _path = __webpack_require__(47);

var _path2 = _interopRequireDefault(_path);

var _fsExtra = __webpack_require__(48);

var _fsExtra2 = _interopRequireDefault(_fsExtra);

var _async = __webpack_require__(49);

var _async2 = _interopRequireDefault(_async);

var _truffleWorkflowCompile = __webpack_require__(50);

var _truffleWorkflowCompile2 = _interopRequireDefault(_truffleWorkflowCompile);

var _truffleDebugUtils = __webpack_require__(51);

var _truffleDebugUtils2 = _interopRequireDefault(_truffleDebugUtils);

var _truffleArtifactor = __webpack_require__(52);

var _truffleArtifactor2 = _interopRequireDefault(_truffleArtifactor);

var _web = __webpack_require__(11);

var _web2 = _interopRequireDefault(_web);

var _truffleMigrate = __webpack_require__(53);

var _truffleMigrate2 = _interopRequireDefault(_truffleMigrate);

var _truffleBox = __webpack_require__(54);

var _truffleBox2 = _interopRequireDefault(_truffleBox);

var _truffleResolver = __webpack_require__(55);

var _truffleResolver2 = _interopRequireDefault(_truffleResolver);

var _truffleExpect = __webpack_require__(34);

var _truffleExpect2 = _interopRequireDefault(_truffleExpect);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var debug = (0, _debug2.default)("test:helpers");

function getAccounts(provider) {
  var web3 = new _web2.default(provider);
  return new _promise2.default(function (accept, reject) {
    web3.eth.getAccounts(function (err, accounts) {
      if (err) return reject(err);
      accept(accounts);
    });
  });
}

/***/ }),
/* 19 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _reselectTree = __webpack_require__(12);

var _jsonPointer = __webpack_require__(30);

var _jsonPointer2 = _interopRequireDefault(_jsonPointer);

var _selectors = __webpack_require__(9);

var _selectors2 = _interopRequireDefault(_selectors);

var _map = __webpack_require__(36);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:ast:selectors");

/**
 * ast
 */
var ast = (0, _reselectTree.createSelectorTree)({
  /**
   * ast.views
   */
  views: {
    /**
     * ast.views.sources
     */
    sources: (0, _reselectTree.createLeaf)([_selectors2.default.info.sources], function (sources) {
      return sources;
    })
  },

  /**
   * ast.current
   */
  current: {

    /**
     * ast.current.tree
     *
     * ast for current source
     */
    tree: (0, _reselectTree.createLeaf)([_selectors2.default.current.source], function (_ref) {
      var ast = _ref.ast;
      return ast;
    }),

    /**
     * ast.current.index
     *
     * source ID
     */
    index: (0, _reselectTree.createLeaf)([_selectors2.default.current.source], function (_ref2) {
      var id = _ref2.id;
      return id;
    }),

    /**
     * ast.current.pointer
     *
     * jsonpointer for current ast node
     */
    pointer: (0, _reselectTree.createLeaf)(["./tree", _selectors2.default.current.sourceRange], function (ast, range) {
      return (0, _map.findRange)(ast, range.start, range.length);
    }),

    /**
     * ast.current.node
     *
     * current ast node to execute
     */
    node: (0, _reselectTree.createLeaf)(["./tree", "./pointer"], function (ast, pointer) {
      return pointer ? _jsonPointer2.default.get(ast, pointer) : _jsonPointer2.default.get(ast, "");
    })

  }
});

exports.default = ast;

/***/ }),
/* 20 */
/***/ (function(module, exports) {

module.exports = require("redux");

/***/ }),
/* 21 */
/***/ (function(module, exports) {

module.exports = require("ganache-cli");

/***/ }),
/* 22 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/core-js/object/keys");

/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _asyncToGenerator2 = __webpack_require__(10);

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _classCallCheck2 = __webpack_require__(28);

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = __webpack_require__(29);

var _createClass3 = _interopRequireDefault(_createClass2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _truffleExpect = __webpack_require__(34);

var _truffleExpect2 = _interopRequireDefault(_truffleExpect);

var _session = __webpack_require__(56);

var _session2 = _interopRequireDefault(_session);

var _reselectTree = __webpack_require__(12);

var _selectors = __webpack_require__(32);

var _selectors2 = _interopRequireDefault(_selectors);

var _selectors3 = __webpack_require__(19);

var _selectors4 = _interopRequireDefault(_selectors3);

var _selectors5 = __webpack_require__(24);

var _selectors6 = _interopRequireDefault(_selectors5);

var _selectors7 = __webpack_require__(7);

var _selectors8 = _interopRequireDefault(_selectors7);

var _selectors9 = __webpack_require__(9);

var _selectors10 = _interopRequireDefault(_selectors9);

var _selectors11 = __webpack_require__(43);

var _selectors12 = _interopRequireDefault(_selectors11);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger");

/**
 * @example
 * let session = Debugger
 *   .forTx(<txHash>, {
 *     contracts: [<contract obj>, ...],
 *     provider: <provider instance>
 *   })
 *   .connect();
 */

var Debugger = function () {
  /**
   * @param {Session} session - debugger session
   * @private
   */
  function Debugger(session) {
    (0, _classCallCheck3.default)(this, Debugger);

    /**
     * @private
     */
    this._session = session;
  }

  /**
   * Instantiates a Debugger for a given transaction hash.
   *
   * @param {String} txHash - transaction hash with leading "0x"
   * @param {{contracts: Array<Contract>, files: Array<String>, provider: Web3Provider}} options -
   * @return {Debugger} instance
   */

  (0, _createClass3.default)(Debugger, [{
    key: "connect",

    /**
     * Connects to the instantiated Debugger.
     *
     * @return {Session} session instance
     */
    value: function connect() {
      return this._session;
    }

    /**
     * Exported selectors
     *
     * See individual selector docs for full listing
     *
     * @example
     * Debugger.selectors.ast.current.tree
     *
     * @example
     * Debugger.selectors.solidity.current.instruction
     *
     * @example
     * Debugger.selectors.trace.steps
     */

  }], [{
    key: "forTx",
    value: function () {
      var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee(txHash) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        var session;
        return _regenerator2.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _truffleExpect2.default.options(options, ["contracts", "provider"]);

                session = new _session2.default(options.contracts, options.files, txHash, options.provider);
                _context.prev = 2;
                _context.next = 5;
                return session.ready();

              case 5:
                _context.next = 10;
                break;

              case 7:
                _context.prev = 7;
                _context.t0 = _context["catch"](2);
                throw _context.t0;

              case 10:
                return _context.abrupt("return", new this(session));

              case 11:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this, [[2, 7]]);
      }));

      function forTx(_x2) {
        return _ref.apply(this, arguments);
      }

      return forTx;
    }()
  }, {
    key: "selectors",
    get: function get() {
      return (0, _reselectTree.createNestedSelector)({
        ast: _selectors4.default,
        data: _selectors2.default,
        trace: _selectors6.default,
        evm: _selectors8.default,
        solidity: _selectors10.default,
        session: _selectors12.default
      });
    }
  }]);
  return Debugger;
}();

/**
 * @typedef {Object} Contract
 * @property {string} contractName contract name
 * @property {string} source solidity source code
 * @property {string} sourcePath path to source file
 * @property {string} binary 0x-prefixed hex string with create bytecode
 * @property {string} sourceMap solidity source map for create bytecode
 * @property {Object} ast Abstract Syntax Tree from Solidity
 * @property {string} deployedBinary 0x-prefixed compiled binary (on chain)
 * @property {string} deployedSourceMap solidity source map for on-chain bytecode
 */

exports.default = Debugger;

/***/ }),
/* 24 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _reselectTree = __webpack_require__(12);

var trace = (0, _reselectTree.createSelectorTree)({
  /**
   * trace.index
   *
   * current step index
   */
  index: function index(state) {
    return state.trace.proc.index;
  },

  /**
   * trace.steps
   *
   * all trace steps
   */
  steps: function steps(state) {
    return state.trace.info.steps;
  },

  /**
   * trace.stepsRemaining
   *
   * number of steps remaining in trace
   */
  stepsRemaining: (0, _reselectTree.createLeaf)(["./steps", "./index"], function (steps, index) {
    return steps.length - index;
  }),

  /**
   * trace.step
   *
   * current trace step
   */
  step: (0, _reselectTree.createLeaf)(["./steps", "./index"], function (steps, index) {
    return steps[index];
  }),

  /**
   * trace.next
   *
   * next trace step or {}
   */
  next: (0, _reselectTree.createLeaf)(["./steps", "./index"], function (steps, index) {
    return index < steps.length - 1 ? steps[index + 1] : {};
  })
});

exports.default = trace;

/***/ }),
/* 25 */
/***/ (function(module, exports) {

module.exports = require("bignumber.js");

/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.saveSteps = saveSteps;
exports.receiveAddresses = receiveAddresses;
exports.next = next;
exports.tick = tick;
exports.tock = tock;
exports.endTrace = endTrace;
var SAVE_STEPS = exports.SAVE_STEPS = "SAVE_STEPS";
function saveSteps(steps) {
  return {
    type: SAVE_STEPS,
    steps: steps
  };
}

var RECEIVE_ADDRESSES = exports.RECEIVE_ADDRESSES = "RECEIVE_ADDRESSES";
function receiveAddresses(addresses) {
  return {
    type: RECEIVE_ADDRESSES,
    addresses: addresses
  };
}

var NEXT = exports.NEXT = "NEXT";
function next() {
  return { type: NEXT };
}

var TICK = exports.TICK = "TICK";
function tick() {
  return { type: TICK };
}

var TOCK = exports.TOCK = "TOCK";
function tock() {
  return { type: TOCK };
}

var END_OF_TRACE = exports.END_OF_TRACE = "EOT";
function endTrace() {
  return { type: END_OF_TRACE };
}

/***/ }),
/* 27 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/core-js/promise");

/***/ }),
/* 28 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/helpers/classCallCheck");

/***/ }),
/* 29 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/helpers/createClass");

/***/ }),
/* 30 */
/***/ (function(module, exports) {

module.exports = require("json-pointer");

/***/ }),
/* 31 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.start = start;
exports.ready = ready;
exports.error = error;
exports.finish = finish;
exports.recordContracts = recordContracts;
var START = exports.START = "SESSION_START";
function start(txHash, provider) {
  return {
    type: START,
    txHash: txHash, provider: provider
  };
}

var READY = exports.READY = "SESSION_READY";
function ready() {
  return {
    type: READY
  };
}

var ERROR = exports.ERROR = "SESSION_ERROR";
function error(error) {
  return {
    type: ERROR,
    error: error
  };
}

var FINISH = exports.FINISH = "SESSION_FINISH";
function finish() {
  return {
    type: FINISH
  };
}

var RECORD_CONTRACTS = exports.RECORD_CONTRACTS = "RECORD_CONTRACTS";
function recordContracts(contexts, sources) {
  return {
    type: RECORD_CONTRACTS,
    contexts: contexts, sources: sources
  };
}

/***/ }),
/* 32 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends2 = __webpack_require__(13);

var _extends3 = _interopRequireDefault(_extends2);

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _entries = __webpack_require__(5);

var _entries2 = _interopRequireDefault(_entries);

var _assign = __webpack_require__(8);

var _assign2 = _interopRequireDefault(_assign);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _reselectTree = __webpack_require__(12);

var _jsonPointer = __webpack_require__(30);

var _jsonPointer2 = _interopRequireDefault(_jsonPointer);

var _selectors = __webpack_require__(19);

var _selectors2 = _interopRequireDefault(_selectors);

var _selectors3 = __webpack_require__(7);

var _selectors4 = _interopRequireDefault(_selectors3);

var _selectors5 = __webpack_require__(9);

var _selectors6 = _interopRequireDefault(_selectors5);

var _decode = __webpack_require__(68);

var _decode2 = _interopRequireDefault(_decode);

var _utils = __webpack_require__(15);

var decodeUtils = _interopRequireWildcard(_utils);

var _bignumber = __webpack_require__(25);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:data:selectors");

function createStateSelectors(_ref) {
  var stack = _ref.stack,
      memory = _ref.memory,
      storage = _ref.storage;

  return {
    /**
     * .stack
     */
    stack: (0, _reselectTree.createLeaf)([stack], function (words) {
      return (words || []).map(function (word) {
        return decodeUtils.toBytes(decodeUtils.toBigNumber(word, decodeUtils.WORD_SIZE));
      });
    }),

    /**
     * .memory
     */
    memory: (0, _reselectTree.createLeaf)([memory], function (words) {
      return new Uint8Array((words.join("").match(/.{1,2}/g) || []).map(function (byte) {
        return parseInt(byte, 16);
      }));
    }),

    /**
     * .storage
     */
    storage: (0, _reselectTree.createLeaf)([storage], function (mapping) {
      return _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(mapping).map(function (_ref2) {
        var _ref3 = (0, _slicedToArray3.default)(_ref2, 2),
            address = _ref3[0],
            word = _ref3[1];

        return (0, _defineProperty3.default)({}, "0x" + address, new Uint8Array((word.match(/.{1,2}/g) || []).map(function (byte) {
          return parseInt(byte, 16);
        })));
      }))));
    })
  };
}

var data = (0, _reselectTree.createSelectorTree)({
  state: function state(_state) {
    return _state.data;
  },

  /**
   * data.views
   */
  views: {
    ast: (0, _reselectTree.createLeaf)([_selectors2.default.current], function (tree) {
      return tree;
    }),

    atLastInstructionForSourceRange: (0, _reselectTree.createLeaf)([_selectors6.default.current.isSourceRangeFinal], function (final) {
      return final;
    }),

    /**
     * data.views.scopes
     */
    scopes: {

      /**
       * data.views.scopes.inlined
       */
      inlined: (0, _reselectTree.createLeaf)(["/info/scopes", _selectors6.default.info.sources], function (scopes, sources) {
        return _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(scopes).map(function (_ref5) {
          var _ref6 = (0, _slicedToArray3.default)(_ref5, 2),
              id = _ref6[0],
              entry = _ref6[1];

          return (0, _defineProperty3.default)({}, id, (0, _extends3.default)({}, entry, {

            definition: _jsonPointer2.default.get(sources[entry.sourceId].ast, entry.pointer)
          }));
        }))));
      })
    },

    /**
     * data.views.decoder
     *
     * selector returns (ast node definition, data reference) => value
     */
    decoder: (0, _reselectTree.createLeaf)(["/views/scopes/inlined", "/current/state"], function (scopes, state) {
      return function (definition, ref) {
        return (0, _decode2.default)(definition, ref, state, scopes);
      };
    })
  },

  /**
   * data.info
   */
  info: {

    /**
     * data.info.scopes
     */
    scopes: (0, _reselectTree.createLeaf)(["/state"], function (state) {
      return state.info.scopes.byId;
    })
  },

  /**
   * data.proc
   */
  proc: {

    /**
     * data.proc.assignments
     */
    assignments: (0, _reselectTree.createLeaf)(["/state"], function (state) {
      return state.proc.assignments.byId;
    })
  },

  /**
   * data.current
   */
  current: {
    /**
     *
     * data.current.scope
     */
    scope: {

      /**
       * data.current.scope.id
       */
      id: (0, _reselectTree.createLeaf)([_selectors2.default.current.node], function (node) {
        return node.id;
      })
    },

    /**
     * data.current.state
     */
    state: createStateSelectors(_selectors4.default.current.state),

    /**
     * data.current.identifiers (namespace)
     */
    identifiers: {

      /**
       * data.current.identifiers (selector)
       *
       * returns identifers and corresponding definition node ID
       */
      _: (0, _reselectTree.createLeaf)(["/views/scopes/inlined", "/current/scope"], function (scopes, scope) {
        var cur = scope.id;
        var variables = {};

        do {
          variables = _assign2.default.apply(Object, [variables].concat((0, _toConsumableArray3.default)((scopes[cur].variables || []).filter(function (v) {
            return variables[v.name] == undefined;
          }).map(function (v) {
            return (0, _defineProperty3.default)({}, v.name, v.id);
          }))));

          cur = scopes[cur].parentId;
        } while (cur != null);

        return variables;
      }),

      /**
       * data.current.identifiers.definitions
       *
       * current variable definitions
       */
      definitions: (0, _reselectTree.createLeaf)(["/views/scopes/inlined", "./_"], function (scopes, identifiers) {
        return _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(identifiers).map(function (_ref9) {
          var _ref10 = (0, _slicedToArray3.default)(_ref9, 2),
              identifier = _ref10[0],
              id = _ref10[1];

          var definition = scopes[id].definition;

          return (0, _defineProperty3.default)({}, identifier, definition);
        }))));
      }),

      /**
       * data.current.identifiers.refs
       *
       * current variables' value refs
       */
      refs: (0, _reselectTree.createLeaf)(["/proc/assignments", "./_"], function (assignments, identifiers) {
        return _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(identifiers).map(function (_ref12) {
          var _ref13 = (0, _slicedToArray3.default)(_ref12, 2),
              identifier = _ref13[0],
              id = _ref13[1];

          var _ref14 = assignments[id] || {},
              ref = _ref14.ref;

          if (!ref) {
            return undefined;
          };

          return (0, _defineProperty3.default)({}, identifier, ref);
        }))));
      }),

      decoded: (0, _reselectTree.createLeaf)(["/views/decoder", "./definitions", "./refs"], function (decode, definitions, refs) {
        return _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(refs).map(function (_ref16) {
          var _ref17 = (0, _slicedToArray3.default)(_ref16, 2),
              identifier = _ref17[0],
              ref = _ref17[1];

          return (0, _defineProperty3.default)({}, identifier, decode(definitions[identifier], ref));
        }))));
      }),

      native: (0, _reselectTree.createLeaf)(['./decoded'], decodeUtils.cleanBigNumbers)
    }
  },

  /**
   * data.next
   */
  next: {

    /**
     * data.next.state
     */
    state: createStateSelectors(_selectors4.default.next.state)
  }
});

exports.default = data;

/***/ }),
/* 33 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/core-js/set");

/***/ }),
/* 34 */
/***/ (function(module, exports) {

module.exports = require("truffle-expect");

/***/ }),
/* 35 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/helpers/typeof");

/***/ }),
/* 36 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _keys = __webpack_require__(22);

var _keys2 = _interopRequireDefault(_keys);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

exports.getRange = getRange;
exports.rangeNodes = rangeNodes;
exports.findRange = findRange;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _nodeIntervalTree = __webpack_require__(60);

var _nodeIntervalTree2 = _interopRequireDefault(_nodeIntervalTree);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:ast:map");

/**
 * @private
 */
function getRange(node) {
  // src: "<start>:<length>:<_>"
  // returns [start, end]
  var _node$src$split$slice = node.src.split(":").slice(0, 2).map(function (i) {
    return parseInt(i);
  }),
      _node$src$split$slice2 = (0, _slicedToArray3.default)(_node$src$split$slice, 2),
      start = _node$src$split$slice2[0],
      length = _node$src$split$slice2[1];

  return [start, start + length];
}

/**
 * @private
 */
function rangeNodes(node) {
  var pointer = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "";

  if (node instanceof Array) {
    var _ref;

    return (_ref = []).concat.apply(_ref, (0, _toConsumableArray3.default)(node.map(function (sub, i) {
      return rangeNodes(sub, pointer + "/" + i);
    })));
  } else if (node instanceof Object) {
    var results = [];

    if (node.src) {
      results.push({ pointer: pointer, range: getRange(node) });
    }

    return results.concat.apply(results, (0, _toConsumableArray3.default)((0, _keys2.default)(node).map(function (key) {
      return rangeNodes(node[key], pointer + "/" + key);
    })));
  } else {
    return [];
  }
}

/**
 * @private
 */
function findRange(node, sourceStart, sourceLength) {
  var ranges = rangeNodes(node);
  var tree = new _nodeIntervalTree2.default();

  ranges.forEach(function (_ref2) {
    var range = _ref2.range,
        pointer = _ref2.pointer;

    var _range = (0, _slicedToArray3.default)(range, 2),
        start = _range[0],
        end = _range[1];

    tree.insert(start, end, { range: range, pointer: pointer });
  });

  var sourceEnd = sourceStart + sourceLength;

  var overlapping = tree.search(sourceStart, sourceEnd);

  // find nodes that fully contain requested range,
  // return longest pointer
  return overlapping.filter(function (_ref3) {
    var range = _ref3.range;
    return sourceStart >= range[0] && sourceEnd <= range[1];
  }).map(function (_ref4) {
    var pointer = _ref4.pointer;
    return pointer;
  }).reduce(function (a, b) {
    return a.length > b.length ? a : b;
  }, "");
}

/***/ }),
/* 37 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.beginStep = beginStep;
exports.advance = advance;
exports.stepNext = stepNext;
exports.stepOver = stepOver;
exports.stepInto = stepInto;
exports.stepOut = stepOut;
exports.interrupt = interrupt;
exports.continueUntil = continueUntil;
var BEGIN_STEP = exports.BEGIN_STEP = "BEGIN_STEP";
function beginStep(type) {
  return {
    type: BEGIN_STEP,
    stepType: type
  };
}

var ADVANCE = exports.ADVANCE = "ADVANCE";
function advance() {
  return { type: ADVANCE };
}

var STEP_NEXT = exports.STEP_NEXT = "STEP_NEXT";
function stepNext() {
  return { type: STEP_NEXT };
}

var STEP_OVER = exports.STEP_OVER = "STEP_OVER";
function stepOver() {
  return { type: STEP_OVER };
}

var STEP_INTO = exports.STEP_INTO = "STEP_INTO";
function stepInto() {
  return { type: STEP_INTO };
}

var STEP_OUT = exports.STEP_OUT = "STEP_OUT";
function stepOut() {
  return { type: STEP_OUT };
}

var INTERRUPT = exports.INTERRUPT = "INTERRUPT";
function interrupt() {
  return { type: INTERRUPT };
}

var CONTINUE_UNTIL = exports.CONTINUE_UNTIL = "CONTINUE_UNTIL";
function continueUntil() {
  for (var _len = arguments.length, breakpoints = Array(_len), _key = 0; _key < _len; _key++) {
    breakpoints[_key] = arguments[_key];
  }

  return {
    type: CONTINUE_UNTIL,
    breakpoints: breakpoints
  };
}

/***/ }),
/* 38 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _entries = __webpack_require__(5);

var _entries2 = _interopRequireDefault(_entries);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _assign = __webpack_require__(8);

var _assign2 = _interopRequireDefault(_assign);

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

exports.scope = scope;
exports.declare = declare;
exports.saga = saga;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _effects = __webpack_require__(14);

var _jsonPointer = __webpack_require__(30);

var _jsonPointer2 = _interopRequireDefault(_jsonPointer);

var _helpers = __webpack_require__(6);

var _actions = __webpack_require__(26);

var _actions2 = __webpack_require__(39);

var actions = _interopRequireWildcard(_actions2);

var _selectors = __webpack_require__(32);

var _selectors2 = _interopRequireDefault(_selectors);

var _utils = __webpack_require__(15);

var utils = _interopRequireWildcard(_utils);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var _marked = /*#__PURE__*/_regenerator2.default.mark(scope),
    _marked2 = /*#__PURE__*/_regenerator2.default.mark(declare),
    _marked3 = /*#__PURE__*/_regenerator2.default.mark(tickSaga),
    _marked4 = /*#__PURE__*/_regenerator2.default.mark(saga);

var debug = (0, _debug2.default)("debugger:data:sagas");

function scope(nodeId, pointer, parentId, sourceId) {
  return _regenerator2.default.wrap(function scope$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          _context.next = 2;
          return (0, _effects.put)(actions.scope(nodeId, pointer, parentId, sourceId));

        case 2:
        case "end":
          return _context.stop();
      }
    }
  }, _marked, this);
}

function declare(node) {
  return _regenerator2.default.wrap(function declare$(_context2) {
    while (1) {
      switch (_context2.prev = _context2.next) {
        case 0:
          _context2.next = 2;
          return (0, _effects.put)(actions.declare(node));

        case 2:
        case "end":
          return _context2.stop();
      }
    }
  }, _marked2, this);
}

function tickSaga() {
  var _ref, tree, treeId, node, pointer, scopes, definitions, stack, top, parameters, returnParameters, assignments, storageVars, _storageVars, slot, index, allocation;

  return _regenerator2.default.wrap(function tickSaga$(_context3) {
    while (1) {
      switch (_context3.prev = _context3.next) {
        case 0:
          _context3.next = 2;
          return (0, _effects.select)(_selectors2.default.views.ast);

        case 2:
          _ref = _context3.sent;
          tree = _ref.tree;
          treeId = _ref.id;
          node = _ref.node;
          pointer = _ref.pointer;
          _context3.next = 9;
          return (0, _effects.select)(_selectors2.default.info.scopes);

        case 9:
          scopes = _context3.sent;
          _context3.next = 12;
          return (0, _effects.select)(_selectors2.default.views.scopes.inlined);

        case 12:
          definitions = _context3.sent;
          _context3.next = 15;
          return (0, _effects.select)(_selectors2.default.next.state.stack);

        case 15:
          stack = _context3.sent;

          if (stack) {
            _context3.next = 18;
            break;
          }

          return _context3.abrupt("return");

        case 18:
          top = stack.length - 1;

          if (node) {
            _context3.next = 21;
            break;
          }

          return _context3.abrupt("return");

        case 21:
          _context3.t0 = node.nodeType;
          _context3.next = _context3.t0 === "FunctionDefinition" ? 24 : _context3.t0 === "ContractDefinition" ? 34 : _context3.t0 === "VariableDeclaration" ? 44 : 46;
          break;

        case 24:
          _context3.next = 26;
          return (0, _effects.select)(_selectors2.default.views.atLastInstructionForSourceRange);

        case 26:
          if (_context3.sent) {
            _context3.next = 28;
            break;
          }

          return _context3.abrupt("break", 47);

        case 28:

          parameters = node.parameters.parameters.map(function (p, i) {
            return pointer + "/parameters/parameters/" + i;
          });

          returnParameters = node.returnParameters.parameters.map(function (p, i) {
            return pointer + "/returnParameters/parameters/" + i;
          });

          assignments = returnParameters.concat(parameters).reverse().map(function (pointer) {
            return _jsonPointer2.default.get(tree, pointer).id;
          }).map(function (id, i) {
            return (0, _defineProperty3.default)({}, id, { "stack": top - i });
          }).reduce(function (acc, assignment) {
            return (0, _assign2.default)(acc, assignment);
          }, {});

          _context3.next = 33;
          return (0, _effects.put)(actions.assign(treeId, assignments));

        case 33:
          return _context3.abrupt("break", 47);

        case 34:
          _storageVars = scopes[node.id].variables || [];
          slot = 0;
          index = _utils.WORD_SIZE - 1; // cause lower-order

          debug("storage vars %o", _storageVars);

          allocation = utils.allocateDeclarations(_storageVars, definitions);

          assignments = _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(allocation.children).map(function (_ref3) {
            var _ref4 = (0, _slicedToArray3.default)(_ref3, 2),
                id = _ref4[0],
                storage = _ref4[1];

            return (0, _defineProperty3.default)({}, id, { storage: storage });
          }))));
          debug("assignments %O", assignments);

          _context3.next = 43;
          return (0, _effects.put)(actions.assign(treeId, assignments));

        case 43:
          return _context3.abrupt("break", 47);

        case 44:
          _context3.next = 46;
          return (0, _effects.put)(actions.assign(treeId, (0, _defineProperty3.default)({}, _jsonPointer2.default.get(tree, pointer).id, { "stack": top })));

        case 46:
          return _context3.abrupt("break", 47);

        case 47:
        case "end":
          return _context3.stop();
      }
    }
  }, _marked3, this);
}

function saga() {
  return _regenerator2.default.wrap(function saga$(_context5) {
    while (1) {
      switch (_context5.prev = _context5.next) {
        case 0:
          _context5.next = 2;
          return (0, _effects.takeEvery)(_actions.TICK, /*#__PURE__*/_regenerator2.default.mark(function _callee() {
            return _regenerator2.default.wrap(function _callee$(_context4) {
              while (1) {
                switch (_context4.prev = _context4.next) {
                  case 0:
                    _context4.prev = 0;
                    return _context4.delegateYield(tickSaga(), "t0", 2);

                  case 2:
                    _context4.next = 7;
                    break;

                  case 4:
                    _context4.prev = 4;
                    _context4.t1 = _context4["catch"](0);

                    debug(_context4.t1);

                  case 7:
                  case "end":
                    return _context4.stop();
                }
              }
            }, _callee, this, [[0, 4]]);
          }));

        case 2:
        case "end":
          return _context5.stop();
      }
    }
  }, _marked4, this);
}

exports.default = (0, _helpers.prefixName)("data", saga);

/***/ }),
/* 39 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.scope = scope;
exports.declare = declare;
exports.assign = assign;
var SCOPE = exports.SCOPE = "SCOPE";
function scope(id, pointer, parentId, sourceId) {
  return {
    type: SCOPE,
    id: id, pointer: pointer, parentId: parentId, sourceId: sourceId
  };
}

var DECLARE = exports.DECLARE = "DECLARE_VARIABLE";
function declare(node) {
  return {
    type: DECLARE,
    node: node
  };
}

var ASSIGN = exports.ASSIGN = "ASSIGN";
function assign(context, assignments) {
  return {
    type: ASSIGN,
    context: context, assignments: assignments
  };
}

/***/ }),
/* 40 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _set = __webpack_require__(33);

var _set2 = _interopRequireDefault(_set);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

exports.advance = advance;
exports.wait = wait;
exports.processTrace = processTrace;
exports.saga = saga;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _effects = __webpack_require__(14);

var _helpers = __webpack_require__(6);

var _actions = __webpack_require__(26);

var actions = _interopRequireWildcard(_actions);

var _selectors = __webpack_require__(24);

var _selectors2 = _interopRequireDefault(_selectors);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var _marked = /*#__PURE__*/_regenerator2.default.mark(waitForTrace),
    _marked2 = /*#__PURE__*/_regenerator2.default.mark(advance),
    _marked3 = /*#__PURE__*/_regenerator2.default.mark(next),
    _marked4 = /*#__PURE__*/_regenerator2.default.mark(wait),
    _marked5 = /*#__PURE__*/_regenerator2.default.mark(processTrace),
    _marked6 = /*#__PURE__*/_regenerator2.default.mark(saga);

var debug = (0, _debug2.default)("debugger:trace:sagas");

function waitForTrace() {
  var _ref, steps, addresses;

  return _regenerator2.default.wrap(function waitForTrace$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          _context.next = 2;
          return (0, _effects.take)(actions.SAVE_STEPS);

        case 2:
          _ref = _context.sent;
          steps = _ref.steps;
          addresses = [].concat((0, _toConsumableArray3.default)(new _set2.default(steps.filter(function (_ref2) {
            var op = _ref2.op;
            return op == "CALL" || op == "DELEGATECALL";
          }).map(function (_ref3) {
            var stack = _ref3.stack;
            return "0x" + stack[stack.length - 2].substring(24);
          }))));
          _context.next = 7;
          return (0, _effects.put)(actions.receiveAddresses(addresses));

        case 7:
        case "end":
          return _context.stop();
      }
    }
  }, _marked, this);
}

function advance() {
  return _regenerator2.default.wrap(function advance$(_context2) {
    while (1) {
      switch (_context2.prev = _context2.next) {
        case 0:
          _context2.next = 2;
          return (0, _effects.put)(actions.next());

        case 2:
          _context2.next = 4;
          return (0, _effects.take)(actions.TOCK);

        case 4:
        case "end":
          return _context2.stop();
      }
    }
  }, _marked2, this);
}

function next() {
  var remaining, steps;
  return _regenerator2.default.wrap(function next$(_context3) {
    while (1) {
      switch (_context3.prev = _context3.next) {
        case 0:
          _context3.next = 2;
          return (0, _effects.select)(_selectors2.default.stepsRemaining);

        case 2:
          remaining = _context3.sent;

          debug("remaining: %o", remaining);
          _context3.next = 6;
          return (0, _effects.select)(_selectors2.default.steps);

        case 6:
          steps = _context3.sent;

          debug("total steps: %o", steps.length);

          if (!(remaining > 0)) {
            _context3.next = 14;
            break;
          }

          debug("putting TICK");
          // updates state for current step
          _context3.next = 12;
          return (0, _effects.put)(actions.tick());

        case 12:
          debug("put TICK");

          remaining--; // local update, just for convenience

        case 14:
          if (!remaining) {
            _context3.next = 21;
            break;
          }

          debug("putting TOCK");
          // updates step to next step in trace
          _context3.next = 18;
          return (0, _effects.put)(actions.tock());

        case 18:
          debug("put TOCK");

          _context3.next = 23;
          break;

        case 21:
          _context3.next = 23;
          return (0, _effects.put)(actions.endTrace());

        case 23:
        case "end":
          return _context3.stop();
      }
    }
  }, _marked3, this);
}

function wait() {
  return _regenerator2.default.wrap(function wait$(_context4) {
    while (1) {
      switch (_context4.prev = _context4.next) {
        case 0:
          _context4.next = 2;
          return (0, _effects.take)(actions.END_OF_TRACE);

        case 2:
        case "end":
          return _context4.stop();
      }
    }
  }, _marked4, this);
}

function processTrace(trace) {
  var _ref4, addresses;

  return _regenerator2.default.wrap(function processTrace$(_context5) {
    while (1) {
      switch (_context5.prev = _context5.next) {
        case 0:
          _context5.next = 2;
          return (0, _effects.put)(actions.saveSteps(trace));

        case 2:
          _context5.next = 4;
          return (0, _effects.take)(actions.RECEIVE_ADDRESSES);

        case 4:
          _ref4 = _context5.sent;
          addresses = _ref4.addresses;

          debug("received addresses");

          return _context5.abrupt("return", addresses);

        case 8:
        case "end":
          return _context5.stop();
      }
    }
  }, _marked5, this);
}

function saga() {
  return _regenerator2.default.wrap(function saga$(_context6) {
    while (1) {
      switch (_context6.prev = _context6.next) {
        case 0:
          return _context6.delegateYield(waitForTrace(), "t0", 1);

        case 1:
          _context6.next = 3;
          return (0, _effects.takeEvery)(actions.NEXT, next);

        case 3:
        case "end":
          return _context6.stop();
      }
    }
  }, _marked6, this);
}

exports.default = (0, _helpers.prefixName)("trace", saga);

/***/ }),
/* 41 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.addSource = addSource;
exports.addSourceMap = addSourceMap;
exports.jump = jump;
var ADD_SOURCE = exports.ADD_SOURCE = "SOLIDITY_ADD_SOURCE";
function addSource(source, sourcePath, ast) {
  return {
    type: ADD_SOURCE,
    source: source, sourcePath: sourcePath, ast: ast
  };
}

var ADD_SOURCEMAP = exports.ADD_SOURCEMAP = "SOLIDITY_ADD_SOURCEMAP";
function addSourceMap(binary, sourceMap) {
  return {
    type: ADD_SOURCEMAP,
    binary: binary, sourceMap: sourceMap
  };
}

var JUMP = exports.JUMP = "JUMP";
function jump(jumpDirection) {
  return {
    type: JUMP,
    jumpDirection: jumpDirection
  };
}

/***/ }),
/* 42 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.addContext = addContext;
exports.addInstance = addInstance;
exports.call = call;
exports.create = create;
exports.returnCall = returnCall;
var ADD_CONTEXT = exports.ADD_CONTEXT = "EVM_ADD_CONTEXT";
function addContext(contractName, binary) {
  return {
    type: ADD_CONTEXT,
    contractName: contractName, binary: binary
  };
}

var ADD_INSTANCE = exports.ADD_INSTANCE = "EVM_ADD_INSTANCE";
function addInstance(address, context, binary) {
  return {
    type: ADD_INSTANCE,
    address: address, context: context, binary: binary
  };
}

var CALL = exports.CALL = "CALL";
function call(address) {
  return {
    type: CALL,
    address: address
  };
}

var CREATE = exports.CREATE = "CREATE";
function create(binary) {
  return {
    type: CREATE,
    binary: binary
  };
}

var RETURN = exports.RETURN = "RETURN";
function returnCall() {
  return {
    type: RETURN
  };
}

/***/ }),
/* 43 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _entries = __webpack_require__(5);

var _entries2 = _interopRequireDefault(_entries);

var _assign = __webpack_require__(8);

var _assign2 = _interopRequireDefault(_assign);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _reselectTree = __webpack_require__(12);

var _selectors = __webpack_require__(7);

var _selectors2 = _interopRequireDefault(_selectors);

var _selectors3 = __webpack_require__(9);

var _selectors4 = _interopRequireDefault(_selectors3);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:session:selectors");

var session = (0, _reselectTree.createSelectorTree)({
  /**
   * session.info
   */
  info: {

    /**
     * session.info.affectedInstances
     */
    affectedInstances: (0, _reselectTree.createLeaf)([_selectors2.default.info.instances, _selectors2.default.info.contexts, _selectors4.default.info.sources, _selectors4.default.info.sourceMaps], function (instances, contexts, sources, sourceMaps) {
      return _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(instances).map(function (_ref) {
        var _ref2 = (0, _slicedToArray3.default)(_ref, 2),
            address = _ref2[0],
            context = _ref2[1].context;

        var _contexts$context = contexts[context],
            contractName = _contexts$context.contractName,
            binary = _contexts$context.binary;
        var sourceMap = sourceMaps[context].sourceMap;

        var _ref3 = sourceMap ?
        // look for source ID between second and third colons (HACK)
        sources[sourceMap.match(/^[^:]+:[^:]+:([^:]+):/)[1]] : {},
            source = _ref3.source;

        return (0, _defineProperty3.default)({}, address, {
          contractName: contractName, source: source, binary: binary
        });
      }))));
    })
  }
});

exports.default = session;

/***/ }),
/* 44 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _asyncToGenerator2 = __webpack_require__(10);

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _getIterator2 = __webpack_require__(16);

var _getIterator3 = _interopRequireDefault(_getIterator2);

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var prepareDebugger = function () {
  var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee(testName, sources) {
    var provider, web3, _ref3, abstractions, contracts, files, instance, receipt, txHash, bugger, session, breakpoint;

    return _regenerator2.default.wrap(function _callee$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            provider = _ganacheCli2.default.provider({ seed: "debugger", gasLimit: 7000000 });
            web3 = new _web2.default(provider);
            _context2.next = 4;
            return (0, _helpers.prepareContracts)(provider, sources);

          case 4:
            _ref3 = _context2.sent;
            abstractions = _ref3.abstractions;
            contracts = _ref3.artifacts;
            files = _ref3.files;
            _context2.next = 10;
            return abstractions[contractName(testName)].deployed();

          case 10:
            instance = _context2.sent;
            _context2.next = 13;
            return instance.run();

          case 13:
            receipt = _context2.sent;
            txHash = receipt.tx;
            _context2.next = 17;
            return _debugger2.default.forTx(txHash, { provider: provider, files: files, contracts: contracts });

          case 17:
            bugger = _context2.sent;
            session = bugger.connect();
            breakpoint = {
              address: instance.address,
              line: lastStatementLine(sources[fileName(testName)])
            };


            session.continueUntil(breakpoint);

            return _context2.abrupt("return", session);

          case 22:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee, this);
  }));

  return function prepareDebugger(_x, _x2) {
    return _ref2.apply(this, arguments);
  };
}();

var getDecode = function () {
  var _ref4 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2(session) {
    var definitions, refs, decode;
    return _regenerator2.default.wrap(function _callee2$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            definitions = session.view(_selectors2.default.current.identifiers.definitions);
            refs = session.view(_selectors2.default.current.identifiers.refs);
            decode = session.view(_selectors2.default.views.decoder);
            return _context3.abrupt("return", function (name) {
              return (0, _utils.cleanBigNumbers)(decode(definitions[name], refs[name]));
            });

          case 4:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee2, this);
  }));

  return function getDecode(_x3) {
    return _ref4.apply(this, arguments);
  };
}();

exports.generateUints = generateUints;
exports.describeDecoding = describeDecoding;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _ganacheCli = __webpack_require__(21);

var _ganacheCli2 = _interopRequireDefault(_ganacheCli);

var _web = __webpack_require__(11);

var _web2 = _interopRequireDefault(_web);

var _chai = __webpack_require__(17);

var _helpers = __webpack_require__(18);

var _debugger = __webpack_require__(23);

var _debugger2 = _interopRequireDefault(_debugger);

var _utils = __webpack_require__(15);

var _selectors = __webpack_require__(32);

var _selectors2 = _interopRequireDefault(_selectors);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _marked = /*#__PURE__*/_regenerator2.default.mark(generateUints);

var debug = (0, _debug2.default)("test:data:decode");

function generateUints() {
  var x;
  return _regenerator2.default.wrap(function generateUints$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          x = 0;

        case 1:
          if (false) {
            _context.next = 7;
            break;
          }

          _context.next = 4;
          return x;

        case 4:
          x++;
          _context.next = 1;
          break;

        case 7:
        case "end":
          return _context.stop();
      }
    }
  }, _marked, this);
}

function contractName(testName) {
  return testName.replace(/ /g, "");
}

function fileName(testName) {
  return contractName(testName) + ".sol";
}

function generateTests(fixtures) {
  var _this = this;

  var _loop = function _loop(_ref) {
    var name = _ref.name,
        expected = _ref.value;

    it("correctly decodes " + name, function () {
      _chai.assert.deepEqual(_this.decode(name), expected);
    });
  };

  var _iteratorNormalCompletion = true;
  var _didIteratorError = false;
  var _iteratorError = undefined;

  try {
    for (var _iterator = (0, _getIterator3.default)(fixtures), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
      var _ref = _step.value;

      _loop(_ref);
    }
  } catch (err) {
    _didIteratorError = true;
    _iteratorError = err;
  } finally {
    try {
      if (!_iteratorNormalCompletion && _iterator.return) {
        _iterator.return();
      }
    } finally {
      if (_didIteratorError) {
        throw _iteratorError;
      }
    }
  }
}

function lastStatementLine(source) {
  var lines = source.split("\n");
  for (var i = lines.length - 1; i >= 0; i--) {
    var line = lines[i];
    if (line.indexOf(";") != -1) {
      return i;
    }
  }
}

function describeDecoding(testName, fixtures, selector, generateSource) {
  var sources = (0, _defineProperty3.default)({}, fileName(testName), generateSource(contractName(testName)));

  describe(testName, function () {
    var _this2 = this;

    this.timeout(30000);

    before("runs and observes debugger", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {
      var session;
      return _regenerator2.default.wrap(function _callee3$(_context4) {
        while (1) {
          switch (_context4.prev = _context4.next) {
            case 0:
              _context4.next = 2;
              return prepareDebugger(testName, sources);

            case 2:
              session = _context4.sent;
              _context4.next = 5;
              return getDecode(session);

            case 5:
              _this2.decode = _context4.sent;


              if (selector) {
                debug("selector %O", session.view(selector));
              }

            case 7:
            case "end":
              return _context4.stop();
          }
        }
      }, _callee3, _this2);
    })));

    generateTests.bind(this)(fixtures);
  });
}

/***/ }),
/* 45 */
/***/ (function(module, exports, __webpack_require__) {

// runtime helper
function inManifest(id) { return global.__webpackManifest__.indexOf(id) >= 0;}
function run(id) { __webpack_require__(id);}

// modules to execute goes here
var ids = [
/*require.resolve*/(46),/*require.resolve*/(85),/*require.resolve*/(86),/*require.resolve*/(44),/*require.resolve*/(88),/*require.resolve*/(89),/*require.resolve*/(18),/*require.resolve*/(90)
];

ids.filter(inManifest).forEach(run)

/***/ }),
/* 46 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _asyncToGenerator2 = __webpack_require__(10);

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _chai = __webpack_require__(17);

var _ganacheCli = __webpack_require__(21);

var _ganacheCli2 = _interopRequireDefault(_ganacheCli);

var _web = __webpack_require__(11);

var _web2 = _interopRequireDefault(_web);

var _helpers = __webpack_require__(18);

var _debugger = __webpack_require__(23);

var _debugger2 = _interopRequireDefault(_debugger);

var _selectors = __webpack_require__(19);

var _selectors2 = _interopRequireDefault(_selectors);

var _selectors3 = __webpack_require__(9);

var _selectors4 = _interopRequireDefault(_selectors3);

var _map = __webpack_require__(36);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var debug = (0, _debug2.default)("test:ast");

var __VARIABLES = "\npragma solidity ^0.4.18;\n\ncontract Variables {\n  event Result(uint256 result);\n\n  uint256 qux;\n  string quux;\n\n  function stack(uint256 foo) public returns (uint256) {\n    uint256 bar = foo + 1;\n    uint256 baz = innerStack(bar);\n\n    baz += 4;\n\n    qux = baz;\n\n    Result(baz);\n\n    return baz;\n  }\n\n  function innerStack(uint256 baz) public returns (uint256) {\n    uint256 bar = baz + 2;\n    return bar;\n  }\n}\n";

var sources = {
  "Variables.sol": __VARIABLES
};

describe("AST", function () {
  var provider;
  var web3;

  var abstractions;
  var artifacts;
  var files;

  before("Create Provider", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {
    return _regenerator2.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            provider = _ganacheCli2.default.provider({ seed: "debugger", gasLimit: 7000000 });
            web3 = new _web2.default(provider);

          case 2:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  })));

  before("Prepare contracts and artifacts", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {
    var prepared;
    return _regenerator2.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            this.timeout(30000);

            _context2.next = 3;
            return (0, _helpers.prepareContracts)(provider, sources);

          case 3:
            prepared = _context2.sent;

            abstractions = prepared.abstractions;
            artifacts = prepared.artifacts;
            files = prepared.files;

          case 7:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  })));

  describe("Node pointer", function () {
    it("traverses", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {
      var instance, receipt, txHash, bugger, session, _session$view, start, length, end, node, _getRange, _getRange2, nodeStart, nodeLength, nodeEnd, pointer;

      return _regenerator2.default.wrap(function _callee3$(_context3) {
        while (1) {
          switch (_context3.prev = _context3.next) {
            case 0:
              this.timeout(0);
              _context3.next = 3;
              return abstractions.Variables.deployed();

            case 3:
              instance = _context3.sent;
              _context3.next = 6;
              return instance.stack(4);

            case 6:
              receipt = _context3.sent;
              txHash = receipt.tx;
              _context3.next = 10;
              return _debugger2.default.forTx(txHash, {
                provider: provider,
                files: files,
                contracts: artifacts
              });

            case 10:
              bugger = _context3.sent;
              session = bugger.connect();

              debug("ast: %O", session.view(_selectors2.default.current.tree));

              do {
                _session$view = session.view(_selectors4.default.current.sourceRange), start = _session$view.start, length = _session$view.length;
                end = start + length;
                node = session.view(_selectors2.default.current.node);
                _getRange = (0, _map.getRange)(node), _getRange2 = (0, _slicedToArray3.default)(_getRange, 2), nodeStart = _getRange2[0], nodeLength = _getRange2[1];
                nodeEnd = nodeStart + nodeLength;
                pointer = session.view(_selectors2.default.current.pointer);


                _chai.assert.isAtMost(nodeStart, start, "Node " + pointer + " at should not begin after instruction source range");
                _chai.assert.isAtLeast(nodeEnd, end, "Node " + pointer + " should not end after source");

                session.stepNext();
              } while (!session.finished);

            case 14:
            case "end":
              return _context3.stop();
          }
        }
      }, _callee3, this);
    })));
  });
});

/***/ }),
/* 47 */
/***/ (function(module, exports) {

module.exports = require("path");

/***/ }),
/* 48 */
/***/ (function(module, exports) {

module.exports = require("fs-extra");

/***/ }),
/* 49 */
/***/ (function(module, exports) {

module.exports = require("async");

/***/ }),
/* 50 */
/***/ (function(module, exports) {

module.exports = require("truffle-workflow-compile");

/***/ }),
/* 51 */
/***/ (function(module, exports) {

module.exports = require("truffle-debug-utils");

/***/ }),
/* 52 */
/***/ (function(module, exports) {

module.exports = require("truffle-artifactor");

/***/ }),
/* 53 */
/***/ (function(module, exports) {

module.exports = require("truffle-migrate");

/***/ }),
/* 54 */
/***/ (function(module, exports) {

module.exports = require("truffle-box");

/***/ }),
/* 55 */
/***/ (function(module, exports) {

module.exports = require("truffle-resolver");

/***/ }),
/* 56 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _getIterator2 = __webpack_require__(16);

var _getIterator3 = _interopRequireDefault(_getIterator2);

var _values = __webpack_require__(57);

var _values2 = _interopRequireDefault(_values);

var _typeof2 = __webpack_require__(35);

var _typeof3 = _interopRequireDefault(_typeof2);

var _promise = __webpack_require__(27);

var _promise2 = _interopRequireDefault(_promise);

var _classCallCheck2 = __webpack_require__(28);

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = __webpack_require__(29);

var _createClass3 = _interopRequireDefault(_createClass2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _selectors = __webpack_require__(24);

var _selectors2 = _interopRequireDefault(_selectors);

var _selectors3 = __webpack_require__(7);

var _selectors4 = _interopRequireDefault(_selectors3);

var _selectors5 = __webpack_require__(19);

var _selectors6 = _interopRequireDefault(_selectors5);

var _selectors7 = __webpack_require__(9);

var _selectors8 = _interopRequireDefault(_selectors7);

var _store = __webpack_require__(61);

var _store2 = _interopRequireDefault(_store);

var _actions = __webpack_require__(37);

var controller = _interopRequireWildcard(_actions);

var _actions2 = __webpack_require__(31);

var actions = _interopRequireWildcard(_actions2);

var _sagas = __webpack_require__(66);

var _sagas2 = _interopRequireDefault(_sagas);

var _reducers = __webpack_require__(79);

var _reducers2 = _interopRequireDefault(_reducers);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:session");

/**
 * Debugger Session
 */
var Session = function () {
  /**
   * @param {Array<Contract>} contracts - contract definitions
   * @param {Array<String>} files - array of filenames for sourceMap indexes
   * @param {string} txHash - transaction hash
   * @param {Web3Provider} provider - web3 provider
   * @private
   */
  function Session(contracts, files, txHash, provider) {
    (0, _classCallCheck3.default)(this, Session);

    /**
     * @private
     */
    this._store = (0, _store2.default)(_reducers2.default, _sagas2.default);

    var _Session$normalize = Session.normalize(contracts, files),
        contexts = _Session$normalize.contexts,
        sources = _Session$normalize.sources;

    // record contracts


    this._store.dispatch(actions.recordContracts(contexts, sources));

    this._store.dispatch(actions.start(txHash, provider));
  }

  (0, _createClass3.default)(Session, [{
    key: "ready",
    value: function ready() {
      var _this = this;

      return new _promise2.default(function (accept, reject) {
        _this._store.subscribe(function () {
          if (_this.state.session == "ACTIVE") {
            accept();
          } else if ((0, _typeof3.default)(_this.state.session) == "object") {
            reject(_this.state.session.error);
          }
        });
      });
    }

    /**
     * Split up artifacts into "contexts" and "sources", dividing artifact
     * data into appropriate buckets.
     *
     * Multiple contracts can be defined in the same source file, but have
     * different bytecodes.
     *
     * This iterates over the contracts and collects binaries separately
     * from sources, using the optional `files` argument to force
     * source ordering.
     * @private
     */

  }, {
    key: "view",
    value: function view(selector) {
      return selector(this.state);
    }
  }, {
    key: "dispatch",
    value: function dispatch(action) {
      if (this.finished) {
        debug("finished: intercepting action %o", action);

        return false;
      }

      this._store.dispatch(action);

      return true;
    }
  }, {
    key: "interrupt",
    value: function interrupt() {
      return this.dispatch(controller.interrupt());
    }
  }, {
    key: "advance",
    value: function advance() {
      return this.dispatch(controller.advance());
    }
  }, {
    key: "stepNext",
    value: function stepNext() {
      return this.dispatch(controller.stepNext());
    }
  }, {
    key: "stepOver",
    value: function stepOver() {
      return this.dispatch(controller.stepOver());
    }
  }, {
    key: "stepInto",
    value: function stepInto() {
      return this.dispatch(controller.stepInto());
    }
  }, {
    key: "stepOut",
    value: function stepOut() {
      return this.dispatch(controller.stepOut());
    }
  }, {
    key: "continueUntil",
    value: function continueUntil() {
      return this.dispatch(controller.continueUntil.apply(controller, arguments));
    }
  }, {
    key: "state",
    get: function get() {
      return this._store.getState();
    }
  }, {
    key: "finished",
    get: function get() {
      return this.state.session == "FINISHED";
    }
  }, {
    key: "failed",
    get: function get() {
      return this.finished && this.view(_selectors4.default.current.callstack).length;
    }
  }], [{
    key: "normalize",
    value: function normalize(contracts) {
      var files = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

      var sourcesByPath = {};
      var contexts = [];
      var sources = void 0;

      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = (0, _getIterator3.default)(contracts), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var contract = _step.value;
          var contractName = contract.contractName,
              binary = contract.binary,
              sourceMap = contract.sourceMap,
              deployedBinary = contract.deployedBinary,
              deployedSourceMap = contract.deployedSourceMap,
              sourcePath = contract.sourcePath,
              source = contract.source,
              _ast = contract.ast;

          sourcesByPath[sourcePath] = { sourcePath: sourcePath, source: source, ast: _ast };

          if (binary && binary != "0x") {
            contexts.push({
              contractName: contractName,
              binary: binary,
              sourceMap: sourceMap
            });
          }

          if (deployedBinary && deployedBinary != "0x") {
            contexts.push({
              contractName: contractName,
              binary: deployedBinary,
              sourceMap: deployedSourceMap
            });
          }
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }

      if (!files) {
        sources = (0, _values2.default)(sourcesByPath);
      } else {
        sources = files.map(function (file) {
          return sourcesByPath[file];
        });
      }

      return { contexts: contexts, sources: sources };
    }
  }]);
  return Session;
}();

exports.default = Session;

/***/ }),
/* 57 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/core-js/object/values");

/***/ }),
/* 58 */
/***/ (function(module, exports) {

module.exports = require("truffle-solidity-utils");

/***/ }),
/* 59 */
/***/ (function(module, exports) {

module.exports = require("truffle-code-utils");

/***/ }),
/* 60 */
/***/ (function(module, exports) {

module.exports = require("node-interval-tree");

/***/ }),
/* 61 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


if (false) {
  module.exports = require("./production");
} else if (true) {
  module.exports = __webpack_require__(62);
} else {
  module.exports = require("./development");
}

/***/ }),
/* 62 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _common = __webpack_require__(63);

var _common2 = _interopRequireDefault(_common);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

exports.default = _common2.default;

/***/ }),
/* 63 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _entries = __webpack_require__(5);

var _entries2 = _interopRequireDefault(_entries);

var _assign = __webpack_require__(8);

var _assign2 = _interopRequireDefault(_assign);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

exports.abbreviateValues = abbreviateValues;
exports.default = configureStore;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _redux = __webpack_require__(20);

var _reduxSaga = __webpack_require__(64);

var _reduxSaga2 = _interopRequireDefault(_reduxSaga);

var _reduxCliLogger = __webpack_require__(65);

var _reduxCliLogger2 = _interopRequireDefault(_reduxCliLogger);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:store:common");
var reduxDebug = (0, _debug2.default)("debugger:redux");

function abbreviateValues(value) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

  options.stringLimit = options.stringLimit || 66;
  options.arrayLimit = options.arrayLimit || 8;
  options.recurseLimit = options.recurseLimit || 4;

  if (depth > options.recurseLimit) {
    return "...";
  }

  var recurse = function recurse(child) {
    return abbreviateValues(child, options, depth + 1);
  };

  if (value instanceof Array) {
    if (value.length > options.arrayLimit) {
      value = [].concat((0, _toConsumableArray3.default)(value.slice(0, options.arrayLimit / 2)), ["..."], (0, _toConsumableArray3.default)(value.slice(value.length - options.arrayLimit / 2 + 1)));
    }

    return value.map(recurse);
  } else if (value instanceof Object) {
    return _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(value).map(function (_ref) {
      var _ref2 = (0, _slicedToArray3.default)(_ref, 2),
          k = _ref2[0],
          v = _ref2[1];

      return (0, _defineProperty3.default)({}, recurse(k), recurse(v));
    }))));
  } else if (typeof value === "string" && value.length > options.stringLimit) {
    var inner = "...";
    var extractAmount = (options.stringLimit - inner.length) / 2;
    var leading = value.slice(0, Math.ceil(extractAmount));
    var trailing = value.slice(value.length - Math.floor(extractAmount));
    return "" + leading + inner + trailing;
  } else {
    return value;
  }
}

function configureStore(reducer, saga, initialState, composeEnhancers) {
  var sagaMiddleware = (0, _reduxSaga2.default)();

  if (!composeEnhancers) {
    composeEnhancers = _redux.compose;
  }

  var loggerMiddleware = (0, _reduxCliLogger2.default)({
    log: reduxDebug,
    stateTransformer: function stateTransformer(state) {
      return abbreviateValues(state, {
        arrayLimit: 4,
        recurseLimit: 3
      });
    },
    actionTransformer: abbreviateValues
  });

  var store = (0, _redux.createStore)(reducer, initialState, composeEnhancers((0, _redux.applyMiddleware)(sagaMiddleware, loggerMiddleware)));

  sagaMiddleware.run(saga);

  return store;
}

/***/ }),
/* 64 */
/***/ (function(module, exports) {

module.exports = require("redux-saga");

/***/ }),
/* 65 */
/***/ (function(module, exports) {

module.exports = require("redux-cli-logger");

/***/ }),
/* 66 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _getIterator2 = __webpack_require__(16);

var _getIterator3 = _interopRequireDefault(_getIterator2);

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

exports.saga = saga;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _effects = __webpack_require__(14);

var _helpers = __webpack_require__(6);

var _sagas = __webpack_require__(67);

var ast = _interopRequireWildcard(_sagas);

var _sagas2 = __webpack_require__(72);

var controller = _interopRequireWildcard(_sagas2);

var _sagas3 = __webpack_require__(74);

var solidity = _interopRequireWildcard(_sagas3);

var _sagas4 = __webpack_require__(75);

var evm = _interopRequireWildcard(_sagas4);

var _sagas5 = __webpack_require__(40);

var trace = _interopRequireWildcard(_sagas5);

var _sagas6 = __webpack_require__(38);

var data = _interopRequireWildcard(_sagas6);

var _sagas7 = __webpack_require__(76);

var web3 = _interopRequireWildcard(_sagas7);

var _actions = __webpack_require__(31);

var actions = _interopRequireWildcard(_actions);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var _marked = /*#__PURE__*/_regenerator2.default.mark(saga),
    _marked2 = /*#__PURE__*/_regenerator2.default.mark(forkListeners),
    _marked3 = /*#__PURE__*/_regenerator2.default.mark(fetchTx),
    _marked4 = /*#__PURE__*/_regenerator2.default.mark(recordContexts),
    _marked5 = /*#__PURE__*/_regenerator2.default.mark(recordSources),
    _marked6 = /*#__PURE__*/_regenerator2.default.mark(recordInstance),
    _marked7 = /*#__PURE__*/_regenerator2.default.mark(ready),
    _marked8 = /*#__PURE__*/_regenerator2.default.mark(error);

var debug = (0, _debug2.default)("debugger:session:sagas");

function saga() {
  var listeners, _ref, contexts, sources, _ref2, txHash, provider, err;

  return _regenerator2.default.wrap(function saga$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          debug("starting listeners");
          return _context.delegateYield(forkListeners(), "t0", 2);

        case 2:
          listeners = _context.t0;

          // receiving & saving contracts into state
          debug("waiting for contract information");
          _context.next = 6;
          return (0, _effects.take)(actions.RECORD_CONTRACTS);

        case 6:
          _ref = _context.sent;
          contexts = _ref.contexts;
          sources = _ref.sources;

          debug("recording contract binaries");
          return _context.delegateYield(recordContexts.apply(undefined, (0, _toConsumableArray3.default)(contexts)), "t1", 11);

        case 11:

          debug("recording contract sources");
          return _context.delegateYield(recordSources.apply(undefined, (0, _toConsumableArray3.default)(sources)), "t2", 13);

        case 13:

          debug("waiting for start");
          // wait for start signal
          _context.next = 16;
          return (0, _effects.take)(actions.START);

        case 16:
          _ref2 = _context.sent;
          txHash = _ref2.txHash;
          provider = _ref2.provider;

          debug("starting");

          // process transaction
          debug("fetching transaction info");
          return _context.delegateYield(fetchTx(txHash, provider), "t3", 22);

        case 22:
          err = _context.t3;

          if (!err) {
            _context.next = 28;
            break;
          }

          debug("error %o", err);
          return _context.delegateYield(error(err), "t4", 26);

        case 26:
          _context.next = 37;
          break;

        case 28:
          debug("visiting ASTs");
          // visit asts
          return _context.delegateYield(ast.visitAll(), "t5", 30);

        case 30:

          debug("readying");
          // signal that stepping can begin
          return _context.delegateYield(ready(), "t6", 32);

        case 32:

          debug("waiting for trace EOT");
          // wait until trace hits EOT
          return _context.delegateYield(trace.wait(), "t7", 34);

        case 34:

          debug("finishing");
          // finish
          _context.next = 37;
          return (0, _effects.put)(actions.finish());

        case 37:

          debug("stopping listeners");
          _context.next = 40;
          return (0, _effects.all)(listeners.map(function (task) {
            return (0, _effects.cancel)(task);
          }));

        case 40:
        case "end":
          return _context.stop();
      }
    }
  }, _marked, this);
}

exports.default = (0, _helpers.prefixName)("session", saga);

function forkListeners() {
  return _regenerator2.default.wrap(function forkListeners$(_context2) {
    while (1) {
      switch (_context2.prev = _context2.next) {
        case 0:
          _context2.next = 2;
          return (0, _effects.all)([ast, controller, data, evm, solidity, trace, web3].map(function (app) {
            return (0, _effects.fork)(app.saga);
          }));

        case 2:
          return _context2.abrupt("return", _context2.sent);

        case 3:
        case "end":
          return _context2.stop();
      }
    }
  }, _marked2, this);
}

function fetchTx(txHash, provider) {
  var result, addresses, binaries;
  return _regenerator2.default.wrap(function fetchTx$(_context3) {
    while (1) {
      switch (_context3.prev = _context3.next) {
        case 0:
          return _context3.delegateYield(web3.inspectTransaction(txHash, provider), "t0", 1);

        case 1:
          result = _context3.t0;

          if (!result.error) {
            _context3.next = 4;
            break;
          }

          return _context3.abrupt("return", result.error);

        case 4:
          return _context3.delegateYield(evm.begin(result), "t1", 5);

        case 5:
          return _context3.delegateYield(trace.processTrace(result.trace), "t2", 6);

        case 6:
          addresses = _context3.t2;

          if (result.address && addresses.indexOf(result.address) == -1) {
            addresses.push(result.address);
          }

          return _context3.delegateYield(web3.obtainBinaries(addresses), "t3", 9);

        case 9:
          binaries = _context3.t3;
          _context3.next = 12;
          return (0, _effects.all)(addresses.map(function (address, i) {
            return (0, _effects.call)(recordInstance, address, binaries[i]);
          }));

        case 12:
        case "end":
          return _context3.stop();
      }
    }
  }, _marked3, this);
}

function recordContexts() {
  for (var _len = arguments.length, contexts = Array(_len), _key = 0; _key < _len; _key++) {
    contexts[_key] = arguments[_key];
  }

  var _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _ref3, contractName, binary, sourceMap;

  return _regenerator2.default.wrap(function recordContexts$(_context4) {
    while (1) {
      switch (_context4.prev = _context4.next) {
        case 0:
          _iteratorNormalCompletion = true;
          _didIteratorError = false;
          _iteratorError = undefined;
          _context4.prev = 3;
          _iterator = (0, _getIterator3.default)(contexts);

        case 5:
          if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {
            _context4.next = 14;
            break;
          }

          _ref3 = _step.value;
          contractName = _ref3.contractName, binary = _ref3.binary, sourceMap = _ref3.sourceMap;
          return _context4.delegateYield(evm.addContext(contractName, binary), "t0", 9);

        case 9:
          if (!sourceMap) {
            _context4.next = 11;
            break;
          }

          return _context4.delegateYield(solidity.addSourceMap(binary, sourceMap), "t1", 11);

        case 11:
          _iteratorNormalCompletion = true;
          _context4.next = 5;
          break;

        case 14:
          _context4.next = 20;
          break;

        case 16:
          _context4.prev = 16;
          _context4.t2 = _context4["catch"](3);
          _didIteratorError = true;
          _iteratorError = _context4.t2;

        case 20:
          _context4.prev = 20;
          _context4.prev = 21;

          if (!_iteratorNormalCompletion && _iterator.return) {
            _iterator.return();
          }

        case 23:
          _context4.prev = 23;

          if (!_didIteratorError) {
            _context4.next = 26;
            break;
          }

          throw _iteratorError;

        case 26:
          return _context4.finish(23);

        case 27:
          return _context4.finish(20);

        case 28:
        case "end":
          return _context4.stop();
      }
    }
  }, _marked4, this, [[3, 16, 20, 28], [21,, 23, 27]]);
}

function recordSources() {
  for (var _len2 = arguments.length, sources = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
    sources[_key2] = arguments[_key2];
  }

  var _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, _ref4, sourcePath, source, _ast;

  return _regenerator2.default.wrap(function recordSources$(_context5) {
    while (1) {
      switch (_context5.prev = _context5.next) {
        case 0:
          _iteratorNormalCompletion2 = true;
          _didIteratorError2 = false;
          _iteratorError2 = undefined;
          _context5.prev = 3;
          _iterator2 = (0, _getIterator3.default)(sources);

        case 5:
          if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {
            _context5.next = 12;
            break;
          }

          _ref4 = _step2.value;
          sourcePath = _ref4.sourcePath, source = _ref4.source, _ast = _ref4.ast;
          return _context5.delegateYield(solidity.addSource(source, sourcePath, _ast), "t0", 9);

        case 9:
          _iteratorNormalCompletion2 = true;
          _context5.next = 5;
          break;

        case 12:
          _context5.next = 18;
          break;

        case 14:
          _context5.prev = 14;
          _context5.t1 = _context5["catch"](3);
          _didIteratorError2 = true;
          _iteratorError2 = _context5.t1;

        case 18:
          _context5.prev = 18;
          _context5.prev = 19;

          if (!_iteratorNormalCompletion2 && _iterator2.return) {
            _iterator2.return();
          }

        case 21:
          _context5.prev = 21;

          if (!_didIteratorError2) {
            _context5.next = 24;
            break;
          }

          throw _iteratorError2;

        case 24:
          return _context5.finish(21);

        case 25:
          return _context5.finish(18);

        case 26:
        case "end":
          return _context5.stop();
      }
    }
  }, _marked5, this, [[3, 14, 18, 26], [19,, 21, 25]]);
}

function recordInstance(address, binary) {
  return _regenerator2.default.wrap(function recordInstance$(_context6) {
    while (1) {
      switch (_context6.prev = _context6.next) {
        case 0:
          return _context6.delegateYield(evm.addInstance(address, binary), "t0", 1);

        case 1:
        case "end":
          return _context6.stop();
      }
    }
  }, _marked6, this);
}

function ready() {
  return _regenerator2.default.wrap(function ready$(_context7) {
    while (1) {
      switch (_context7.prev = _context7.next) {
        case 0:
          _context7.next = 2;
          return (0, _effects.put)(actions.ready());

        case 2:
        case "end":
          return _context7.stop();
      }
    }
  }, _marked7, this);
}

function error(err) {
  return _regenerator2.default.wrap(function error$(_context8) {
    while (1) {
      switch (_context8.prev = _context8.next) {
        case 0:
          _context8.next = 2;
          return (0, _effects.put)(actions.error(err));

        case 2:
        case "end":
          return _context8.stop();
      }
    }
  }, _marked8, this);
}

/***/ }),
/* 67 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _entries = __webpack_require__(5);

var _entries2 = _interopRequireDefault(_entries);

var _getIterator2 = __webpack_require__(16);

var _getIterator3 = _interopRequireDefault(_getIterator2);

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

exports.visitAll = visitAll;
exports.saga = saga;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _effects = __webpack_require__(14);

var _helpers = __webpack_require__(6);

var _sagas = __webpack_require__(38);

var data = _interopRequireWildcard(_sagas);

var _actions = __webpack_require__(71);

var actions = _interopRequireWildcard(_actions);

var _selectors = __webpack_require__(19);

var _selectors2 = _interopRequireDefault(_selectors);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var _marked = /*#__PURE__*/_regenerator2.default.mark(walk),
    _marked2 = /*#__PURE__*/_regenerator2.default.mark(handleEnter),
    _marked3 = /*#__PURE__*/_regenerator2.default.mark(handleExit),
    _marked4 = /*#__PURE__*/_regenerator2.default.mark(walkSaga),
    _marked5 = /*#__PURE__*/_regenerator2.default.mark(visitAll),
    _marked6 = /*#__PURE__*/_regenerator2.default.mark(saga);

var debug = (0, _debug2.default)("debugger:ast:sagas");

function walk(sourceId, node) {
  var pointer = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : "";
  var parentId = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

  var _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _ref, _ref2, i, child, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, _ref3, _ref4, key, _child;

  return _regenerator2.default.wrap(function walk$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          debug("walking %o %o", pointer, node);

          return _context.delegateYield(handleEnter(sourceId, node, pointer, parentId), "t0", 2);

        case 2:
          if (!(node instanceof Array)) {
            _context.next = 34;
            break;
          }

          _iteratorNormalCompletion = true;
          _didIteratorError = false;
          _iteratorError = undefined;
          _context.prev = 6;
          _iterator = (0, _getIterator3.default)(node.entries());

        case 8:
          if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {
            _context.next = 18;
            break;
          }

          _ref = _step.value;
          _ref2 = (0, _slicedToArray3.default)(_ref, 2);
          i = _ref2[0];
          child = _ref2[1];
          _context.next = 15;
          return (0, _effects.call)(walk, sourceId, child, pointer + "/" + i, parentId);

        case 15:
          _iteratorNormalCompletion = true;
          _context.next = 8;
          break;

        case 18:
          _context.next = 24;
          break;

        case 20:
          _context.prev = 20;
          _context.t1 = _context["catch"](6);
          _didIteratorError = true;
          _iteratorError = _context.t1;

        case 24:
          _context.prev = 24;
          _context.prev = 25;

          if (!_iteratorNormalCompletion && _iterator.return) {
            _iterator.return();
          }

        case 27:
          _context.prev = 27;

          if (!_didIteratorError) {
            _context.next = 30;
            break;
          }

          throw _iteratorError;

        case 30:
          return _context.finish(27);

        case 31:
          return _context.finish(24);

        case 32:
          _context.next = 64;
          break;

        case 34:
          if (!(node instanceof Object)) {
            _context.next = 64;
            break;
          }

          _iteratorNormalCompletion2 = true;
          _didIteratorError2 = false;
          _iteratorError2 = undefined;
          _context.prev = 38;
          _iterator2 = (0, _getIterator3.default)((0, _entries2.default)(node));

        case 40:
          if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {
            _context.next = 50;
            break;
          }

          _ref3 = _step2.value;
          _ref4 = (0, _slicedToArray3.default)(_ref3, 2);
          key = _ref4[0];
          _child = _ref4[1];
          _context.next = 47;
          return (0, _effects.call)(walk, sourceId, _child, pointer + "/" + key, node.id);

        case 47:
          _iteratorNormalCompletion2 = true;
          _context.next = 40;
          break;

        case 50:
          _context.next = 56;
          break;

        case 52:
          _context.prev = 52;
          _context.t2 = _context["catch"](38);
          _didIteratorError2 = true;
          _iteratorError2 = _context.t2;

        case 56:
          _context.prev = 56;
          _context.prev = 57;

          if (!_iteratorNormalCompletion2 && _iterator2.return) {
            _iterator2.return();
          }

        case 59:
          _context.prev = 59;

          if (!_didIteratorError2) {
            _context.next = 62;
            break;
          }

          throw _iteratorError2;

        case 62:
          return _context.finish(59);

        case 63:
          return _context.finish(56);

        case 64:
          return _context.delegateYield(handleExit(sourceId, node, pointer), "t3", 65);

        case 65:
        case "end":
          return _context.stop();
      }
    }
  }, _marked, this, [[6, 20, 24, 32], [25,, 27, 31], [38, 52, 56, 64], [57,, 59, 63]]);
}

function handleEnter(sourceId, node, pointer, parentId) {
  return _regenerator2.default.wrap(function handleEnter$(_context2) {
    while (1) {
      switch (_context2.prev = _context2.next) {
        case 0:
          if (node instanceof Object) {
            _context2.next = 2;
            break;
          }

          return _context2.abrupt("return");

        case 2:

          debug("entering %s", pointer);

          if (!(node.id !== undefined)) {
            _context2.next = 6;
            break;
          }

          debug("%s recording scope %s", pointer, node.id);
          return _context2.delegateYield(data.scope(node.id, pointer, parentId, sourceId), "t0", 6);

        case 6:
          _context2.t1 = node.nodeType;
          _context2.next = _context2.t1 === "VariableDeclaration" ? 9 : 12;
          break;

        case 9:
          debug("%s recording variable %o", pointer, node);
          return _context2.delegateYield(data.declare(node), "t2", 11);

        case 11:
          return _context2.abrupt("break", 12);

        case 12:
        case "end":
          return _context2.stop();
      }
    }
  }, _marked2, this);
}

function handleExit(sourceId, node, pointer) {
  return _regenerator2.default.wrap(function handleExit$(_context3) {
    while (1) {
      switch (_context3.prev = _context3.next) {
        case 0:
          debug("exiting %s", pointer);

        // no-op right now

        case 1:
        case "end":
          return _context3.stop();
      }
    }
  }, _marked3, this);
}

function walkSaga(_ref5) {
  var sourceId = _ref5.sourceId,
      ast = _ref5.ast;
  return _regenerator2.default.wrap(function walkSaga$(_context4) {
    while (1) {
      switch (_context4.prev = _context4.next) {
        case 0:
          _context4.next = 2;
          return walk(sourceId, ast);

        case 2:
        case "end":
          return _context4.stop();
      }
    }
  }, _marked4, this);
}

function visitAll(idx) {
  var sources, tasks;
  return _regenerator2.default.wrap(function visitAll$(_context5) {
    while (1) {
      switch (_context5.prev = _context5.next) {
        case 0:
          _context5.next = 2;
          return (0, _effects.select)(_selectors2.default.views.sources);

        case 2:
          sources = _context5.sent;
          _context5.next = 5;
          return (0, _effects.all)((0, _entries2.default)(sources).filter(function (_ref6) {
            var _ref7 = (0, _slicedToArray3.default)(_ref6, 2),
                id = _ref7[0],
                ast = _ref7[1].ast;

            return !!ast;
          }).map(function (_ref8) {
            var _ref9 = (0, _slicedToArray3.default)(_ref8, 2),
                id = _ref9[0],
                ast = _ref9[1].ast;

            return (0, _effects.fork)(function () {
              return (0, _effects.put)(actions.visit(id, ast));
            });
          }));

        case 5:
          tasks = _context5.sent;

          if (!(tasks.length > 0)) {
            _context5.next = 9;
            break;
          }

          _context5.next = 9;
          return _effects.join.apply(undefined, (0, _toConsumableArray3.default)(tasks));

        case 9:
          _context5.next = 11;
          return (0, _effects.put)(actions.doneVisiting());

        case 11:
        case "end":
          return _context5.stop();
      }
    }
  }, _marked5, this);
}

function saga() {
  return _regenerator2.default.wrap(function saga$(_context6) {
    while (1) {
      switch (_context6.prev = _context6.next) {
        case 0:
          _context6.next = 2;
          return (0, _effects.race)({
            visitor: (0, _effects.takeEvery)(actions.VISIT, walkSaga),
            done: (0, _effects.take)(actions.DONE_VISITING)
          });

        case 2:
        case "end":
          return _context6.stop();
      }
    }
  }, _marked6, this);
}

exports.default = (0, _helpers.prefixName)("ast", saga);

/***/ }),
/* 68 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _entries = __webpack_require__(5);

var _entries2 = _interopRequireDefault(_entries);

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _extends2 = __webpack_require__(13);

var _extends3 = _interopRequireDefault(_extends2);

var _assign = __webpack_require__(8);

var _assign2 = _interopRequireDefault(_assign);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

exports.read = read;
exports.decodeValue = decodeValue;
exports.decodeMemoryReference = decodeMemoryReference;
exports.decodeStorageReference = decodeStorageReference;
exports.default = decode;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _bignumber = __webpack_require__(25);

var _memory = __webpack_require__(69);

var memory = _interopRequireWildcard(_memory);

var _storage = __webpack_require__(70);

var storage = _interopRequireWildcard(_storage);

var _utils = __webpack_require__(15);

var utils = _interopRequireWildcard(_utils);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:data:decode");

function read(pointer, state) {
  if (pointer.stack != undefined && state.stack && pointer.stack < state.stack.length) {
    return state.stack[pointer.stack];
  } else if (pointer.storage != undefined && state.storage) {
    return storage.readRange(state.storage, pointer.storage);
  } else if (pointer.memory != undefined && state.memory) {
    return memory.readBytes(state.memory, pointer.memory.start, pointer.memory.length);
  } else if (pointer.literal) {
    return pointer.literal;
  }
}

function decodeValue(definition, pointer, state) {
  var bytes = read(pointer, state);
  if (!bytes) {
    return undefined;
  }

  switch (utils.typeClass(definition)) {
    case "bool":
      return !utils.toBigNumber(bytes).isZero();

    case "uint":
      return utils.toBigNumber(bytes);

    case "int":
      return utils.toSignedBigNumber(bytes);

    case "address":
      return utils.toHexString(bytes, true);

    case "bytes":
      debug("typeIdentifier %s %o", utils.typeIdentifier(definition), bytes);
      var length = utils.specifiedSize(definition);
      return utils.toHexString(bytes, length);

    case "string":
      debug("typeIdentifier %s %o", utils.typeIdentifier(definition), bytes);
      return String.fromCharCode.apply(null, bytes);

    default:
      debug("Unknown value type: %s", utils.typeIdentifier(definition));
      return null;
  }
}

function decodeMemoryReference(definition, pointer, state) {
  for (var _len = arguments.length, args = Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {
    args[_key - 3] = arguments[_key];
  }

  var rawValue = utils.toBigNumber(read(pointer, state)).toNumber();

  var bytes;
  switch (utils.typeClass(definition)) {

    case "bytes":
    case "string":
      bytes = read({
        memory: { start: rawValue, length: _utils.WORD_SIZE }
      }, state); // bytes contain length

      return decodeValue.apply(undefined, [definition, {
        memory: { start: rawValue + _utils.WORD_SIZE, length: bytes }
      }, state].concat(args));

    case "array":
      bytes = utils.toBigNumber(read({
        memory: { start: rawValue, length: _utils.WORD_SIZE }
      }, state)).toNumber(); // bytes contain array length

      bytes = read({ memory: {
          start: rawValue + _utils.WORD_SIZE, length: bytes * _utils.WORD_SIZE
        } }, state); // now bytes contain items

      return memory.chunk(bytes, _utils.WORD_SIZE).map(function (chunk) {
        return decode.apply(undefined, [utils.baseDefinition(definition), {
          literal: chunk
        }, state].concat(args));
      });

    case "struct":
      var refs = args[0];

      var structDefinition = refs[definition.typeName.referencedDeclaration];
      var structVariables = structDefinition.variables || [];

      return _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)(structVariables.map(function (_ref, i) {
        var name = _ref.name,
            id = _ref.id;

        var memberDefinition = refs[id].definition;
        var memberPointer = {
          memory: { start: rawValue + i * _utils.WORD_SIZE, length: _utils.WORD_SIZE }
        };
        // let memberPointer = memory.read(state.memory, pointer + i * WORD_SIZE);

        // HACK
        memberDefinition = (0, _extends3.default)({}, memberDefinition, {

          typeDescriptions: (0, _extends3.default)({}, memberDefinition.typeDescriptions, {

            typeIdentifier: memberDefinition.typeDescriptions.typeIdentifier.replace(/_storage_/g, "_memory_")
          })
        });

        return (0, _defineProperty3.default)({}, name, decode.apply(undefined, [memberDefinition, memberPointer, state].concat(args)));
      }))));

    default:
      debug("Unknown memory reference type: %s", utils.typeIdentifier(definition));
      return null;

  }
}

function decodeStorageReference(definition, pointer, state) {
  for (var _len2 = arguments.length, args = Array(_len2 > 3 ? _len2 - 3 : 0), _key2 = 3; _key2 < _len2; _key2++) {
    args[_key2 - 3] = arguments[_key2];
  }

  var data;
  var bytes;
  var length;
  var slot;

  switch (utils.typeClass(definition)) {
    case "array":
      debug("storage array! %o", pointer);
      data = read(pointer, state);
      if (!data) {
        return null;
      }

      length = utils.toBigNumber(data).toNumber();
      debug("length %o", length);

      var baseSize = utils.storageSize(utils.baseDefinition(definition));
      var perWord = Math.floor(_utils.WORD_SIZE / baseSize);
      debug("baseSize %o", baseSize);
      debug("perWord %d", perWord);

      var offset = function offset(i) {
        if (perWord == 1) {
          return i;
        }

        return Math.floor(i * baseSize / _utils.WORD_SIZE);
      };

      var index = function index(i) {
        if (perWord == 1) {
          return _utils.WORD_SIZE - baseSize;
        }

        var position = perWord - i % perWord - 1;
        return position * baseSize;
      };

      debug("pointer: %o", pointer);
      return [].concat((0, _toConsumableArray3.default)(Array(length).keys())).map(function (i) {
        var childFrom = pointer.storage.from.offset != undefined ? {
          slot: ["0x" + utils.toBigNumber(utils.keccak256.apply(utils, (0, _toConsumableArray3.default)(pointer.storage.from.slot))).plus(pointer.storage.from.offset).toString(16)],
          offset: offset(i),
          index: index(i)
        } : {
          slot: [pointer.storage.from.slot],
          offset: offset(i),
          index: index(i)
        };
        return childFrom;
      }).map(function (childFrom, idx) {
        debug("childFrom %d, %o", idx, childFrom);
        return decode.apply(undefined, [utils.baseDefinition(definition), { storage: {
            from: childFrom,
            length: baseSize
          } }, state].concat(args));
      });

    case "bytes":
    case "string":
      data = read(pointer, state);
      if (!data) {
        return null;
      }

      if (data[_utils.WORD_SIZE - 1] % 2 == 0) {
        // string lives in word, length is last byte / 2
        length = data[_utils.WORD_SIZE - 1] / 2;
        debug("in-word; length %o", length);
        if (length == 0) {
          return "";
        }

        return decodeValue.apply(undefined, [definition, { storage: {
            from: { slot: pointer.storage.from.slot, index: 0 },
            to: { slot: pointer.storage.from.slot, index: length - 1 }
          } }, state].concat(args));
      } else {
        length = utils.toBigNumber(data).minus(1).div(2).toNumber();
        debug("new-word, length %o", length);

        return decodeValue.apply(undefined, [definition, { storage: {
            from: { slot: [pointer.storage.from.slot], index: 0 },
            length: length
          } }, state].concat(args));
      }

    case "struct":
      var refs = args[0];

      return _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(pointer.storage.children).map(function (_ref3) {
        var _ref4 = (0, _slicedToArray3.default)(_ref3, 2),
            id = _ref4[0],
            childPointer = _ref4[1];

        return (0, _defineProperty3.default)({}, childPointer.name, decode.apply(undefined, [refs[id].definition, { storage: childPointer }, state].concat(args)));
      }))));

    default:
      debug("Unknown storage reference type: %s", utils.typeIdentifier(definition));
      return undefined;
  }
}

function decode(definition) {
  for (var _len3 = arguments.length, args = Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
    args[_key3 - 1] = arguments[_key3];
  }

  if (!utils.isReference(definition)) {
    return decodeValue.apply(undefined, [definition].concat(args));
  }

  switch (utils.referenceType(definition)) {
    case "memory":
      return decodeMemoryReference.apply(undefined, [definition].concat(args));
    case "storage":
      return decodeStorageReference.apply(undefined, [definition].concat(args));
    default:
      debug("Unknown reference category: %s", utils.typeIdentifier(definition));
      return undefined;
  }
}

/***/ }),
/* 69 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.read = read;
exports.readBytes = readBytes;
exports.chunk = chunk;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _bignumber = __webpack_require__(25);

var _utils = __webpack_require__(15);

var utils = _interopRequireWildcard(_utils);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:data:decode:memory");

/**
 * read word from memory
 *
 * requires `byte` to be a multiple of WORD_SIZE (32)
 *
 * @param memory - Uint8Array
 * @return {BigNumber}
 */
function read(memory, byte) {
  return readBytes(memory, byte, _utils.WORD_SIZE);
}

/**
 * read <bytes> amount of bytes from memory, starting at byte <start>
 *
 * @param memory - Uint8Array
 */
function readBytes(memory, byte, length) {
  byte = utils.toBigNumber(byte);
  length = utils.toBigNumber(length);

  if (byte.toNumber() >= memory.length) {
    return new Uint8Array(length ? length.toNumber() : 0);
  }

  if (length == undefined) {
    return new Uint8Array(memory.buffer, byte.toNumber());
  }

  // grab `length` bytes no matter what, here fill this array
  var bytes = new Uint8Array(length.toNumber());

  // if we're reading past the end of memory, truncate the length to read
  var excess = byte.plus(length).minus(memory.length).toNumber();
  if (excess > 0) {
    length = new _bignumber.BigNumber(memory.length).minus(byte);
  }

  var existing = new Uint8Array(memory.buffer, byte.toNumber(), length.toNumber());

  bytes.set(existing);

  return bytes;
}

/**
 * Split memory into chunks
 */
function chunk(memory) {
  var size = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _utils.WORD_SIZE;

  var chunks = [];

  for (var i = 0; i < memory.length; i += size) {
    var _chunk = readBytes(memory, i, size);
    chunks.push(_chunk);
  }

  return chunks;
}

/***/ }),
/* 70 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends2 = __webpack_require__(13);

var _extends3 = _interopRequireDefault(_extends2);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

exports.read = read;
exports.readRange = readRange;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _utils = __webpack_require__(15);

var utils = _interopRequireWildcard(_utils);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:data:decode:storage");

/**
 * read slot from storage
 *
 * @param slot - big number or array of regular numbers
 * @param offset - for array, offset from the keccak determined location
 */
function read(storage, slot) {
  var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

  if (slot instanceof Array) {
    slot = utils.keccak256.apply(utils, (0, _toConsumableArray3.default)(slot.map(utils.toBigNumber)));
  }

  slot = utils.toBigNumber(slot).plus(offset);

  debug("reading slot: %o", utils.toHexString(slot));

  var word = storage[utils.toHexString(slot, _utils.WORD_SIZE)] || new Uint8Array(_utils.WORD_SIZE);

  debug("word %o", word);
  return word;
}

/**
 * read all bytes in some range.
 *
 * parameters `from` and `to` are objects with the following properties:
 *
 *   slot - (required) either a bignumber or a "path" array of integer offsets
 *
 *     path array values get converted into keccak256 hash as per solidity
 *     storage allocation method
 *
 *     ref: https://solidity.readthedocs.io/en/v0.4.23/miscellaneous.html#layout-of-state-variables-in-storage
 *     (search "concatenation")
 *
 *  offset - (default: 0) slot offset
 *
 *  index - (default: 0) byte index in word
 *
 * @param from - location (see ^)
 * @param to - location (see ^). inclusive.
 * @param length - instead of `to`, number of bytes after `from`
 */
function readRange(storage, _ref) {
  var from = _ref.from,
      to = _ref.to,
      length = _ref.length;

  if (!length && !to || length && to) {
    throw new Error("must specify exactly one `to`|`length`");
  }

  from = (0, _extends3.default)({}, from, {
    offset: from.offset || 0
  });

  if (length) {
    to = {
      slot: from.slot,
      offset: from.offset + Math.floor((from.index + length - 1) / _utils.WORD_SIZE),
      index: (from.index + length - 1) % _utils.WORD_SIZE
    };
  } else {
    to = (0, _extends3.default)({}, to, {
      offset: to.offset || 0
    });
  }

  debug("readRange %o", { from: from, to: to });

  var totalWords = to.offset - from.offset + 1;
  debug("totalWords %o", totalWords);

  var data = new Uint8Array(totalWords * _utils.WORD_SIZE);

  for (var i = 0; i < totalWords; i++) {
    var offset = i + from.offset;
    data.set(read(storage, from.slot, offset), i * _utils.WORD_SIZE);
  }
  debug("words %o", data);

  data = data.slice(from.index, (totalWords - 1) * _utils.WORD_SIZE + to.index + 1);

  debug("data: %o", data);

  return data;
}

/***/ }),
/* 71 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.visit = visit;
exports.doneVisiting = doneVisiting;
var VISIT = exports.VISIT = "VISIT";
function visit(sourceId, ast) {
  return {
    type: VISIT,
    sourceId: sourceId, ast: ast
  };
}

var DONE_VISITING = exports.DONE_VISITING = "DONE_VISITING";
function doneVisiting() {
  return {
    type: DONE_VISITING
  };
}

/***/ }),
/* 72 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _keys = __webpack_require__(22);

var _keys2 = _interopRequireDefault(_keys);

var _set = __webpack_require__(33);

var _set2 = _interopRequireDefault(_set);

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _CONTROL_SAGAS;

exports.saga = saga;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _effects = __webpack_require__(14);

var _helpers = __webpack_require__(6);

var _sagas = __webpack_require__(40);

var trace = _interopRequireWildcard(_sagas);

var _actions = __webpack_require__(37);

var actions = _interopRequireWildcard(_actions);

var _selectors = __webpack_require__(73);

var _selectors2 = _interopRequireDefault(_selectors);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var _marked = /*#__PURE__*/_regenerator2.default.mark(saga),
    _marked2 = /*#__PURE__*/_regenerator2.default.mark(advance),
    _marked3 = /*#__PURE__*/_regenerator2.default.mark(stepNext),
    _marked4 = /*#__PURE__*/_regenerator2.default.mark(stepInto),
    _marked5 = /*#__PURE__*/_regenerator2.default.mark(stepOut),
    _marked6 = /*#__PURE__*/_regenerator2.default.mark(stepOver),
    _marked7 = /*#__PURE__*/_regenerator2.default.mark(continueUntil);

var debug = (0, _debug2.default)("debugger:controller:sagas");

var CONTROL_SAGAS = (_CONTROL_SAGAS = {}, (0, _defineProperty3.default)(_CONTROL_SAGAS, actions.ADVANCE, advance), (0, _defineProperty3.default)(_CONTROL_SAGAS, actions.STEP_NEXT, stepNext), (0, _defineProperty3.default)(_CONTROL_SAGAS, actions.STEP_OVER, stepOver), (0, _defineProperty3.default)(_CONTROL_SAGAS, actions.STEP_INTO, stepInto), (0, _defineProperty3.default)(_CONTROL_SAGAS, actions.STEP_OUT, stepOut), (0, _defineProperty3.default)(_CONTROL_SAGAS, actions.CONTINUE_UNTIL, continueUntil), _CONTROL_SAGAS);

/** AST node types that are skipped to filter out some noise */
var SKIPPED_TYPES = new _set2.default(["ContractDefinition", "VariableDeclaration"]);

function saga() {
  var action, _saga;

  return _regenerator2.default.wrap(function saga$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          if (false) {
            _context.next = 13;
            break;
          }

          debug("waiting for control action");
          _context.next = 4;
          return (0, _effects.take)((0, _keys2.default)(CONTROL_SAGAS));

        case 4:
          action = _context.sent;

          debug("got control action");
          _saga = CONTROL_SAGAS[action.type];
          _context.next = 9;
          return (0, _effects.put)(actions.beginStep(action.type));

        case 9:
          _context.next = 11;
          return (0, _effects.race)({
            exec: (0, _effects.call)(_saga, action),
            interrupt: (0, _effects.take)(actions.INTERRUPT)
          });

        case 11:
          _context.next = 0;
          break;

        case 13:
        case "end":
          return _context.stop();
      }
    }
  }, _marked, this);
}

exports.default = (0, _helpers.prefixName)("controller", saga);

/**
 * Advance the state by one instruction
 */

function advance() {
  return _regenerator2.default.wrap(function advance$(_context2) {
    while (1) {
      switch (_context2.prev = _context2.next) {
        case 0:
          return _context2.delegateYield(trace.advance(), "t0", 1);

        case 1:
        case "end":
          return _context2.stop();
      }
    }
  }, _marked2, this);
}

/**
 * stepNext - step to the next logical code segment
 *
 * Note: It might take multiple instructions to express the same section of code.
 * "Stepping", then, is stepping to the next logical item, not stepping to the next
 * instruction. See advance() if you'd like to advance by one instruction.
 */
function stepNext() {
  var startingRange, upcoming;
  return _regenerator2.default.wrap(function stepNext$(_context3) {
    while (1) {
      switch (_context3.prev = _context3.next) {
        case 0:
          _context3.next = 2;
          return (0, _effects.select)(_selectors2.default.current.location.sourceRange);

        case 2:
          startingRange = _context3.sent;

        case 3:
          return _context3.delegateYield(advance(), "t0", 4);

        case 4:
          _context3.next = 6;
          return (0, _effects.select)(_selectors2.default.current.location);

        case 6:
          upcoming = _context3.sent;

        case 7:
          if (!upcoming.node || SKIPPED_TYPES.has(upcoming.node.nodeType) || upcoming.sourceRange.start == startingRange.start && upcoming.sourceRange.length == startingRange.length) {
            _context3.next = 3;
            break;
          }

        case 8:
        case "end":
          return _context3.stop();
      }
    }
  }, _marked3, this);
}

/**
 * stepInto - step into the current function
 *
 * Conceptually this is easy, but from a programming standpoint it's hard.
 * Code like `getBalance(msg.sender)` might be highlighted, but there could
 * be a number of different intermediate steps (like evaluating `msg.sender`)
 * before `getBalance` is stepped into. This function will step into the first
 * function available (where instruction.jump == "i"), ignoring any intermediate
 * steps that fall within the same code range. If there's a step encountered
 * that exists outside of the range, then stepInto will only execute until that
 * step.
 */
function stepInto() {
  var startingDepth, startingRange, currentDepth, currentRange;
  return _regenerator2.default.wrap(function stepInto$(_context4) {
    while (1) {
      switch (_context4.prev = _context4.next) {
        case 0:
          _context4.next = 2;
          return (0, _effects.select)(_selectors2.default.current.willJump);

        case 2:
          if (!_context4.sent) {
            _context4.next = 5;
            break;
          }

          return _context4.delegateYield(stepNext(), "t0", 4);

        case 4:
          return _context4.abrupt("return");

        case 5:
          _context4.next = 7;
          return (0, _effects.select)(_selectors2.default.current.location.isMultiline);

        case 7:
          if (!_context4.sent) {
            _context4.next = 10;
            break;
          }

          return _context4.delegateYield(stepOver(), "t1", 9);

        case 9:
          return _context4.abrupt("return");

        case 10:
          _context4.next = 12;
          return (0, _effects.select)(_selectors2.default.current.functionDepth);

        case 12:
          startingDepth = _context4.sent;
          _context4.next = 15;
          return (0, _effects.select)(_selectors2.default.current.location.sourceRange);

        case 15:
          startingRange = _context4.sent;

        case 16:
          return _context4.delegateYield(stepNext(), "t2", 17);

        case 17:
          _context4.next = 19;
          return (0, _effects.select)(_selectors2.default.current.functionDepth);

        case 19:
          currentDepth = _context4.sent;
          _context4.next = 22;
          return (0, _effects.select)(_selectors2.default.current.location.sourceRange);

        case 22:
          currentRange = _context4.sent;

        case 23:
          if (
          // the function stack has not increased,
          currentDepth <= startingDepth &&

          // the current source range begins on or after the starting range
          currentRange.start >= startingRange.start &&

          // and the current range ends on or before the starting range ends
          currentRange.start + currentRange.length <= startingRange.start + startingRange.length) {
            _context4.next = 16;
            break;
          }

        case 24:
        case "end":
          return _context4.stop();
      }
    }
  }, _marked4, this);
}

/**
 * Step out of the current function
 *
 * This will run until the debugger encounters a decrease in function depth.
 */
function stepOut() {
  var startingDepth, currentDepth;
  return _regenerator2.default.wrap(function stepOut$(_context5) {
    while (1) {
      switch (_context5.prev = _context5.next) {
        case 0:
          _context5.next = 2;
          return (0, _effects.select)(_selectors2.default.current.location.isMultiline);

        case 2:
          if (!_context5.sent) {
            _context5.next = 5;
            break;
          }

          return _context5.delegateYield(stepOver(), "t0", 4);

        case 4:
          return _context5.abrupt("return");

        case 5:
          _context5.next = 7;
          return (0, _effects.select)(_selectors2.default.current.functionDepth);

        case 7:
          startingDepth = _context5.sent;

        case 8:
          return _context5.delegateYield(stepNext(), "t1", 9);

        case 9:
          _context5.next = 11;
          return (0, _effects.select)(_selectors2.default.current.functionDepth);

        case 11:
          currentDepth = _context5.sent;

        case 12:
          if (currentDepth >= startingDepth) {
            _context5.next = 8;
            break;
          }

        case 13:
        case "end":
          return _context5.stop();
      }
    }
  }, _marked5, this);
}

/**
 * stepOver - step over the current line
 *
 * Step over the current line. This will step to the next instruction that
 * exists on a different line of code within the same function depth.
 */
function stepOver() {
  var startingDepth, startingRange, currentDepth, currentRange;
  return _regenerator2.default.wrap(function stepOver$(_context6) {
    while (1) {
      switch (_context6.prev = _context6.next) {
        case 0:
          _context6.next = 2;
          return (0, _effects.select)(_selectors2.default.current.functionDepth);

        case 2:
          startingDepth = _context6.sent;
          _context6.next = 5;
          return (0, _effects.select)(_selectors2.default.current.location.sourceRange);

        case 5:
          startingRange = _context6.sent;

        case 6:
          return _context6.delegateYield(stepNext(), "t0", 7);

        case 7:
          _context6.next = 9;
          return (0, _effects.select)(_selectors2.default.current.functionDepth);

        case 9:
          currentDepth = _context6.sent;
          _context6.next = 12;
          return (0, _effects.select)(_selectors2.default.current.location.sourceRange);

        case 12:
          currentRange = _context6.sent;

        case 13:
          if (
          // keep stepping provided:
          //
          // we haven't jumped out
          !(currentDepth < startingDepth) && (

          // either: function depth is greater than starting (ignore function calls)
          // or, if we're at the same depth, keep stepping until we're on a new
          // line.
          currentDepth > startingDepth || currentRange.lines.start.line == startingRange.lines.start.line)) {
            _context6.next = 6;
            break;
          }

        case 14:
        case "end":
          return _context6.stop();
      }
    }
  }, _marked6, this);
}

/**
 * continueUntil - step through execution until a breakpoint
 *
 * @param breakpoints - array of breakpoints ({ ...call, line })
 */
function continueUntil(_ref) {
  var breakpoints = _ref.breakpoints;
  var currentCall, currentLocation, breakpointHit;
  return _regenerator2.default.wrap(function continueUntil$(_context7) {
    while (1) {
      switch (_context7.prev = _context7.next) {
        case 0:
          breakpointHit = false;

        case 1:
          return _context7.delegateYield(stepNext(), "t0", 2);

        case 2:
          _context7.next = 4;
          return (0, _effects.select)(_selectors2.default.current.executionContext);

        case 4:
          currentCall = _context7.sent;
          _context7.next = 7;
          return (0, _effects.select)(_selectors2.default.current.location);

        case 7:
          currentLocation = _context7.sent;

          breakpointHit = breakpoints.filter(function (_ref2) {
            var address = _ref2.address,
                binary = _ref2.binary,
                line = _ref2.line,
                node = _ref2.node;
            return (address == currentCall.address || binary == currentCall.binary) && (line == currentLocation.sourceRange.lines.start.line || node == currentLocation.node.id);
          }).length > 0;

        case 9:
          if (!breakpointHit) {
            _context7.next = 1;
            break;
          }

        case 10:
        case "end":
          return _context7.stop();
      }
    }
  }, _marked7, this);
}

/***/ }),
/* 73 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _reselectTree = __webpack_require__(12);

var _selectors = __webpack_require__(7);

var _selectors2 = _interopRequireDefault(_selectors);

var _selectors3 = __webpack_require__(9);

var _selectors4 = _interopRequireDefault(_selectors3);

var _selectors5 = __webpack_require__(19);

var _selectors6 = _interopRequireDefault(_selectors5);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:controller:sagas");

/**
 * @private
 */
var identity = function identity(x) {
  return x;
};

/**
 * controller
 */
var controller = (0, _reselectTree.createSelectorTree)({

  /**
   * controller.current
   */
  current: {
    /**
     * controller.current.functionDepth
     */
    functionDepth: (0, _reselectTree.createLeaf)([_selectors4.default.current.functionDepth], identity),

    /**
     * controller.current.executionContext
     */
    executionContext: (0, _reselectTree.createLeaf)([_selectors2.default.current.call], identity),

    /**
     * controller.current.willJump
     */
    willJump: (0, _reselectTree.createLeaf)([_selectors2.default.current.step.isJump], identity),

    /**
     * controller.current.location
     */
    location: {
      /**
       * controller.current.location.sourceRange
       */
      sourceRange: (0, _reselectTree.createLeaf)([_selectors4.default.current.sourceRange], identity),

      /**
       * controller.current.location.node
       */
      node: (0, _reselectTree.createLeaf)([_selectors6.default.current.node], identity),

      /**
       * controller.current.location.isMultiline
       */
      isMultiline: (0, _reselectTree.createLeaf)([_selectors4.default.current.isMultiline], identity)
    }
  }
});

exports.default = controller;

/***/ }),
/* 74 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

exports.addSource = addSource;
exports.addSourceMap = addSourceMap;
exports.saga = saga;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _effects = __webpack_require__(14);

var _helpers = __webpack_require__(6);

var _actions = __webpack_require__(41);

var actions = _interopRequireWildcard(_actions);

var _actions2 = __webpack_require__(26);

var _selectors = __webpack_require__(9);

var _selectors2 = _interopRequireDefault(_selectors);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var _marked = /*#__PURE__*/_regenerator2.default.mark(addSource),
    _marked2 = /*#__PURE__*/_regenerator2.default.mark(addSourceMap),
    _marked3 = /*#__PURE__*/_regenerator2.default.mark(functionDepthSaga),
    _marked4 = /*#__PURE__*/_regenerator2.default.mark(saga);

var debug = (0, _debug2.default)("debugger:solidity:sagas");

function addSource(source, sourcePath, ast) {
  return _regenerator2.default.wrap(function addSource$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          _context.next = 2;
          return (0, _effects.put)(actions.addSource(source, sourcePath, ast));

        case 2:
        case "end":
          return _context.stop();
      }
    }
  }, _marked, this);
}

function addSourceMap(binary, sourceMap) {
  return _regenerator2.default.wrap(function addSourceMap$(_context2) {
    while (1) {
      switch (_context2.prev = _context2.next) {
        case 0:
          _context2.next = 2;
          return (0, _effects.put)(actions.addSourceMap(binary, sourceMap));

        case 2:
        case "end":
          return _context2.stop();
      }
    }
  }, _marked2, this);
}

function functionDepthSaga() {
  var instruction, jumpDirection;
  return _regenerator2.default.wrap(function functionDepthSaga$(_context3) {
    while (1) {
      switch (_context3.prev = _context3.next) {
        case 0:
          if (false) {
            _context3.next = 18;
            break;
          }

          _context3.next = 3;
          return (0, _effects.take)(_actions2.TICK);

        case 3:
          debug("got TICK");
          _context3.next = 6;
          return (0, _effects.select)(_selectors2.default.current.instruction);

        case 6:
          instruction = _context3.sent;

          debug("instruction: %o", instruction);

          _context3.next = 10;
          return (0, _effects.select)(_selectors2.default.current.willJump);

        case 10:
          if (!_context3.sent) {
            _context3.next = 16;
            break;
          }

          _context3.next = 13;
          return (0, _effects.select)(_selectors2.default.current.jumpDirection);

        case 13:
          jumpDirection = _context3.sent;
          _context3.next = 16;
          return (0, _effects.put)(actions.jump(jumpDirection));

        case 16:
          _context3.next = 0;
          break;

        case 18:
        case "end":
          return _context3.stop();
      }
    }
  }, _marked3, this);
}

function saga() {
  return _regenerator2.default.wrap(function saga$(_context4) {
    while (1) {
      switch (_context4.prev = _context4.next) {
        case 0:
          _context4.next = 2;
          return (0, _effects.call)(functionDepthSaga);

        case 2:
        case "end":
          return _context4.stop();
      }
    }
  }, _marked4, this);
}

exports.default = (0, _helpers.prefixName)("solidity", saga);

/***/ }),
/* 75 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

exports.addContext = addContext;
exports.addInstance = addInstance;
exports.begin = begin;
exports.callstackSaga = callstackSaga;
exports.saga = saga;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _effects = __webpack_require__(14);

var _helpers = __webpack_require__(6);

var _actions = __webpack_require__(26);

var _actions2 = __webpack_require__(42);

var actions = _interopRequireWildcard(_actions2);

var _selectors = __webpack_require__(7);

var _selectors2 = _interopRequireDefault(_selectors);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var _marked = /*#__PURE__*/_regenerator2.default.mark(addContext),
    _marked2 = /*#__PURE__*/_regenerator2.default.mark(addInstance),
    _marked3 = /*#__PURE__*/_regenerator2.default.mark(begin),
    _marked4 = /*#__PURE__*/_regenerator2.default.mark(callstackSaga),
    _marked5 = /*#__PURE__*/_regenerator2.default.mark(saga);

var debug = (0, _debug2.default)("debugger:evm:sagas");

/**
 * Adds EVM bytecode context
 *
 * @return {string} ID (0x-prefixed keccak of binary)
 */
function addContext(contractName, binary) {
  return _regenerator2.default.wrap(function addContext$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          _context.next = 2;
          return (0, _effects.put)(actions.addContext(contractName, binary));

        case 2:
          return _context.abrupt("return", (0, _helpers.keccak256)(binary));

        case 3:
        case "end":
          return _context.stop();
      }
    }
  }, _marked, this);
}

/**
 * Adds known deployed instance of binary at address
 *
 * @return {string} ID (0x-prefixed keccak of binary)
 */
function addInstance(address, binary) {
  var search, _search, context;

  return _regenerator2.default.wrap(function addInstance$(_context2) {
    while (1) {
      switch (_context2.prev = _context2.next) {
        case 0:
          _context2.next = 2;
          return (0, _effects.select)(_selectors2.default.info.binaries.search);

        case 2:
          search = _context2.sent;
          _search = search(binary), context = _search.context;
          _context2.next = 6;
          return (0, _effects.put)(actions.addInstance(address, context, binary));

        case 6:
          return _context2.abrupt("return", context);

        case 7:
        case "end":
          return _context2.stop();
      }
    }
  }, _marked2, this);
}

function begin(_ref) {
  var address = _ref.address,
      binary = _ref.binary;
  return _regenerator2.default.wrap(function begin$(_context3) {
    while (1) {
      switch (_context3.prev = _context3.next) {
        case 0:
          if (!address) {
            _context3.next = 5;
            break;
          }

          _context3.next = 3;
          return (0, _effects.put)(actions.call(address));

        case 3:
          _context3.next = 7;
          break;

        case 5:
          _context3.next = 7;
          return (0, _effects.put)(actions.create(binary));

        case 7:
        case "end":
          return _context3.stop();
      }
    }
  }, _marked3, this);
}

function callstackSaga() {
  var address, binary;
  return _regenerator2.default.wrap(function callstackSaga$(_context4) {
    while (1) {
      switch (_context4.prev = _context4.next) {
        case 0:
          if (false) {
            _context4.next = 34;
            break;
          }

          _context4.next = 3;
          return (0, _effects.take)(_actions.TICK);

        case 3:
          debug("got TICK");

          _context4.next = 6;
          return (0, _effects.select)(_selectors2.default.current.step.isCall);

        case 6:
          if (!_context4.sent) {
            _context4.next = 15;
            break;
          }

          debug("got call");
          _context4.next = 10;
          return (0, _effects.select)(_selectors2.default.current.step.callAddress);

        case 10:
          address = _context4.sent;
          _context4.next = 13;
          return (0, _effects.put)(actions.call(address));

        case 13:
          _context4.next = 32;
          break;

        case 15:
          _context4.next = 17;
          return (0, _effects.select)(_selectors2.default.current.step.isCreate);

        case 17:
          if (!_context4.sent) {
            _context4.next = 26;
            break;
          }

          debug("got create");
          _context4.next = 21;
          return (0, _effects.select)(_selectors2.default.current.step.createBinary);

        case 21:
          binary = _context4.sent;
          _context4.next = 24;
          return (0, _effects.put)(actions.create(binary));

        case 24:
          _context4.next = 32;
          break;

        case 26:
          _context4.next = 28;
          return (0, _effects.select)(_selectors2.default.current.step.isHalting);

        case 28:
          if (!_context4.sent) {
            _context4.next = 32;
            break;
          }

          debug("got return");
          _context4.next = 32;
          return (0, _effects.put)(actions.returnCall());

        case 32:
          _context4.next = 0;
          break;

        case 34:
        case "end":
          return _context4.stop();
      }
    }
  }, _marked4, this);
}

function saga() {
  return _regenerator2.default.wrap(function saga$(_context5) {
    while (1) {
      switch (_context5.prev = _context5.next) {
        case 0:
          _context5.next = 2;
          return (0, _effects.call)(callstackSaga);

        case 2:
        case "end":
          return _context5.stop();
      }
    }
  }, _marked5, this);
}

exports.default = (0, _helpers.prefixName)("evm", saga);

/***/ }),
/* 76 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

exports.inspectTransaction = inspectTransaction;
exports.obtainBinaries = obtainBinaries;
exports.saga = saga;

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _effects = __webpack_require__(14);

var _helpers = __webpack_require__(6);

var _actions = __webpack_require__(77);

var actions = _interopRequireWildcard(_actions);

var _adapter = __webpack_require__(78);

var _adapter2 = _interopRequireDefault(_adapter);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var _marked = /*#__PURE__*/_regenerator2.default.mark(fetchTransactionInfo),
    _marked2 = /*#__PURE__*/_regenerator2.default.mark(fetchBinary),
    _marked3 = /*#__PURE__*/_regenerator2.default.mark(inspectTransaction),
    _marked4 = /*#__PURE__*/_regenerator2.default.mark(obtainBinaries),
    _marked5 = /*#__PURE__*/_regenerator2.default.mark(receiveBinary),
    _marked6 = /*#__PURE__*/_regenerator2.default.mark(saga);

var debug = (0, _debug2.default)("debugger:web3:sagas");

function fetchTransactionInfo(adapter, _ref) {
  var txHash = _ref.txHash;
  var trace, tx, receipt;
  return _regenerator2.default.wrap(function fetchTransactionInfo$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          debug("inspecting transaction");
          _context.prev = 1;
          _context.next = 4;
          return (0, _effects.apply)(adapter, adapter.getTrace, [txHash]);

        case 4:
          trace = _context.sent;
          _context.next = 13;
          break;

        case 7:
          _context.prev = 7;
          _context.t0 = _context["catch"](1);

          debug("putting error");
          _context.next = 12;
          return (0, _effects.put)(actions.error(_context.t0));

        case 12:
          return _context.abrupt("return");

        case 13:

          debug("got trace");
          _context.next = 16;
          return (0, _effects.put)(actions.receiveTrace(trace));

        case 16:
          _context.next = 18;
          return (0, _effects.apply)(adapter, adapter.getTransaction, [txHash]);

        case 18:
          tx = _context.sent;

          if (!(tx.to && tx.to != "0x0")) {
            _context.next = 23;
            break;
          }

          _context.next = 22;
          return (0, _effects.put)(actions.receiveCall({ address: tx.to }));

        case 22:
          return _context.abrupt("return");

        case 23:
          _context.next = 25;
          return (0, _effects.apply)(adapter, adapter.getReceipt, [txHash]);

        case 25:
          receipt = _context.sent;

          if (!receipt.contractAddress) {
            _context.next = 30;
            break;
          }

          _context.next = 29;
          return (0, _effects.put)(actions.receiveCall({ binary: tx.input }));

        case 29:
          return _context.abrupt("return");

        case 30:
          throw new Error("Could not find contract associated with transaction. " + "Please make sure you're debugging a transaction that executes a " + "contract function or creates a new contract.");

        case 31:
        case "end":
          return _context.stop();
      }
    }
  }, _marked, this, [[1, 7]]);
}

function fetchBinary(adapter, _ref2) {
  var address = _ref2.address;
  var binary;
  return _regenerator2.default.wrap(function fetchBinary$(_context2) {
    while (1) {
      switch (_context2.prev = _context2.next) {
        case 0:
          debug("fetching binary for %s", address);
          _context2.next = 3;
          return (0, _effects.apply)(adapter, adapter.getDeployedCode, [address]);

        case 3:
          binary = _context2.sent;

          debug("received binary for %s", address);
          _context2.next = 7;
          return (0, _effects.put)(actions.receiveBinary(address, binary));

        case 7:
        case "end":
          return _context2.stop();
      }
    }
  }, _marked2, this);
}

function inspectTransaction(txHash, provider) {
  var action, trace, _ref4, address, binary;

  return _regenerator2.default.wrap(function inspectTransaction$(_context3) {
    while (1) {
      switch (_context3.prev = _context3.next) {
        case 0:
          _context3.next = 2;
          return (0, _effects.put)(actions.init(provider));

        case 2:
          _context3.next = 4;
          return (0, _effects.put)(actions.inspect(txHash));

        case 4:
          _context3.next = 6;
          return (0, _effects.take)(function (_ref3) {
            var type = _ref3.type;
            return type == actions.RECEIVE_TRACE || type == actions.ERROR_WEB3;
          });

        case 6:
          action = _context3.sent;

          debug("action %o", action);

          if (!(action.type == actions.RECEIVE_TRACE)) {
            _context3.next = 13;
            break;
          }

          trace = action.trace;
          debug("received trace");
          _context3.next = 14;
          break;

        case 13:
          return _context3.abrupt("return", { error: action.error });

        case 14:
          _context3.next = 16;
          return (0, _effects.take)(actions.RECEIVE_CALL);

        case 16:
          _ref4 = _context3.sent;
          address = _ref4.address;
          binary = _ref4.binary;

          debug("received call");

          return _context3.abrupt("return", { trace: trace, address: address, binary: binary });

        case 21:
        case "end":
          return _context3.stop();
      }
    }
  }, _marked3, this);
}

function obtainBinaries(addresses) {
  var tasks, binaries;
  return _regenerator2.default.wrap(function obtainBinaries$(_context4) {
    while (1) {
      switch (_context4.prev = _context4.next) {
        case 0:
          _context4.next = 2;
          return (0, _effects.all)(addresses.map(function (address) {
            return (0, _effects.fork)(receiveBinary, address);
          }));

        case 2:
          tasks = _context4.sent;

          debug("requesting binaries");
          _context4.next = 6;
          return (0, _effects.all)(addresses.map(function (address) {
            return (0, _effects.put)(actions.fetchBinary(address));
          }));

        case 6:
          binaries = [];
          _context4.next = 9;
          return (0, _effects.all)(tasks.map(function (task) {
            return (0, _effects.join)(task);
          }));

        case 9:
          binaries = _context4.sent;

          debug("binaries %o", binaries);

          return _context4.abrupt("return", binaries);

        case 12:
        case "end":
          return _context4.stop();
      }
    }
  }, _marked4, this);
}

function receiveBinary(address) {
  var _ref5, binary;

  return _regenerator2.default.wrap(function receiveBinary$(_context5) {
    while (1) {
      switch (_context5.prev = _context5.next) {
        case 0:
          _context5.next = 2;
          return (0, _effects.take)(function (action) {
            return action.type == actions.RECEIVE_BINARY && action.address == address;
          });

        case 2:
          _ref5 = _context5.sent;
          binary = _ref5.binary;

          debug("got binary for %s", address);

          return _context5.abrupt("return", binary);

        case 6:
        case "end":
          return _context5.stop();
      }
    }
  }, _marked5, this);
}

function saga() {
  var _ref6, provider, adapter;

  return _regenerator2.default.wrap(function saga$(_context6) {
    while (1) {
      switch (_context6.prev = _context6.next) {
        case 0:
          _context6.next = 2;
          return (0, _effects.take)(actions.INIT_WEB3);

        case 2:
          _ref6 = _context6.sent;
          provider = _ref6.provider;
          adapter = new _adapter2.default(provider);
          _context6.next = 7;
          return (0, _effects.takeEvery)(actions.INSPECT, fetchTransactionInfo, adapter);

        case 7:
          _context6.next = 9;
          return (0, _effects.takeEvery)(actions.FETCH_BINARY, fetchBinary, adapter);

        case 9:
        case "end":
          return _context6.stop();
      }
    }
  }, _marked6, this);
}

exports.default = (0, _helpers.prefixName)("web3", saga);

/***/ }),
/* 77 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.init = init;
exports.inspect = inspect;
exports.fetchBinary = fetchBinary;
exports.receiveBinary = receiveBinary;
exports.receiveTrace = receiveTrace;
exports.receiveCall = receiveCall;
exports.error = error;
var INIT_WEB3 = exports.INIT_WEB3 = "INIT_WEB3";
function init(provider) {
  return {
    type: INIT_WEB3,
    provider: provider
  };
}

var INSPECT = exports.INSPECT = "INSPECT_TRANSACTION";
function inspect(txHash) {
  return {
    type: INSPECT,
    txHash: txHash
  };
}

var FETCH_BINARY = exports.FETCH_BINARY = "FETCH_BINARY";
function fetchBinary(address) {
  return {
    type: FETCH_BINARY,
    address: address
  };
}

var RECEIVE_BINARY = exports.RECEIVE_BINARY = "RECEIVE_BINARY";
function receiveBinary(address, binary) {
  return {
    type: RECEIVE_BINARY,
    address: address, binary: binary
  };
}

var RECEIVE_TRACE = exports.RECEIVE_TRACE = "RECEIVE_TRACE";
function receiveTrace(trace) {
  return {
    type: RECEIVE_TRACE,
    trace: trace
  };
}

var RECEIVE_CALL = exports.RECEIVE_CALL = "RECEIVE_CALL";
function receiveCall(_ref) {
  var address = _ref.address,
      binary = _ref.binary;

  return {
    type: RECEIVE_CALL,
    address: address, binary: binary
  };
}

var ERROR_WEB3 = exports.ERROR_WEB3 = "ERROR_WEB3";
function error(error) {
  return {
    type: ERROR_WEB3,
    error: error
  };
}

/***/ }),
/* 78 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _promise = __webpack_require__(27);

var _promise2 = _interopRequireDefault(_promise);

var _asyncToGenerator2 = __webpack_require__(10);

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _classCallCheck2 = __webpack_require__(28);

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = __webpack_require__(29);

var _createClass3 = _interopRequireDefault(_createClass2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _web = __webpack_require__(11);

var _web2 = _interopRequireDefault(_web);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:web3:adapter");

var Web3Adapter = function () {
  function Web3Adapter(provider) {
    (0, _classCallCheck3.default)(this, Web3Adapter);

    this.web3 = new _web2.default(provider);
  }

  (0, _createClass3.default)(Web3Adapter, [{
    key: "getTrace",
    value: function () {
      var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee(txHash) {
        var _this = this;

        return _regenerator2.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                return _context.abrupt("return", new _promise2.default(function (accept, reject) {
                  _this.web3.currentProvider.send({
                    jsonrpc: "2.0",
                    method: "debug_traceTransaction",
                    params: [txHash, {}],
                    id: new Date().getTime()
                  }, function (err, result) {
                    if (err) return reject(err);
                    if (result.error) return reject(new Error(result.error.message));
                    debug("result: %o", result);
                    accept(result.result.structLogs);
                  });
                }));

              case 1:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function getTrace(_x) {
        return _ref.apply(this, arguments);
      }

      return getTrace;
    }()
  }, {
    key: "getTransaction",
    value: function () {
      var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2(txHash) {
        var _this2 = this;

        return _regenerator2.default.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                return _context2.abrupt("return", new _promise2.default(function (accept, reject) {
                  _this2.web3.eth.getTransaction(txHash, function (err, tx) {
                    if (err) return reject(err);

                    return accept(tx);
                  });
                }));

              case 1:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, this);
      }));

      function getTransaction(_x2) {
        return _ref2.apply(this, arguments);
      }

      return getTransaction;
    }()
  }, {
    key: "getReceipt",
    value: function () {
      var _ref3 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3(txHash) {
        var _this3 = this;

        return _regenerator2.default.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                return _context3.abrupt("return", new _promise2.default(function (accept, reject) {
                  _this3.web3.eth.getTransactionReceipt(txHash, function (err, receipt) {
                    if (err) return reject(err);

                    return accept(receipt);
                  });
                }));

              case 1:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3, this);
      }));

      function getReceipt(_x3) {
        return _ref3.apply(this, arguments);
      }

      return getReceipt;
    }()
  }, {
    key: "getDeployedCode",

    /**
     * getDeployedCode - get the deployed code for an address from the client
     * @param  {String} address
     * @return {String}         deployedBinary
     */
    value: function () {
      var _ref4 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee4(address) {
        var _this4 = this;

        return _regenerator2.default.wrap(function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                debug("getting deployed code for %s", address);
                return _context4.abrupt("return", new _promise2.default(function (accept, reject) {
                  _this4.web3.eth.getCode(address, function (err, deployedBinary) {
                    if (err) debug("error: %o", err);
                    if (err) return reject(err);
                    debug("got deployed code for %s", address);
                    accept(deployedBinary);
                  });
                }));

              case 2:
              case "end":
                return _context4.stop();
            }
          }
        }, _callee4, this);
      }));

      function getDeployedCode(_x4) {
        return _ref4.apply(this, arguments);
      }

      return getDeployedCode;
    }()
  }]);
  return Web3Adapter;
}();

exports.default = Web3Adapter;

/***/ }),
/* 79 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.FINISHED = exports.ERROR = exports.ACTIVE = exports.WAITING = undefined;
exports.session = session;

var _redux = __webpack_require__(20);

var _reducers = __webpack_require__(80);

var _reducers2 = _interopRequireDefault(_reducers);

var _reducers3 = __webpack_require__(81);

var _reducers4 = _interopRequireDefault(_reducers3);

var _reducers5 = __webpack_require__(83);

var _reducers6 = _interopRequireDefault(_reducers5);

var _reducers7 = __webpack_require__(84);

var _reducers8 = _interopRequireDefault(_reducers7);

var _actions = __webpack_require__(31);

var actions = _interopRequireWildcard(_actions);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var WAITING = exports.WAITING = "WAITING";
var ACTIVE = exports.ACTIVE = "ACTIVE";
var ERROR = exports.ERROR = "ERROR";
var FINISHED = exports.FINISHED = "FINISHED";

function session() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : WAITING;
  var action = arguments[1];

  switch (action.type) {
    case actions.READY:
      return ACTIVE;

    case actions.ERROR:
      return { error: action.error };

    case actions.FINISH:
      return FINISHED;

    default:
      return state;
  }
}

var reduceState = (0, _redux.combineReducers)({
  session: session,
  data: _reducers2.default,
  evm: _reducers4.default,
  solidity: _reducers6.default,
  trace: _reducers8.default
});

exports.default = reduceState;

/***/ }),
/* 80 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _slicedToArray2 = __webpack_require__(4);

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _entries = __webpack_require__(5);

var _entries2 = _interopRequireDefault(_entries);

var _assign = __webpack_require__(8);

var _assign2 = _interopRequireDefault(_assign);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _extends4 = __webpack_require__(13);

var _extends5 = _interopRequireDefault(_extends4);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _redux = __webpack_require__(20);

var _actions = __webpack_require__(39);

var actions = _interopRequireWildcard(_actions);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var debug = (0, _debug2.default)("debugger:data:reducers");

var DEFAULT_SCOPES = {
  byId: {}
};

function scopes() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_SCOPES;
  var action = arguments[1];

  var context;
  var scope;
  var variables;

  switch (action.type) {
    case actions.SCOPE:
      scope = state.byId[action.id] || {};

      return {
        byId: (0, _extends5.default)({}, state.byId, (0, _defineProperty3.default)({}, action.id, (0, _extends5.default)({}, scope, {

          id: action.id,
          sourceId: action.sourceId,
          parentId: action.parentId,
          pointer: action.pointer
        })))
      };

    case actions.DECLARE:
      scope = state.byId[action.node.scope] || {};
      variables = scope.variables || [];

      return {
        byId: (0, _extends5.default)({}, state.byId, (0, _defineProperty3.default)({}, action.node.scope, (0, _extends5.default)({}, scope, {

          variables: [].concat((0, _toConsumableArray3.default)(variables), [{ name: action.node.name, id: action.node.id }])
        })))
      };

    default:
      return state;
  }
}

var info = (0, _redux.combineReducers)({
  scopes: scopes
});

var DEFAULT_ASSIGNMENTS = {
  byId: {}
};

function assignments() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_ASSIGNMENTS;
  var action = arguments[1];

  switch (action.type) {
    case actions.ASSIGN:
      return {
        byId: (0, _extends5.default)({}, state.byId, _assign2.default.apply(Object, [{}].concat((0, _toConsumableArray3.default)((0, _entries2.default)(action.assignments).map(function (_ref) {
          var _ref2 = (0, _slicedToArray3.default)(_ref, 2),
              id = _ref2[0],
              ref = _ref2[1];

          return (0, _defineProperty3.default)({}, id, (0, _extends5.default)({}, state.byId[id], {
            ref: ref
          }));
        })))))
      };

    default:
      return state;
  }
};

var proc = (0, _redux.combineReducers)({
  assignments: assignments
});

var reducer = (0, _redux.combineReducers)({
  info: info,
  proc: proc
});

exports.default = reducer;

/***/ }),
/* 81 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _set = __webpack_require__(33);

var _set2 = _interopRequireDefault(_set);

var _from = __webpack_require__(82);

var _from2 = _interopRequireDefault(_from);

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _extends6 = __webpack_require__(13);

var _extends7 = _interopRequireDefault(_extends6);

exports.callstack = callstack;

var _redux = __webpack_require__(20);

var _actions = __webpack_require__(42);

var actions = _interopRequireWildcard(_actions);

var _helpers = __webpack_require__(6);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var DEFAULT_CONTEXTS = {
  byContext: {},
  byBinary: {}
};

function contexts() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_CONTEXTS;
  var action = arguments[1];

  switch (action.type) {
    /*
     * Adding a new context
     */
    case actions.ADD_CONTEXT:
      var contractName = action.contractName,
          binary = action.binary;

      if (state.byBinary[binary]) {
        return state;
      }

      var context = (0, _helpers.keccak256)(binary);

      return {
        byContext: (0, _extends7.default)({}, state.byContext, (0, _defineProperty3.default)({}, context, { context: context, binary: binary, contractName: contractName })),

        byBinary: (0, _extends7.default)({}, state.byBinary, (0, _defineProperty3.default)({}, binary, { context: context }))
      };

    /*
     * Default case
     */
    default:
      return state;
  }
}

var DEFAULT_INSTANCES = {
  byAddress: {},
  byContext: {}
};

function instances() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_INSTANCES;
  var action = arguments[1];

  switch (action.type) {
    /*
     * Adding a new address for context
     */
    case actions.ADD_INSTANCE:
      var address = action.address,
          context = action.context,
          binary = action.binary;

      // get known addresses for this context

      var otherInstances = state.byContext[context] || [];
      var otherAddresses = otherInstances.map(function (_ref) {
        var address = _ref.address;
        return address;
      });

      return {
        byAddress: (0, _extends7.default)({}, state.byAddress, (0, _defineProperty3.default)({}, address, { context: context, binary: binary })),

        byContext: (0, _extends7.default)({}, state.byContext, (0, _defineProperty3.default)({}, context, (0, _from2.default)(new _set2.default(otherAddresses).add(address)).map(function (address) {
          return { address: address };
        })))
      };

    /*
     * Default case
     */
    default:
      return state;
  }
}

var info = (0, _redux.combineReducers)({
  contexts: contexts,
  instances: instances
});

function callstack() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var action = arguments[1];

  switch (action.type) {
    case actions.CALL:
      var address = action.address;
      return state.concat([{ address: address }]);

    case actions.CREATE:
      var binary = action.binary;
      return state.concat([{ binary: binary }]);

    case actions.RETURN:
      return state.slice(0, -1); // pop

    default:
      return state;
  };
}

var proc = (0, _redux.combineReducers)({
  callstack: callstack
});

var reducer = (0, _redux.combineReducers)({
  info: info,
  proc: proc
});

exports.default = reducer;

/***/ }),
/* 82 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/core-js/array/from");

/***/ }),
/* 83 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _defineProperty2 = __webpack_require__(3);

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _extends4 = __webpack_require__(13);

var _extends5 = _interopRequireDefault(_extends4);

var _keys = __webpack_require__(22);

var _keys2 = _interopRequireDefault(_keys);

exports.functionDepth = functionDepth;

var _redux = __webpack_require__(20);

var _helpers = __webpack_require__(6);

var _actions = __webpack_require__(41);

var actions = _interopRequireWildcard(_actions);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var DEFAULT_SOURCES = {
  byId: {}
};

function sources() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_SOURCES;
  var action = arguments[1];

  switch (action.type) {
    /*
     * Adding a new source
     */
    case actions.ADD_SOURCE:
      var ast = action.ast,
          source = action.source,
          sourcePath = action.sourcePath;

      var id = (0, _keys2.default)(state.byId).length;

      return {
        byId: (0, _extends5.default)({}, state.byId, (0, _defineProperty3.default)({}, id, {
          id: id,
          ast: ast,
          source: source,
          sourcePath: sourcePath
        }))

        /*
         * Default case
         */
      };default:
      return state;
  }
}

var DEFAULT_SOURCEMAPS = {
  byContext: {}
};

function sourceMaps() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_SOURCEMAPS;
  var action = arguments[1];

  switch (action.type) {
    /*
     * Adding a new sourceMap
     */
    case actions.ADD_SOURCEMAP:
      var binary = action.binary,
          sourceMap = action.sourceMap;

      var context = (0, _helpers.keccak256)(binary);

      return {
        byContext: (0, _extends5.default)({}, state.byContext, (0, _defineProperty3.default)({}, context, {
          context: context,
          sourceMap: sourceMap
        }))
      };

    /*
     * Default Case
     */
    default:
      return state;
  }
}

var info = (0, _redux.combineReducers)({
  sources: sources,
  sourceMaps: sourceMaps
});

function functionDepth() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
  var action = arguments[1];

  if (action.type === actions.JUMP) {
    var delta = spelunk(action.jumpDirection);
    return state + delta;
  } else {
    return state;
  }
}

function spelunk(jump) {
  if (jump == "i") {
    return 1;
  } else if (jump == "o") {
    return -1;
  } else {
    return 0;
  }
}

var proc = (0, _redux.combineReducers)({
  functionDepth: functionDepth
});

var reducer = (0, _redux.combineReducers)({
  info: info,
  proc: proc
});

exports.default = reducer;

/***/ }),
/* 84 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.index = index;
exports.steps = steps;

var _redux = __webpack_require__(20);

var _actions = __webpack_require__(26);

var actions = _interopRequireWildcard(_actions);

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }newObj.default = obj;return newObj;
  }
}

function index() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
  var action = arguments[1];

  if (action.type == actions.TOCK || action.type == actions.END_OF_TRACE) {
    return state + 1;
  } else {
    return state;
  }
}

function steps() {
  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
  var action = arguments[1];

  if (action.type == actions.SAVE_STEPS) {
    return action.steps;
  } else {
    return state;
  }
}

var info = (0, _redux.combineReducers)({
  steps: steps
});

var proc = (0, _redux.combineReducers)({
  index: index
});

var reducer = (0, _redux.combineReducers)({
  info: info,
  proc: proc
});

exports.default = reducer;

/***/ }),
/* 85 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _keys = __webpack_require__(22);

var _keys2 = _interopRequireDefault(_keys);

var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _asyncToGenerator2 = __webpack_require__(10);

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _chai = __webpack_require__(17);

var _ganacheCli = __webpack_require__(21);

var _ganacheCli2 = _interopRequireDefault(_ganacheCli);

var _web = __webpack_require__(11);

var _web2 = _interopRequireDefault(_web);

var _helpers = __webpack_require__(18);

var _debugger = __webpack_require__(23);

var _debugger2 = _interopRequireDefault(_debugger);

var _selectors = __webpack_require__(43);

var _selectors2 = _interopRequireDefault(_selectors);

var _selectors3 = __webpack_require__(24);

var _selectors4 = _interopRequireDefault(_selectors3);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var debug = (0, _debug2.default)("test:context");

var __OUTER = "\npragma solidity ^0.4.18;\n\nimport \"./InnerContract.sol\";\n\ncontract OuterContract {\n  event Outer();\n\n  InnerContract inner;\n\n  function OuterContract(address _inner) public {\n    inner = InnerContract(_inner);\n  }\n\n  function run() public {\n    inner.run();\n\n    Outer();\n  }\n}\n";

var __INNER = "\npragma solidity ^0.4.18;\n\ncontract InnerContract {\n  event Inner();\n\n  function run() public {\n    Inner();\n  }\n}\n";

var __MIGRATION = "\nlet OuterContract = artifacts.require(\"OuterContract\");\nlet InnerContract = artifacts.require(\"InnerContract\");\n\nmodule.exports = function(deployer) {\n  return deployer\n    .then(function() {\n      return deployer.deploy(InnerContract);\n    })\n    .then(function() {\n      return InnerContract.deployed();\n    })\n    .then(function(inner) {\n      return deployer.deploy(OuterContract, inner.address);\n    });\n};\n";

var migrations = {
  "2_deploy_contracts.js": __MIGRATION
};

var sources = {
  "OuterLibrary.sol": __OUTER,
  "InnerContract.sol": __INNER
};

describe("Contexts", function () {
  var provider;
  var web3;

  var abstractions;
  var artifacts;

  before("Create Provider", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {
    return _regenerator2.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            provider = _ganacheCli2.default.provider({ seed: "debugger", gasLimit: 7000000 });
            web3 = new _web2.default(provider);

          case 2:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  })));

  before("Prepare contracts and artifacts", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {
    var prepared;
    return _regenerator2.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            this.timeout(30000);

            _context2.next = 3;
            return (0, _helpers.prepareContracts)(provider, sources, migrations);

          case 3:
            prepared = _context2.sent;

            abstractions = prepared.abstractions;
            artifacts = prepared.artifacts;

          case 6:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  })));

  it("returns view of addresses affected", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {
    var outer, inner, result, txHash, bugger, session, affectedInstances, affectedAddresses;
    return _regenerator2.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            _context3.next = 2;
            return abstractions.OuterContract.deployed();

          case 2:
            outer = _context3.sent;
            _context3.next = 5;
            return abstractions.InnerContract.deployed();

          case 5:
            inner = _context3.sent;
            _context3.next = 8;
            return outer.run();

          case 8:
            result = _context3.sent;


            _chai.assert.equal(2, result.receipt.logs.length, "There should be two logs");

            txHash = result.tx;
            _context3.next = 13;
            return _debugger2.default.forTx(txHash, {
              provider: provider,
              contracts: artifacts
            });

          case 13:
            bugger = _context3.sent;

            debug("debugger ready");

            session = bugger.connect();
            affectedInstances = session.view(_selectors2.default.info.affectedInstances);

            debug("affectedInstances: %o", affectedInstances);

            affectedAddresses = (0, _keys2.default)(affectedInstances).map(function (address) {
              return address.toLowerCase();
            });


            _chai.assert.equal(2, affectedAddresses.length);

            _chai.assert.include(affectedAddresses, outer.address.toLowerCase(), "OuterContract should be an affected address");

            _chai.assert.include(affectedAddresses, inner.address.toLowerCase(), "InnerContract should be an affected address");

          case 22:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, this);
  })));
});

/***/ }),
/* 86 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _stringify = __webpack_require__(87);

var _stringify2 = _interopRequireDefault(_stringify);

var _toConsumableArray2 = __webpack_require__(2);

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _selectors = __webpack_require__(7);

var _selectors2 = _interopRequireDefault(_selectors);

var _helpers = __webpack_require__(44);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var debug = (0, _debug2.default)("test:data:decode");

var uints = (0, _helpers.generateUints)();

function generateArray(length) {
  return [].concat((0, _toConsumableArray3.default)(Array(length))).map(function () {
    return uints.next().value;
  });
}

var fixtures = [{
  name: "multipleFullWordArray",
  type: "uint[]",
  value: generateArray(3) // takes up 3 whole words
}, {
  name: "withinWordArray",
  type: "uint16[]",
  value: generateArray(10) // takes up >1/2 word
}, {
  name: "multiplePartWordArray",
  type: "uint64[]",
  value: generateArray(9) // takes up 2.25 words
}, {
  name: "inconvenientlyWordOffsetArray",
  type: "uint240[]",
  value: generateArray(3) // takes up ~2.8 words
}, {
  name: "shortString",
  type: "string",
  value: "hello world"
}, {
  name: "longString",
  type: "string",
  value: "solidity allocation is a fun lesson in endianness"
}];

describe("Decoding", function () {

  /*
   * Storage Tests
   */
  (0, _helpers.describeDecoding)("Storage Variables", fixtures, _selectors2.default.current.state.storage, function (contractName) {
    return "pragma solidity ^0.4.23;\n\ncontract " + contractName + " {\n\n  event Done();\n\n  // declarations\n  " + fixtures.map(function (_ref) {
      var type = _ref.type,
          name = _ref.name;
      return type + " " + name + ";";
    }).join("\n  ") + "\n\n  function run() public {\n    " + fixtures.map(function (_ref2) {
      var name = _ref2.name,
          value = _ref2.value;
      return name + " = " + (0, _stringify2.default)(value) + ";";
    }).join("\n    ") + "\n\n    emit Done();\n  }\n}\n";
  });

  /*
   * Memory Tests
   */
  (0, _helpers.describeDecoding)("Memory Variables", fixtures, _selectors2.default.current.state.memory, function (contractName) {
    var separator = ";\n    ";

    function declareAssign(_ref3) {
      var name = _ref3.name,
          type = _ref3.type,
          value = _ref3.value;

      if (type.indexOf("[]") != -1) {
        // array, must `new`
        var declare = type + " memory " + name + " = new " + type + "(" + value.length + ")";
        var assigns = value.map(function (k, i) {
          return name + "[" + i + "] = " + k;
        });
        return "" + declare + separator + assigns.join(separator);
      } else {
        return type + " memory " + name + " = " + (0, _stringify2.default)(value);
      }
    }

    return "pragma solidity ^0.4.23;\n\ncontract " + contractName + " {\n\n  event Done();\n\n  function run() public {\n    uint i;\n    // declarations\n    " + fixtures.map(declareAssign).join(separator) + ";\n\n    emit Done();\n  }\n}\n";
  });
});

/***/ }),
/* 87 */
/***/ (function(module, exports) {

module.exports = require("babel-runtime/core-js/json/stringify");

/***/ }),
/* 88 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _chai = __webpack_require__(17);

var _bignumber = __webpack_require__(25);

var _utils = __webpack_require__(15);

var utils = _interopRequireWildcard(_utils);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var debug = (0, _debug2.default)("test:data:decode:utils");

describe("Utils", function () {
  describe("toBigNumber()", function () {
    it("returns correct value", function () {
      var bytes = [0xf5, 0xe2, 0xc5, 0x17];
      var expectedValue = new _bignumber.BigNumber("f5e2c517", 16);

      var result = utils.toBigNumber(bytes);

      _chai.assert.equal(result.toString(), expectedValue.toString());
    });
  });

  describe("toSignedBigNumber()", function () {
    it("returns correct negative value", function () {
      var bytes = [0xf5, 0xe2, 0xc5, 0x17]; // starts with 0b1
      var raw = new _bignumber.BigNumber("f5e2c517", 16);
      var bitfipped = new _bignumber.BigNumber(raw.toString(2).replace(/0/g, "x").replace(/1/g, "0").replace(/x/g, "1"), 2);

      var expectedValue = bitfipped.plus(1).negated();

      var result = utils.toSignedBigNumber(bytes);

      _chai.assert.equal(result.toString(), expectedValue.toString());
    });

    it("returns correct positive value", function () {
      var bytes = [0x05, 0xe2, 0xc5, 0x17]; // starts with 0b0
      var raw = new _bignumber.BigNumber("05e2c517", 16);
      var expectedValue = raw;

      var result = utils.toSignedBigNumber(bytes);

      _chai.assert.equal(result.toString(), expectedValue.toString());
    });
  });

  describe("toHexString()", function () {
    it("returns correct representation with full bytes", function () {
      // ie, 0x00 instead of 0x0
      _chai.assert.equal(utils.toHexString([0x05, 0x11]), "0x0511");
      _chai.assert.equal(utils.toHexString([0xff, 0x00, 0xff]), "0xff00ff");
    });

    it("allows removing leading zeroes", function () {
      _chai.assert.equal(utils.toHexString([0x00, 0x00, 0xcc], true), "0xcc");
    });
  });
});

/***/ }),
/* 89 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _asyncToGenerator2 = __webpack_require__(10);

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _chai = __webpack_require__(17);

var _ganacheCli = __webpack_require__(21);

var _ganacheCli2 = _interopRequireDefault(_ganacheCli);

var _web = __webpack_require__(11);

var _web2 = _interopRequireDefault(_web);

var _helpers = __webpack_require__(18);

var _debugger = __webpack_require__(23);

var _debugger2 = _interopRequireDefault(_debugger);

var _selectors = __webpack_require__(7);

var _selectors2 = _interopRequireDefault(_selectors);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var debug = (0, _debug2.default)("test:solidity");

var __OUTER = "\npragma solidity ^0.4.18;\n\nimport \"./Inner.sol\";\n\ncontract Outer {\n  event Called();\n\n  Inner inner;\n\n  function Outer(address _inner) {\n    inner = Inner(_inner);\n  }\n\n  function runSingle() public {\n  }\n\n  function run() public {\n    inner.run();\n  }\n}\n";

var __INNER = "\npragma solidity ^0.4.18;\n\ncontract Inner {\n  function run() public {\n  }\n}\n";

var __MIGRATION = "\nlet Outer = artifacts.require(\"Outer\");\nlet Inner = artifacts.require(\"Inner\");\n\nmodule.exports = function(deployer) {\n  return deployer\n    .then(function() {\n      return deployer.deploy(Inner);\n    })\n    .then(function() {\n      return Inner.deployed();\n    })\n    .then(function(inner) {\n      return deployer.deploy(Outer, inner.address);\n    });\n};\n";

var sources = {
  "Inner.sol": __INNER,
  "Outer.sol": __OUTER
};

var migrations = {
  "2_deploy_contracts.js": __MIGRATION
};

describe("EVM Debugging", function () {
  var provider;
  var web3;

  var abstractions;
  var artifacts;
  var files;

  before("Create Provider", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {
    return _regenerator2.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            provider = _ganacheCli2.default.provider({ seed: "debugger", gasLimit: 7000000 });
            web3 = new _web2.default(provider);

          case 2:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  })));

  before("Prepare contracts and artifacts", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {
    var prepared;
    return _regenerator2.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            this.timeout(30000);

            _context2.next = 3;
            return (0, _helpers.prepareContracts)(provider, sources, migrations);

          case 3:
            prepared = _context2.sent;

            abstractions = prepared.abstractions;
            artifacts = prepared.artifacts;
            files = prepared.files;

          case 7:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  })));

  describe("Function Depth", function () {
    it("remains at 1 in absence of cross-contract calls", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {
      var maxExpected, instance, receipt, txHash, bugger, session, stepped, actual;
      return _regenerator2.default.wrap(function _callee3$(_context3) {
        while (1) {
          switch (_context3.prev = _context3.next) {
            case 0:
              maxExpected = 1;
              _context3.next = 3;
              return abstractions.Inner.deployed();

            case 3:
              instance = _context3.sent;
              _context3.next = 6;
              return instance.run();

            case 6:
              receipt = _context3.sent;
              txHash = receipt.tx;
              _context3.next = 10;
              return _debugger2.default.forTx(txHash, {
                provider: provider,
                files: files,
                contracts: artifacts
              });

            case 10:
              bugger = _context3.sent;
              session = bugger.connect();
              // session steppers return false when done

              do {
                stepped = session.stepNext();

                actual = session.view(_selectors2.default.current.callstack).length;


                _chai.assert.isAtMost(actual, maxExpected);
              } while (stepped);

            case 13:
            case "end":
              return _context3.stop();
          }
        }
      }, _callee3, this);
    })));

    it("tracks callstack correctly", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee4() {
      var instance, receipt, txHash, bugger, session, expectedDepthSequence, actualSequence, stepped, currentDepth, lastKnown;
      return _regenerator2.default.wrap(function _callee4$(_context4) {
        while (1) {
          switch (_context4.prev = _context4.next) {
            case 0:
              _context4.next = 2;
              return abstractions.Outer.deployed();

            case 2:
              instance = _context4.sent;
              _context4.next = 5;
              return instance.run();

            case 5:
              receipt = _context4.sent;
              txHash = receipt.tx;
              _context4.next = 9;
              return _debugger2.default.forTx(txHash, {
                provider: provider,
                files: files,
                contracts: artifacts
              });

            case 9:
              bugger = _context4.sent;
              session = bugger.connect();

              // follow callstack length values in list
              // see source above

              expectedDepthSequence = [1, 2, 1, 0];
              actualSequence = [session.view(_selectors2.default.current.callstack).length];


              do {
                stepped = session.stepNext();

                currentDepth = session.view(_selectors2.default.current.callstack).length;
                lastKnown = actualSequence[actualSequence.length - 1];


                if (currentDepth !== lastKnown) {
                  actualSequence.push(currentDepth);
                }
              } while (stepped);

              _chai.assert.deepEqual(actualSequence, expectedDepthSequence);

            case 15:
            case "end":
              return _context4.stop();
          }
        }
      }, _callee4, this);
    })));
  });
});

/***/ }),
/* 90 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _regenerator = __webpack_require__(1);

var _regenerator2 = _interopRequireDefault(_regenerator);

var _asyncToGenerator2 = __webpack_require__(10);

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _debug = __webpack_require__(0);

var _debug2 = _interopRequireDefault(_debug);

var _chai = __webpack_require__(17);

var _ganacheCli = __webpack_require__(21);

var _ganacheCli2 = _interopRequireDefault(_ganacheCli);

var _web = __webpack_require__(11);

var _web2 = _interopRequireDefault(_web);

var _helpers = __webpack_require__(18);

var _debugger = __webpack_require__(23);

var _debugger2 = _interopRequireDefault(_debugger);

var _selectors = __webpack_require__(9);

var _selectors2 = _interopRequireDefault(_selectors);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var debug = (0, _debug2.default)("test:solidity");

var __SINGLE_CALL = "\npragma solidity ^0.4.18;\n\ncontract SingleCall {\n  event Called();\n\n  function run() public {\n    Called();\n  }\n}\n";

var __NESTED_CALL = "pragma solidity ^0.4.18;\n\ncontract NestedCall {\n  event First();\n  event Second();\n\n  // run()\n  //   first()    1\n  //     inner()  2\n  //       event  3\n  //              2\n  //   second     1\n  //     event    2\n  //              1\n  function run() public {\n    first();\n    second();\n  }\n\n  function first() public {\n    inner();\n  }\n\n  function inner() public {\n    First();\n  }\n\n  function second() public {\n    Second();\n  }\n\n}\n";

var sources = {
  "SingleCall.sol": __SINGLE_CALL,
  "NestedCall.sol": __NESTED_CALL
};

describe("Solidity Debugging", function () {
  var provider;
  var web3;

  var abstractions;
  var artifacts;
  var files;

  before("Create Provider", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {
    return _regenerator2.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            provider = _ganacheCli2.default.provider({ seed: "debugger", gasLimit: 7000000 });
            web3 = new _web2.default(provider);

          case 2:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  })));

  before("Prepare contracts and artifacts", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {
    var prepared;
    return _regenerator2.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            this.timeout(30000);

            _context2.next = 3;
            return (0, _helpers.prepareContracts)(provider, sources);

          case 3:
            prepared = _context2.sent;

            abstractions = prepared.abstractions;
            artifacts = prepared.artifacts;
            files = prepared.files;

          case 7:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  })));

  it("exposes functionality to stop at breakpoints", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {
    var instance, receipt, txHash, bugger, session, breakpoint, breakpointStopped, range;
    return _regenerator2.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            _context3.next = 2;
            return abstractions.NestedCall.deployed();

          case 2:
            instance = _context3.sent;
            _context3.next = 5;
            return instance.run();

          case 5:
            receipt = _context3.sent;
            txHash = receipt.tx;
            _context3.next = 9;
            return _debugger2.default.forTx(txHash, {
              provider: provider,
              files: files,
              contracts: artifacts
            });

          case 9:
            bugger = _context3.sent;
            session = bugger.connect();

            // at `second();`

            breakpoint = { "address": instance.address, line: 16 };
            breakpointStopped = false;

          case 13:
            session.continueUntil(breakpoint);

            if (session.finished) {
              _context3.next = 20;
              break;
            }

            _context3.next = 17;
            return session.view(_selectors2.default.current.sourceRange);

          case 17:
            range = _context3.sent;

            _chai.assert.equal(range.lines.start.line, 16);

            breakpointStopped = true;

          case 20:
            if (!session.finished) {
              _context3.next = 13;
              break;
            }

          case 21:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, this);
  })));

  describe("Function Depth", function () {
    it("remains at 1 in absence of inner function calls", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee4() {
      var maxExpected, instance, receipt, txHash, bugger, session, stepped, actual;
      return _regenerator2.default.wrap(function _callee4$(_context4) {
        while (1) {
          switch (_context4.prev = _context4.next) {
            case 0:
              maxExpected = 1;
              _context4.next = 3;
              return abstractions.SingleCall.deployed();

            case 3:
              instance = _context4.sent;
              _context4.next = 6;
              return instance.run();

            case 6:
              receipt = _context4.sent;
              txHash = receipt.tx;
              _context4.next = 10;
              return _debugger2.default.forTx(txHash, {
                provider: provider,
                files: files,
                contracts: artifacts
              });

            case 10:
              bugger = _context4.sent;
              session = bugger.connect();
              // session steppers return false when done

              do {
                stepped = session.stepNext();

                actual = session.view(_selectors2.default.current.functionDepth);


                _chai.assert.isAtMost(actual, maxExpected);
              } while (stepped);

            case 13:
            case "end":
              return _context4.stop();
          }
        }
      }, _callee4, this);
    })));

    it("spelunks correctly", (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee5() {
      var instance, receipt, txHash, bugger, session, expectedDepthSequence, actualSequence, stepped, currentDepth, lastKnown;
      return _regenerator2.default.wrap(function _callee5$(_context5) {
        while (1) {
          switch (_context5.prev = _context5.next) {
            case 0:
              _context5.next = 2;
              return abstractions.NestedCall.deployed();

            case 2:
              instance = _context5.sent;
              _context5.next = 5;
              return instance.run();

            case 5:
              receipt = _context5.sent;
              txHash = receipt.tx;
              _context5.next = 9;
              return _debugger2.default.forTx(txHash, {
                provider: provider,
                files: files,
                contracts: artifacts
              });

            case 9:
              bugger = _context5.sent;
              session = bugger.connect();

              // follow functionDepth values in list
              // see source above

              expectedDepthSequence = [1, 2, 3, 2, 1, 2, 1, 0];
              actualSequence = [session.view(_selectors2.default.current.functionDepth)];


              do {
                stepped = session.stepNext();

                currentDepth = session.view(_selectors2.default.current.functionDepth);
                lastKnown = actualSequence[actualSequence.length - 1];


                if (currentDepth !== lastKnown) {
                  actualSequence.push(currentDepth);
                }
              } while (stepped);

              _chai.assert.deepEqual(actualSequence, expectedDepthSequence);

            case 15:
            case "end":
              return _context5.stop();
          }
        }
      }, _callee5, this);
    })));
  });
});

/***/ })
/******/ ]);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrL2Jvb3RzdHJhcCAwOWEzYjM2NmY3MDlmYzgxNTVjZSIsImV4dGVybmFsIFwiZGVidWdcIiIsImV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9yZWdlbmVyYXRvclwiIiwiZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvdG9Db25zdW1hYmxlQXJyYXlcIiIsImV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2RlZmluZVByb3BlcnR5XCIiLCJleHRlcm5hbCBcImJhYmVsLXJ1bnRpbWUvaGVscGVycy9zbGljZWRUb0FycmF5XCIiLCJleHRlcm5hbCBcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZW50cmllc1wiIiwibGliL2hlbHBlcnMvaW5kZXguanMiLCJsaWIvZXZtL3NlbGVjdG9ycy9pbmRleC5qcyIsImV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9hc3NpZ25cIiIsImxpYi9zb2xpZGl0eS9zZWxlY3RvcnMvaW5kZXguanMiLCJleHRlcm5hbCBcImJhYmVsLXJ1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yXCIiLCJleHRlcm5hbCBcIndlYjNcIiIsImV4dGVybmFsIFwicmVzZWxlY3QtdHJlZVwiIiwiZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZXh0ZW5kc1wiIiwiZXh0ZXJuYWwgXCJyZWR1eC1zYWdhL2VmZmVjdHNcIiIsImxpYi9kYXRhL2RlY29kZS91dGlscy5qcyIsImV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL2dldC1pdGVyYXRvclwiIiwiZXh0ZXJuYWwgXCJjaGFpXCIiLCJ0ZXN0L2hlbHBlcnMuanMiLCJsaWIvYXN0L3NlbGVjdG9ycy9pbmRleC5qcyIsImV4dGVybmFsIFwicmVkdXhcIiIsImV4dGVybmFsIFwiZ2FuYWNoZS1jbGlcIiIsImV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzXCIiLCJsaWIvZGVidWdnZXIuanMiLCJsaWIvdHJhY2Uvc2VsZWN0b3JzL2luZGV4LmpzIiwiZXh0ZXJuYWwgXCJiaWdudW1iZXIuanNcIiIsImxpYi90cmFjZS9hY3Rpb25zL2luZGV4LmpzIiwiZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZVwiIiwiZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIiIsImV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzXCIiLCJleHRlcm5hbCBcImpzb24tcG9pbnRlclwiIiwibGliL3Nlc3Npb24vYWN0aW9ucy9pbmRleC5qcyIsImxpYi9kYXRhL3NlbGVjdG9ycy9pbmRleC5qcyIsImV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL3NldFwiIiwiZXh0ZXJuYWwgXCJ0cnVmZmxlLWV4cGVjdFwiIiwiZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvdHlwZW9mXCIiLCJsaWIvYXN0L21hcC5qcyIsImxpYi9jb250cm9sbGVyL2FjdGlvbnMvaW5kZXguanMiLCJsaWIvZGF0YS9zYWdhcy9pbmRleC5qcyIsImxpYi9kYXRhL2FjdGlvbnMvaW5kZXguanMiLCJsaWIvdHJhY2Uvc2FnYXMvaW5kZXguanMiLCJsaWIvc29saWRpdHkvYWN0aW9ucy9pbmRleC5qcyIsImxpYi9ldm0vYWN0aW9ucy9pbmRleC5qcyIsImxpYi9zZXNzaW9uL3NlbGVjdG9ycy9pbmRleC5qcyIsInRlc3QvZGF0YS9kZWNvZGUvaGVscGVycy5qcyIsIi9Vc2Vycy9nbmlkYW4vc3JjL3dvcmsvdHJ1ZmZsZS9ub2RlX21vZHVsZXMvbW9jaGEtd2VicGFjay9saWIvZW50cnkuanMiLCJ0ZXN0L2FzdC5qcyIsImV4dGVybmFsIFwicGF0aFwiIiwiZXh0ZXJuYWwgXCJmcy1leHRyYVwiIiwiZXh0ZXJuYWwgXCJhc3luY1wiIiwiZXh0ZXJuYWwgXCJ0cnVmZmxlLXdvcmtmbG93LWNvbXBpbGVcIiIsImV4dGVybmFsIFwidHJ1ZmZsZS1kZWJ1Zy11dGlsc1wiIiwiZXh0ZXJuYWwgXCJ0cnVmZmxlLWFydGlmYWN0b3JcIiIsImV4dGVybmFsIFwidHJ1ZmZsZS1taWdyYXRlXCIiLCJleHRlcm5hbCBcInRydWZmbGUtYm94XCIiLCJleHRlcm5hbCBcInRydWZmbGUtcmVzb2x2ZXJcIiIsImxpYi9zZXNzaW9uL2luZGV4LmpzIiwiZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L3ZhbHVlc1wiIiwiZXh0ZXJuYWwgXCJ0cnVmZmxlLXNvbGlkaXR5LXV0aWxzXCIiLCJleHRlcm5hbCBcInRydWZmbGUtY29kZS11dGlsc1wiIiwiZXh0ZXJuYWwgXCJub2RlLWludGVydmFsLXRyZWVcIiIsImxpYi9zdG9yZS9pbmRleC5qcyIsImxpYi9zdG9yZS90ZXN0LmpzIiwibGliL3N0b3JlL2NvbW1vbi5qcyIsImV4dGVybmFsIFwicmVkdXgtc2FnYVwiIiwiZXh0ZXJuYWwgXCJyZWR1eC1jbGktbG9nZ2VyXCIiLCJsaWIvc2Vzc2lvbi9zYWdhcy9pbmRleC5qcyIsImxpYi9hc3Qvc2FnYXMvaW5kZXguanMiLCJsaWIvZGF0YS9kZWNvZGUvaW5kZXguanMiLCJsaWIvZGF0YS9kZWNvZGUvbWVtb3J5LmpzIiwibGliL2RhdGEvZGVjb2RlL3N0b3JhZ2UuanMiLCJsaWIvYXN0L2FjdGlvbnMvaW5kZXguanMiLCJsaWIvY29udHJvbGxlci9zYWdhcy9pbmRleC5qcyIsImxpYi9jb250cm9sbGVyL3NlbGVjdG9ycy9pbmRleC5qcyIsImxpYi9zb2xpZGl0eS9zYWdhcy9pbmRleC5qcyIsImxpYi9ldm0vc2FnYXMvaW5kZXguanMiLCJsaWIvd2ViMy9zYWdhcy9pbmRleC5qcyIsImxpYi93ZWIzL2FjdGlvbnMvaW5kZXguanMiLCJsaWIvd2ViMy9hZGFwdGVyLmpzIiwibGliL3Nlc3Npb24vcmVkdWNlcnMuanMiLCJsaWIvZGF0YS9yZWR1Y2Vycy5qcyIsImxpYi9ldm0vcmVkdWNlcnMuanMiLCJleHRlcm5hbCBcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9hcnJheS9mcm9tXCIiLCJsaWIvc29saWRpdHkvcmVkdWNlcnMuanMiLCJsaWIvdHJhY2UvcmVkdWNlcnMuanMiLCJ0ZXN0L2NvbnRleHQuanMiLCJ0ZXN0L2RhdGEvZGVjb2RlL2RlY29kaW5nLmpzIiwiZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2NvcmUtanMvanNvbi9zdHJpbmdpZnlcIiIsInRlc3QvZGF0YS9kZWNvZGUvdXRpbHMuanMiLCJ0ZXN0L2V2bS5qcyIsInRlc3Qvc29saWRpdHkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJEZWJ1Z2dlclwiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJEZWJ1Z2dlclwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJEZWJ1Z2dlclwiXSA9IGZhY3RvcnkoKTtcbn0pKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiBcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNDUpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDA5YTNiMzY2ZjcwOWZjODE1NWNlIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZGVidWdcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJkZWJ1Z1wiXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvcmVnZW5lcmF0b3JcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL3JlZ2VuZXJhdG9yXCJcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL3RvQ29uc3VtYWJsZUFycmF5XCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL3RvQ29uc3VtYWJsZUFycmF5XCJcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2RlZmluZVByb3BlcnR5XCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2RlZmluZVByb3BlcnR5XCJcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL3NsaWNlZFRvQXJyYXlcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvc2xpY2VkVG9BcnJheVwiXG4vLyBtb2R1bGUgaWQgPSA0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZW50cmllc1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZW50cmllc1wiXG4vLyBtb2R1bGUgaWQgPSA1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGtlY2NhazI1NiBhcyBfa2VjY2FrMjU2LCB0b0hleFN0cmluZyB9IGZyb20gXCJsaWIvZGF0YS9kZWNvZGUvdXRpbHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHByZWZpeE5hbWUocHJlZml4LCBmbikge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZm4sICduYW1lJywge1xuICAgIHZhbHVlOiBgJHtwcmVmaXh9LiR7Zm4ubmFtZX1gLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICB9KTtcblxuICByZXR1cm4gZm47XG59XG5cbi8qKlxuICogQHJldHVybiAweC1wcmVmaXggc3RyaW5nIG9mIGtlY2NhazI1NiBoYXNoXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBrZWNjYWsyNTYoLi4uYXJncykge1xuICByZXR1cm4gdG9IZXhTdHJpbmcoX2tlY2NhazI1NiguLi5hcmdzKSk7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL2hlbHBlcnMvaW5kZXguanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6ZXZtOnNlbGVjdG9yc1wiKTtcblxuaW1wb3J0IHsgY3JlYXRlU2VsZWN0b3JUcmVlLCBjcmVhdGVMZWFmIH0gZnJvbSBcInJlc2VsZWN0LXRyZWVcIjtcblxuaW1wb3J0IHRyYWNlIGZyb20gXCJsaWIvdHJhY2Uvc2VsZWN0b3JzXCI7XG5cbmNvbnN0IFdPUkRfU0laRSA9IDB4MjA7XG5cbi8qKlxuICogY3JlYXRlIEVWTS1sZXZlbCBzZWxlY3RvcnMgZm9yIGEgZ2l2ZW4gdHJhY2Ugc3RlcCBzZWxlY3RvclxuICogbWF5IHNwZWNpZnkgYWRkaXRpb25hbCBzZWxlY3RvcnMgdG8gaW5jbHVkZVxuICovXG5mdW5jdGlvbiBjcmVhdGVTdGVwU2VsZWN0b3JzKHN0ZXAsIHN0YXRlID0gbnVsbCkge1xuICBsZXQgYmFzZSA9IHtcbiAgICAvKipcbiAgICAgKiAudHJhY2VcbiAgICAgKlxuICAgICAqIHRyYWNlIHN0ZXAgaW5mbyByZWxhdGVkIHRvIG9wZXJhdGlvblxuICAgICAqL1xuICAgIHRyYWNlOiBjcmVhdGVMZWFmKFxuICAgICAgW3N0ZXBdLCAoe2dhc0Nvc3QsIG9wLCBwY30pID0+ICh7Z2FzQ29zdCwgb3AsIHBjfSlcbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogLnByb2dyYW1Db3VudGVyXG4gICAgICovXG4gICAgcHJvZ3JhbUNvdW50ZXI6IGNyZWF0ZUxlYWYoXG4gICAgICBbXCIuL3RyYWNlXCJdLCAoc3RlcCkgPT4gc3RlcC5wY1xuICAgICksXG5cbiAgICAvKipcbiAgICAgKiAuaXNKdW1wXG4gICAgICovXG4gICAgaXNKdW1wOiBjcmVhdGVMZWFmKFxuICAgICAgW1wiLi90cmFjZVwiXSwgKHN0ZXApID0+IChcbiAgICAgICAgc3RlcC5vcCAhPSBcIkpVTVBERVNUXCIgJiYgc3RlcC5vcC5pbmRleE9mKFwiSlVNUFwiKSA9PSAwXG4gICAgICApXG4gICAgKSxcblxuICAgIC8qKlxuICAgICAqIC5pc0NhbGxcbiAgICAgKlxuICAgICAqIHdoZXRoZXIgdGhlIG9wY29kZSB3aWxsIHN3aXRjaCB0byBhbm90aGVyIGNhbGxpbmcgY29udGV4dFxuICAgICAqL1xuICAgIGlzQ2FsbDogY3JlYXRlTGVhZihcbiAgICAgIFtcIi4vdHJhY2VcIl0sIChzdGVwKSA9PiBzdGVwLm9wID09IFwiQ0FMTFwiIHx8IHN0ZXAub3AgPT0gXCJERUxFR0FURUNBTExcIlxuICAgICksXG5cbiAgICAvKipcbiAgICAgKiAuaXNDcmVhdGVcbiAgICAgKi9cbiAgICBpc0NyZWF0ZTogY3JlYXRlTGVhZihcbiAgICAgIFtcIi4vdHJhY2VcIl0sIChzdGVwKSA9PiBzdGVwLm9wID09IFwiQ1JFQVRFXCJcbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogLmlzSGFsdGluZ1xuICAgICAqXG4gICAgICogd2hldGhlciB0aGUgaW5zdHJ1Y3Rpb24gaGFsdHMgb3IgcmV0dXJucyBmcm9tIGEgY2FsbGluZyBjb250ZXh0XG4gICAgICovXG4gICAgaXNIYWx0aW5nOiBjcmVhdGVMZWFmKFxuICAgICAgW1wiLi90cmFjZVwiXSwgKHN0ZXApID0+IHN0ZXAub3AgPT0gXCJTVE9QXCIgfHwgc3RlcC5vcCA9PSBcIlJFVFVSTlwiXG4gICAgKVxuICB9O1xuXG4gIGlmIChzdGF0ZSkge1xuICAgIGNvbnN0IGlzUmVsYXRpdmUgPSAocGF0aCkgPT4gKFxuICAgICAgdHlwZW9mIHBhdGggPT0gXCJzdHJpbmdcIiAmJiAoXG4gICAgICAgIHBhdGguc3RhcnRzV2l0aChcIi4vXCIpIHx8IHBhdGguc3RhcnRzV2l0aChcIi4uL1wiKVxuICAgICAgKVxuICAgICk7XG5cbiAgICBpZiAoaXNSZWxhdGl2ZShzdGF0ZSkpIHtcbiAgICAgIHN0YXRlID0gYC4uLyR7c3RhdGV9YDtcbiAgICB9XG5cbiAgICBPYmplY3QuYXNzaWduKGJhc2UsIHtcbiAgICAgIC8qKlxuICAgICAgICogLmNhbGxBZGRyZXNzXG4gICAgICAgKlxuICAgICAgICogYWRkcmVzcyB0cmFuc2ZlcnJlZCB0byBieSBjYWxsIG9wZXJhdGlvblxuICAgICAgICovXG4gICAgICBjYWxsQWRkcmVzczogY3JlYXRlTGVhZihcbiAgICAgICAgW1wiLi9pc0NhbGxcIiwgXCIuL3RyYWNlXCIsIHN0YXRlXSxcblxuICAgICAgICAobWF0Y2hlcywgc3RlcCwge3N0YWNrfSkgPT4ge1xuICAgICAgICAgIGlmICghbWF0Y2hlcykgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICBsZXQgYWRkcmVzcyA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDJdXG4gICAgICAgICAgYWRkcmVzcyA9IFwiMHhcIiArIGFkZHJlc3Muc3Vic3RyaW5nKDI0KTtcbiAgICAgICAgICByZXR1cm4gYWRkcmVzcztcbiAgICAgICAgfVxuICAgICAgKSxcblxuICAgICAgLyoqXG4gICAgICAgKiAuY3JlYXRlQmluYXJ5XG4gICAgICAgKlxuICAgICAgICogYmluYXJ5IGNvZGUgdG8gZXhlY3V0ZSB2aWEgY3JlYXRlIG9wZXJhdGlvblxuICAgICAgICovXG4gICAgICBjcmVhdGVCaW5hcnk6IGNyZWF0ZUxlYWYoXG4gICAgICAgIFtcIi4vaXNDcmVhdGVcIiwgXCIuL3RyYWNlXCIsIHN0YXRlXSxcblxuICAgICAgICAobWF0Y2hlcywgc3RlcCwge3N0YWNrLCBtZW1vcnl9KSA9PiB7XG4gICAgICAgICAgaWYgKCFtYXRjaGVzKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgIC8vIEdldCB0aGUgY29kZSB0aGF0J3MgZ29pbmcgdG8gYmUgY3JlYXRlZCBmcm9tIG1lbW9yeS5cbiAgICAgICAgICAvLyBOb3RlIHdlIG11bHRpcGx5IGJ5IDIgYmVjYXVzZSB0aGVzZSBvZmZzZXRzIGFyZSBpbiBieXRlcy5cbiAgICAgICAgICBjb25zdCBvZmZzZXQgPSBwYXJzZUludChzdGFja1tzdGFjay5sZW5ndGggLSAyXSwgMTYpICogMjtcbiAgICAgICAgICBjb25zdCBsZW5ndGggPSBwYXJzZUludChzdGFja1tzdGFjay5sZW5ndGggLSAzXSwgMTYpICogMjtcblxuICAgICAgICAgIHJldHVybiBcIjB4XCIgKyBtZW1vcnkuam9pbihcIlwiKS5zdWJzdHJpbmcob2Zmc2V0LCBvZmZzZXQgKyBsZW5ndGgpO1xuICAgICAgICB9XG4gICAgICApXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gYmFzZTtcbn1cblxuY29uc3QgZXZtID0gY3JlYXRlU2VsZWN0b3JUcmVlKHtcbiAgLyoqXG4gICAqIGV2bS5zdGF0ZVxuICAgKi9cbiAgc3RhdGU6IChzdGF0ZSkgPT4gc3RhdGUuZXZtLFxuXG4gIC8qKlxuICAgKiBldm0uaW5mb1xuICAgKi9cbiAgaW5mbzoge1xuICAgIC8qKlxuICAgICAqIGV2bS5pbmZvLmNvbnRleHRzXG4gICAgICovXG4gICAgY29udGV4dHM6IGNyZWF0ZUxlYWYoWycvc3RhdGUnXSwgKHN0YXRlKSA9PiBzdGF0ZS5pbmZvLmNvbnRleHRzLmJ5Q29udGV4dCksXG5cbiAgICAvKipcbiAgICAgKiBldm0uaW5mby5pbnN0YW5jZXNcbiAgICAgKi9cbiAgICBpbnN0YW5jZXM6IGNyZWF0ZUxlYWYoWycvc3RhdGUnXSwgKHN0YXRlKSA9PiBzdGF0ZS5pbmZvLmluc3RhbmNlcy5ieUFkZHJlc3MpLFxuXG4gICAgLyoqXG4gICAgICogZXZtLmluZm8uYmluYXJpZXNcbiAgICAgKi9cbiAgICBiaW5hcmllczoge1xuICAgICAgXzogY3JlYXRlTGVhZihbJy9zdGF0ZSddLCAoc3RhdGUpID0+IHN0YXRlLmluZm8uY29udGV4dHMuYnlCaW5hcnkpLFxuXG4gICAgICAvKipcbiAgICAgICAqIGV2bS5pbmZvLmJpbmFyaWVzLnNlYXJjaFxuICAgICAgICpcbiAgICAgICAqIHJldHVybnMgZnVuY3Rpb24gKGJpbmFyeSkgPT4gY29udGV4dFxuICAgICAgICovXG4gICAgICBzZWFyY2g6IGNyZWF0ZUxlYWYoWycuL18nXSwgKGJpbmFyaWVzKSA9PiB7XG4gICAgICAgIC8vIEhBQ0sgaWdub3JlIGxpbmsgcmVmZXJlbmNlcyBmb3Igc2VhcmNoXG4gICAgICAgIC8vIGxpbmsgcmVmZXJlbmNlcyBjb21lIGluIHR3byBmb3Jtczogd2l0aCB1bmRlcnNjb3JlcyBvciBhbGwgemVyb2VzXG4gICAgICAgIC8vIHRoZSB1bmRlcnNjb3JlIGZvcm1hdCBpcyB1c2VkIGJ5IFRydWZmbGUgdG8gcmVmZXJlbmNlIGxpbmtzIGJ5IG5hbWVcbiAgICAgICAgLy8gemVyb2VzIGFyZSB1c2VkIGJ5IHNvbGMgZGlyZWN0bHksIGFzIGxpYnJhcmllcyBpbmplY3QgdGhlaXIgb3duXG4gICAgICAgIC8vIGFkZHJlc3MgYXQgQ1JFQVRFLXRpbWVcbiAgICAgICAgY29uc3QgdG9SZWdFeHAgPSAoYmluYXJ5KSA9PlxuICAgICAgICAgIG5ldyBSZWdFeHAoYF4ke2JpbmFyeS5yZXBsYWNlKC9fXy57Mzh9fDB7NDB9L2csIFwiLns0MH1cIil9YClcblxuICAgICAgICBsZXQgbWF0Y2hlcnMgPSBPYmplY3QuZW50cmllcyhiaW5hcmllcylcbiAgICAgICAgICAubWFwKCAoW2JpbmFyeSwge2NvbnRleHR9XSkgPT4gKHtcbiAgICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgICByZWdleDogdG9SZWdFeHAoYmluYXJ5KVxuICAgICAgICAgIH0pKVxuXG4gICAgICAgIHJldHVybiAoYmluYXJ5KSA9PiBtYXRjaGVyc1xuICAgICAgICAgIC5maWx0ZXIoICh7IGNvbnRleHQsIHJlZ2V4IH0pID0+IGJpbmFyeS5tYXRjaChyZWdleCkgKVxuICAgICAgICAgIC5tYXAoICh7IGNvbnRleHQgfSkgPT4gKHsgY29udGV4dCB9KSApXG4gICAgICAgICAgWzBdIHx8IG51bGw7XG4gICAgICB9KVxuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogZXZtLmN1cnJlbnRcbiAgICovXG4gIGN1cnJlbnQ6IHtcblxuICAgIC8qKlxuICAgICAqIGV2bS5jdXJyZW50LmNhbGxzdGFja1xuICAgICAqL1xuICAgIGNhbGxzdGFjazogKHN0YXRlKSA9PiBzdGF0ZS5ldm0ucHJvYy5jYWxsc3RhY2ssXG5cbiAgICAvKipcbiAgICAgKiBldm0uY3VycmVudC5jYWxsXG4gICAgICovXG4gICAgY2FsbDogY3JlYXRlTGVhZihcbiAgICAgIFtcIi4vY2FsbHN0YWNrXCJdLFxuXG4gICAgICAoc3RhY2spID0+IHN0YWNrLmxlbmd0aCA/IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdIDoge31cbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogZXZtLmN1cnJlbnQuY29udGV4dFxuICAgICAqL1xuICAgIGNvbnRleHQ6IGNyZWF0ZUxlYWYoXG4gICAgICBbXCIuL2NhbGxcIiwgXCIvaW5mby9pbnN0YW5jZXNcIiwgXCIvaW5mby9iaW5hcmllcy9zZWFyY2hcIiwgXCIvaW5mby9jb250ZXh0c1wiXSxcblxuICAgICAgKHthZGRyZXNzLCBiaW5hcnl9LCBpbnN0YW5jZXMsIHNlYXJjaCwgY29udGV4dHMpID0+IHtcbiAgICAgICAgbGV0IHJlY29yZDtcbiAgICAgICAgaWYgKGFkZHJlc3MpIHtcbiAgICAgICAgICByZWNvcmQgPSBpbnN0YW5jZXNbYWRkcmVzc107XG4gICAgICAgICAgYmluYXJ5ID0gcmVjb3JkLmJpbmFyeVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlY29yZCA9IHNlYXJjaChiaW5hcnkpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGNvbnRleHQgPSBjb250ZXh0c1socmVjb3JkIHx8IHt9KS5jb250ZXh0XTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmNvbnRleHQsXG4gICAgICAgICAgYmluYXJ5XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogZXZtLmN1cnJlbnQuc3RhdGVcbiAgICAgKlxuICAgICAqIGV2bSBzdGF0ZSBpbmZvOiBhcyBvZiBsYXN0IG9wZXJhdGlvbiwgYmVmb3JlIG9wIGRlZmluZWQgaW4gc3RlcFxuICAgICAqL1xuICAgIHN0YXRlOiBPYmplY3QuYXNzaWduKHt9LCAuLi4oXG4gICAgICBbXG4gICAgICAgIFwiZGVwdGhcIixcbiAgICAgICAgXCJlcnJvclwiLFxuICAgICAgICBcImdhc1wiLFxuICAgICAgICBcIm1lbW9yeVwiLFxuICAgICAgICBcInN0YWNrXCIsXG4gICAgICAgIFwic3RvcmFnZVwiXG4gICAgICBdLm1hcCggKHBhcmFtKSA9PiAoe1xuICAgICAgICBbcGFyYW1dOiBjcmVhdGVMZWFmKFt0cmFjZS5zdGVwXSwgKHN0ZXApID0+IHN0ZXBbcGFyYW1dKVxuICAgICAgfSkpXG4gICAgKSksXG5cbiAgICAvKipcbiAgICAgKiBldm0uY3VycmVudC5zdGVwXG4gICAgICovXG4gICAgc3RlcDogY3JlYXRlU3RlcFNlbGVjdG9ycyh0cmFjZS5zdGVwLCBcIi4vc3RhdGVcIilcbiAgfSxcblxuICAvKipcbiAgICogZXZtLm5leHRcbiAgICovXG4gIG5leHQ6IHtcblxuICAgIC8qKlxuICAgICAqIGV2bS5uZXh0LnN0YXRlXG4gICAgICpcbiAgICAgKiBldm0gc3RhdGUgYXMgYSByZXN1bHQgb2YgbmV4dCBzdGVwIG9wZXJhdGlvblxuICAgICAqL1xuICAgIHN0YXRlOiBPYmplY3QuYXNzaWduKHt9LCAuLi4oXG4gICAgICBbXG4gICAgICAgIFwiZGVwdGhcIixcbiAgICAgICAgXCJlcnJvclwiLFxuICAgICAgICBcImdhc1wiLFxuICAgICAgICBcIm1lbW9yeVwiLFxuICAgICAgICBcInN0YWNrXCIsXG4gICAgICAgIFwic3RvcmFnZVwiXG4gICAgICBdLm1hcCggKHBhcmFtKSA9PiAoe1xuICAgICAgICBbcGFyYW1dOiBjcmVhdGVMZWFmKFt0cmFjZS5uZXh0XSwgKHN0ZXApID0+IHN0ZXBbcGFyYW1dKVxuICAgICAgfSkpXG4gICAgKSksXG5cbiAgICBzdGVwOiBjcmVhdGVTdGVwU2VsZWN0b3JzKHRyYWNlLm5leHQsIFwiLi9zdGF0ZVwiKVxuICB9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgZXZtO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9ldm0vc2VsZWN0b3JzL2luZGV4LmpzIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9hc3NpZ25cIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2Fzc2lnblwiXG4vLyBtb2R1bGUgaWQgPSA4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tIFwiZGVidWdcIjtcbmNvbnN0IGRlYnVnID0gZGVidWdNb2R1bGUoXCJkZWJ1Z2dlcjpzb2xpZGl0eTpzZWxlY3RvcnNcIik7XG5cbmltcG9ydCB7IGNyZWF0ZVNlbGVjdG9yVHJlZSwgY3JlYXRlTGVhZiB9IGZyb20gXCJyZXNlbGVjdC10cmVlXCI7XG5pbXBvcnQgU29saWRpdHlVdGlscyBmcm9tIFwidHJ1ZmZsZS1zb2xpZGl0eS11dGlsc1wiO1xuaW1wb3J0IENvZGVVdGlscyBmcm9tIFwidHJ1ZmZsZS1jb2RlLXV0aWxzXCI7XG5cbmltcG9ydCBldm0gZnJvbSBcImxpYi9ldm0vc2VsZWN0b3JzXCI7XG5cbmZ1bmN0aW9uIGdldFNvdXJjZVJhbmdlKGluc3RydWN0aW9uID0ge30pIHtcbiAgcmV0dXJuIHtcbiAgICBzdGFydDogaW5zdHJ1Y3Rpb24uc3RhcnQgfHwgMCxcbiAgICBsZW5ndGg6IGluc3RydWN0aW9uLmxlbmd0aCB8fCAwLFxuICAgIGxpbmVzOiBpbnN0cnVjdGlvbi5yYW5nZSB8fCB7XG4gICAgICBzdGFydDoge1xuICAgICAgICBsaW5lOiAwLCBjb2x1bW46IDBcbiAgICAgIH0sXG4gICAgICBlbmQ6IHtcbiAgICAgICAgbGluZTogMCwgY29sdW1uOiAwXG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuXG5sZXQgc29saWRpdHkgPSBjcmVhdGVTZWxlY3RvclRyZWUoe1xuICAvKipcbiAgICogc29saWRpdHkuc3RhdGVcbiAgICovXG4gIHN0YXRlOiAoc3RhdGUpID0+IHN0YXRlLnNvbGlkaXR5LFxuXG4gIC8qKlxuICAgKiBzb2xpZGl0eS5pbmZvXG4gICAqL1xuICBpbmZvOiB7XG4gICAgLyoqXG4gICAgICogc29saWRpdHkuaW5mby5zb3VyY2VzXG4gICAgICovXG4gICAgc291cmNlczogY3JlYXRlTGVhZihbJy9zdGF0ZSddLCAoc3RhdGUpID0+IHN0YXRlLmluZm8uc291cmNlcy5ieUlkKSxcblxuICAgIC8qKlxuICAgICAqIHNvbGlkaXR5LmluZm8uc291cmNlTWFwc1xuICAgICAqL1xuICAgIHNvdXJjZU1hcHM6IGNyZWF0ZUxlYWYoWycvc3RhdGUnXSwgKHN0YXRlKSA9PiBzdGF0ZS5pbmZvLnNvdXJjZU1hcHMuYnlDb250ZXh0KVxuICB9LFxuXG4gIC8qKlxuICAgKiBzb2xpZGl0eS5jdXJyZW50XG4gICAqL1xuICBjdXJyZW50OiB7XG5cbiAgICAvKipcbiAgICAgKiBzb2xpZGl0eS5jdXJyZW50LnNvdXJjZU1hcFxuICAgICAqL1xuICAgIHNvdXJjZU1hcDogY3JlYXRlTGVhZihcbiAgICAgIFtldm0uY3VycmVudC5jb250ZXh0LCBcIi9pbmZvL3NvdXJjZU1hcHNcIl0sXG5cbiAgICAgICh7Y29udGV4dH0sIHNvdXJjZU1hcHMpID0+IHNvdXJjZU1hcHNbY29udGV4dF0gfHwge31cbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogc29saWRpdHkuY3VycmVudC5mdW5jdGlvbkRlcHRoXG4gICAgICovXG4gICAgZnVuY3Rpb25EZXB0aDogKHN0YXRlKSA9PiBzdGF0ZS5zb2xpZGl0eS5wcm9jLmZ1bmN0aW9uRGVwdGgsXG5cbiAgICAvKipcbiAgICAgKiBzb2xpZGl0eS5jdXJyZW50Lmluc3RydWN0aW9uc1xuICAgICAqL1xuICAgIGluc3RydWN0aW9uczogY3JlYXRlTGVhZihcbiAgICAgIFtcIi9pbmZvL3NvdXJjZXNcIiwgZXZtLmN1cnJlbnQuY29udGV4dCwgXCIuL3NvdXJjZU1hcFwiXSxcblxuICAgICAgKHNvdXJjZXMsIHtiaW5hcnl9LCB7c291cmNlTWFwfSkgPT4ge1xuICAgICAgICBsZXQgaW5zdHJ1Y3Rpb25zID0gQ29kZVV0aWxzLnBhcnNlQ29kZShiaW5hcnkpO1xuXG4gICAgICAgIGlmICghc291cmNlTWFwKSB7XG4gICAgICAgICAgLy8gTGV0J3MgY3JlYXRlIGEgc291cmNlIG1hcCB0byB1c2Ugc2luY2Ugbm9uZSBleGlzdHMuIFRoaXMgc291cmNlIG1hcFxuICAgICAgICAgIC8vIG1hcHMganVzdCBhcyBtYW55IHJhbmdlcyBhcyB0aGVyZSBhcmUgaW5zdHJ1Y3Rpb25zLCBhbmQgZW5zdXJlcyBldmVyeVxuICAgICAgICAgIC8vIGluc3RydWN0aW9uIGlzIG1hcmtlZCBhcyBcImp1bXBpbmcgb3V0XCIuIFRoaXMgd2lsbCBlbnN1cmUgYWxsXG4gICAgICAgICAgLy8gYXZhaWxhYmxlIGRlYnVnZ2VyIGNvbW1hbmRzIHN0ZXAgb25lIGluc3RydWN0aW9uIGF0IGEgdGltZS5cbiAgICAgICAgICAvL1xuICAgICAgICAgIC8vIFRoaXMgaXMga2luZG9mIGEgaGFjazsgcGVyaGFwcyB0aGlzIHNob3VsZCBiZSBicm9rZW4gb3V0IGludG8gc2VwYXJhdGVcbiAgICAgICAgICAvLyBjb250ZXh0IHR5cGVzLiBUT0RPXG4gICAgICAgICAgc291cmNlTWFwID0gXCJcIjtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluc3RydWN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgc291cmNlTWFwICs9IGkgKyBcIjpcIiArIGkgKyBcIjoxOi0xO1wiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBsaW5lQW5kQ29sdW1uTWFwcGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LFxuICAgICAgICAgIC4uLk9iamVjdC5lbnRyaWVzKHNvdXJjZXMpLm1hcChcbiAgICAgICAgICAgIChbaWQsIHtzb3VyY2V9XSkgPT4gKHtcbiAgICAgICAgICAgICAgW2lkXTogU29saWRpdHlVdGlscy5nZXRDaGFyYWN0ZXJPZmZzZXRUb0xpbmVBbmRDb2x1bW5NYXBwaW5nKHNvdXJjZSB8fCBcIlwiKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICAgIHZhciBodW1hblJlYWRhYmxlU291cmNlTWFwID0gU29saWRpdHlVdGlscy5nZXRIdW1hblJlYWRhYmxlU291cmNlTWFwKHNvdXJjZU1hcCk7XG5cbiAgICAgICAgbGV0IHByaW1hcnlGaWxlID0gaHVtYW5SZWFkYWJsZVNvdXJjZU1hcFswXS5maWxlO1xuICAgICAgICBkZWJ1ZyhcInByaW1hcnlGaWxlICVvXCIsIHByaW1hcnlGaWxlKTtcblxuICAgICAgICByZXR1cm4gaW5zdHJ1Y3Rpb25zXG4gICAgICAgICAgLm1hcCggKGluc3RydWN0aW9uLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgLy8gbG9va3VwIHNvdXJjZSBtYXAgYnkgaW5kZXggYW5kIGFkZCBgaW5kZXhgIHByb3BlcnR5IHRvXG4gICAgICAgICAgICAvLyBpbnN0cnVjdGlvblxuICAgICAgICAgICAgLy9cblxuICAgICAgICAgICAgY29uc3Qgc291cmNlTWFwID0gaHVtYW5SZWFkYWJsZVNvdXJjZU1hcFtpbmRleF0gfHwge307XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIGluc3RydWN0aW9uOiB7IC4uLmluc3RydWN0aW9uLCBpbmRleCB9LFxuICAgICAgICAgICAgICBzb3VyY2VNYXAsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLm1hcCggKHsgaW5zdHJ1Y3Rpb24sIHNvdXJjZU1hcH0pID0+IHtcbiAgICAgICAgICAgIC8vIGFkZCBzb3VyY2UgbWFwIGluZm9ybWF0aW9uIHRvIGluc3RydWN0aW9uLCBvciBkZWZhdWx0c1xuICAgICAgICAgICAgLy9cblxuICAgICAgICAgICAgY29uc3QgeyBqdW1wLCBzdGFydCA9IDAsIGxlbmd0aCA9IDAsIGZpbGUgPSBwcmltYXJ5RmlsZSB9ID0gc291cmNlTWFwO1xuICAgICAgICAgICAgY29uc3QgbGluZUFuZENvbHVtbk1hcHBpbmcgPSBsaW5lQW5kQ29sdW1uTWFwcGluZ3NbZmlsZV0gfHwge307XG4gICAgICAgICAgICBjb25zdCByYW5nZSA9IHtcbiAgICAgICAgICAgICAgc3RhcnQ6IGxpbmVBbmRDb2x1bW5NYXBwaW5nW3N0YXJ0XSB8fFxuICAgICAgICAgICAgICAgIHsgbGluZTogbnVsbCwgY29sdW1uOiBudWxsIH0sXG4gICAgICAgICAgICAgIGVuZDogbGluZUFuZENvbHVtbk1hcHBpbmdbc3RhcnQgKyBsZW5ndGhdIHx8XG4gICAgICAgICAgICAgICAgeyBsaW5lOiBudWxsLCBjb2x1bW46IG51bGwgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHJhbmdlLnN0YXJ0LmxpbmUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgZGVidWcoXCJzb3VyY2VNYXAgJW9cIiwgc291cmNlTWFwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgLi4uaW5zdHJ1Y3Rpb24sXG5cbiAgICAgICAgICAgICAganVtcCxcbiAgICAgICAgICAgICAgc3RhcnQsXG4gICAgICAgICAgICAgIGxlbmd0aCxcbiAgICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgICAgcmFuZ2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogc29saWRpdHkuY3VycmVudC5pbnN0cnVjdGlvbkF0UHJvZ3JhbUNvdW50ZXJcbiAgICAgKi9cbiAgICBpbnN0cnVjdGlvbkF0UHJvZ3JhbUNvdW50ZXI6IGNyZWF0ZUxlYWYoXG4gICAgICBbXCIuL2luc3RydWN0aW9uc1wiXSxcblxuICAgICAgKGluc3RydWN0aW9ucykgPT4ge1xuICAgICAgICBsZXQgbWFwID0gW107XG4gICAgICAgIGluc3RydWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGluc3RydWN0aW9uKSB7XG4gICAgICAgICAgbWFwW2luc3RydWN0aW9uLnBjXSA9IGluc3RydWN0aW9uO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBmaWxsIGluIGdhcHMgaW4gbWFwIGJ5IGRlZmF1bHRpbmcgdG8gdGhlIGxhc3Qga25vd24gaW5zdHJ1Y3Rpb25cbiAgICAgICAgbGV0IGxhc3RTZWVuID0gbnVsbDtcbiAgICAgICAgZm9yIChsZXQgW3BjLCBpbnN0cnVjdGlvbl0gb2YgbWFwLmVudHJpZXMoKSkge1xuICAgICAgICAgIGlmIChpbnN0cnVjdGlvbikge1xuICAgICAgICAgICAgbGFzdFNlZW4gPSBpbnN0cnVjdGlvbjtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWFwW3BjXSA9IGxhc3RTZWVuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWFwO1xuICAgICAgfVxuICAgICksXG5cbiAgICAvKipcbiAgICAgKiBzb2xpZGl0eS5jdXJyZW50Lmluc3RydWN0aW9uXG4gICAgICovXG4gICAgaW5zdHJ1Y3Rpb246IGNyZWF0ZUxlYWYoXG4gICAgICBbXCIuL2luc3RydWN0aW9uQXRQcm9ncmFtQ291bnRlclwiLCBldm0uY3VycmVudC5zdGVwLnByb2dyYW1Db3VudGVyXSxcblxuICAgICAgKG1hcCwgcGMpID0+IG1hcFtwY10gfHwge31cbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogc29saWRpdHkuY3VycmVudC5zb3VyY2VcbiAgICAgKi9cbiAgICBzb3VyY2U6IGNyZWF0ZUxlYWYoXG4gICAgICBbXCIvaW5mby9zb3VyY2VzXCIsIFwiLi9pbnN0cnVjdGlvblwiXSxcblxuICAgICAgKHNvdXJjZXMsIHtmaWxlOiBpZH0pID0+IHNvdXJjZXNbaWRdIHx8IHt9XG4gICAgKSxcblxuICAgIC8qKlxuICAgICAqIHNvbGlkaXR5LmN1cnJlbnQuc291cmNlUmFuZ2VcbiAgICAgKi9cbiAgICBzb3VyY2VSYW5nZTogY3JlYXRlTGVhZihbXCIuL2luc3RydWN0aW9uXCJdLCBnZXRTb3VyY2VSYW5nZSksXG5cbiAgICAvKipcbiAgICAgKiBzb2xpZGl0eS5jdXJyZW50LmlzU291cmNlUmFuZ2VGaW5hbFxuICAgICAqL1xuICAgIGlzU291cmNlUmFuZ2VGaW5hbDogY3JlYXRlTGVhZihcbiAgICAgIFtcbiAgICAgICAgXCIuL2luc3RydWN0aW9uQXRQcm9ncmFtQ291bnRlclwiLFxuICAgICAgICBldm0uY3VycmVudC5zdGVwLnByb2dyYW1Db3VudGVyLFxuICAgICAgICBldm0ubmV4dC5zdGVwLnByb2dyYW1Db3VudGVyXG4gICAgICBdLFxuXG4gICAgICAobWFwLCBjdXJyZW50LCBuZXh0KSA9PiB7XG4gICAgICAgIGlmICghbWFwW25leHRdKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBjdXJyZW50ID0gbWFwW2N1cnJlbnRdO1xuICAgICAgICBuZXh0ID0gbWFwW25leHRdO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgY3VycmVudC5zdGFydCAhPSBuZXh0LnN0YXJ0IHx8XG4gICAgICAgICAgY3VycmVudC5sZW5ndGggIT0gbmV4dC5sZW5ndGggfHxcbiAgICAgICAgICBjdXJyZW50LmZpbGUgIT0gbmV4dC5maWxlXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgKSxcblxuICAgIC8qKlxuICAgICAqIHNvbGlkaXR5LmN1cnJlbnQuaXNNdWx0aWxpbmVcbiAgICAgKi9cbiAgICBpc011bHRpbGluZTogY3JlYXRlTGVhZihcbiAgICAgIFtcIi4vc291cmNlUmFuZ2VcIl0sXG5cbiAgICAgICgge2xpbmVzfSApID0+IGxpbmVzLnN0YXJ0LmxpbmUgIT0gbGluZXMuZW5kLmxpbmVcbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogc29saWRpdHkuY3VycmVudC53aWxsSnVtcFxuICAgICAqL1xuICAgIHdpbGxKdW1wOiBjcmVhdGVMZWFmKFtldm0uY3VycmVudC5zdGVwLmlzSnVtcF0sIChpc0p1bXApID0+IGlzSnVtcCksXG5cbiAgICAvKipcbiAgICAgKiBzb2xpZGl0eS5jdXJyZW50Lmp1bXBEaXJlY3Rpb25cbiAgICAgKi9cbiAgICBqdW1wRGlyZWN0aW9uOiBjcmVhdGVMZWFmKFxuICAgICAgW1wiLi9pbnN0cnVjdGlvblwiXSwgKGkgPSB7fSkgPT4gKGkuanVtcCB8fCBcIi1cIilcbiAgICApXG4gIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBzb2xpZGl0eTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvc29saWRpdHkvc2VsZWN0b3JzL2luZGV4LmpzIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiXG4vLyBtb2R1bGUgaWQgPSAxMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJ3ZWIzXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwid2ViM1wiXG4vLyBtb2R1bGUgaWQgPSAxMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZXNlbGVjdC10cmVlXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwicmVzZWxlY3QtdHJlZVwiXG4vLyBtb2R1bGUgaWQgPSAxMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvZXh0ZW5kc1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImJhYmVsLXJ1bnRpbWUvaGVscGVycy9leHRlbmRzXCJcbi8vIG1vZHVsZSBpZCA9IDEzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInJlZHV4LXNhZ2EvZWZmZWN0c1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInJlZHV4LXNhZ2EvZWZmZWN0c1wiXG4vLyBtb2R1bGUgaWQgPSAxNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6ZGF0YTpkZWNvZGU6dXRpbHNcIik7XG5cbmltcG9ydCB7IEJpZ051bWJlciB9IGZyb20gXCJiaWdudW1iZXIuanNcIjtcbmltcG9ydCBXZWIzIGZyb20gXCJ3ZWIzXCI7XG5cbmV4cG9ydCBjb25zdCBXT1JEX1NJWkUgPSAweDIwO1xuZXhwb3J0IGNvbnN0IE1BWF9XT1JEID0gbmV3IEJpZ051bWJlcigyKS5wb3coMjU2KS5taW51cygxKTtcblxuLyoqXG4gKiByZWN1cnNpdmVseSBjb252ZXJ0cyBiaWcgbnVtYmVycyBpbnRvIHNvbWV0aGluZyBuaWNlciB0byBsb29rIGF0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbGVhbkJpZ051bWJlcnModmFsdWUpIHtcbiAgaWYgKEJpZ051bWJlci5pc0JpZ051bWJlcih2YWx1ZSkpIHtcbiAgICByZXR1cm4gdmFsdWUudG9OdW1iZXIoKTtcblxuICB9IGVsc2UgaWYgKHZhbHVlICYmIHZhbHVlLm1hcCAhPSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gdmFsdWUubWFwKCAoaW5uZXIpID0+IGNsZWFuQmlnTnVtYmVycyhpbm5lcikgKTtcblxuICB9IGVsc2UgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSBcIm9iamVjdFwiKSB7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oXG4gICAgICB7fSwgLi4uT2JqZWN0LmVudHJpZXModmFsdWUpXG4gICAgICAgIC5tYXAoIChba2V5LCBpbm5lcl0pID0+ICh7IFtrZXldOiBjbGVhbkJpZ051bWJlcnMoaW5uZXIpIH0pIClcbiAgICApO1xuXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0eXBlSWRlbnRpZmllcihkZWZpbml0aW9uKSB7XG4gIHJldHVybiBkZWZpbml0aW9uLnR5cGVEZXNjcmlwdGlvbnMudHlwZUlkZW50aWZpZXI7XG59XG5cbi8qKlxuICogcmV0dXJucyBiYXNpYyB0eXBlIGNsYXNzIGZvciBhIHZhcmlhYmxlIGRlZmluaXRpb24gbm9kZVxuICogZS5nLjpcbiAqICBgdF91aW50MjU2YCBiZWNvbWVzIGB1aW50YFxuICogIGB0X3N0cnVjdCRfVGhpbmdfJDIwX21lbW9yeV9wdHJgIGJlY29tZXMgYHN0cnVjdGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHR5cGVDbGFzcyhkZWZpbml0aW9uKSB7XG4gIHJldHVybiB0eXBlSWRlbnRpZmllcihkZWZpbml0aW9uKS5tYXRjaCgvdF8oW14kXzAtOV0rKS8pWzFdO1xufVxuXG4vKipcbiAqIEFsbG9jYXRlIHN0b3JhZ2UgZm9yIGdpdmVuIHZhcmlhYmxlIGRlY2xhcmF0aW9uc1xuICpcbiAqIFBvc3Rjb25kaXRpb246IHN0YXJ0cyBhIG5ldyBzbG90IGFuZCBvY2N1cGllcyB3aG9sZSBzbG90c1xuICovXG5leHBvcnQgZnVuY3Rpb24gYWxsb2NhdGVEZWNsYXJhdGlvbnMoXG4gIGRlY2xhcmF0aW9ucyxcbiAgcmVmcyxcbiAgc2xvdCA9IDAsXG4gIGluZGV4ID0gV09SRF9TSVpFIC0gMSxcbiAgcGF0aCA9IFtdXG4pIHtcbiAgaWYgKGluZGV4IDwgV09SRF9TSVpFIC0gMSkgeyAgLy8gc3RhcnRzIGEgbmV3IHNsb3RcbiAgICBzbG90Kys7XG4gICAgaW5kZXggPSBXT1JEX1NJWkUgLSAxO1xuICB9XG5cbiAgbGV0IHBhcmVudEZyb20gPSB7IHNsb3QsIGluZGV4OiAwIH07XG4gIHZhciBwYXJlbnRUbyA9IHsgc2xvdCwgaW5kZXg6IFdPUkRfU0laRSAtIDEgfTtcbiAgbGV0IG1hcHBpbmcgPSB7fTtcblxuICBmb3IgKGxldCBkZWNsYXJhdGlvbiBvZiBkZWNsYXJhdGlvbnMpIHtcbiAgICBsZXQgeyBmcm9tLCB0bywgbmV4dCwgY2hpbGRyZW4gfSA9XG4gICAgICBhbGxvY2F0ZURlY2xhcmF0aW9uKGRlY2xhcmF0aW9uLCByZWZzLCBzbG90LCBpbmRleCk7XG5cbiAgICBtYXBwaW5nW2RlY2xhcmF0aW9uLmlkXSA9IHsgZnJvbSwgdG8sIG5hbWU6IGRlY2xhcmF0aW9uLm5hbWUgfTtcbiAgICBpZiAoY2hpbGRyZW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgbWFwcGluZ1tkZWNsYXJhdGlvbi5pZF0uY2hpbGRyZW4gPSBjaGlsZHJlbjtcbiAgICB9XG5cbiAgICBzbG90ID0gbmV4dC5zbG90O1xuICAgIGluZGV4ID0gbmV4dC5pbmRleDtcblxuICAgIHBhcmVudFRvID0geyBzbG90OiB0by5zbG90LCBpbmRleDogV09SRF9TSVpFIC0gMSB9O1xuICB9XG5cbiAgaWYgKGluZGV4IDwgV09SRF9TSVpFIC0gMSkge1xuICAgIHNsb3QrKztcbiAgICBpbmRleCA9IFdPUkRfU0laRSAtIDE7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGZyb206IHBhcmVudEZyb20sXG4gICAgdG86IHBhcmVudFRvLFxuICAgIG5leHQ6IHsgc2xvdCwgaW5kZXggfSxcbiAgICBjaGlsZHJlbjogbWFwcGluZ1xuICB9O1xufVxuXG5mdW5jdGlvbiBhbGxvY2F0ZVZhbHVlKHNsb3QsIGluZGV4LCBieXRlcykge1xuICBsZXQgZnJvbSA9IGluZGV4IC0gYnl0ZXMgKyAxID49IDAgP1xuICAgIHsgc2xvdCwgaW5kZXg6IGluZGV4IC0gYnl0ZXMgKyAxIH0gOlxuICAgIHsgc2xvdDogc2xvdCArIDEsIGluZGV4OiBXT1JEX1NJWkUgLSBieXRlcyB9O1xuXG4gIGxldCB0byA9IHsgc2xvdDogZnJvbS5zbG90LCBpbmRleDogZnJvbS5pbmRleCArIGJ5dGVzIC0gMSB9O1xuXG4gIGxldCBuZXh0ID0gZnJvbS5pbmRleCA9PSAwID9cbiAgICB7IHNsb3Q6IGZyb20uc2xvdCArIDEsIGluZGV4OiBXT1JEX1NJWkUgLSAxIH0gOlxuICAgIHsgc2xvdDogZnJvbS5zbG90LCBpbmRleDogZnJvbS5pbmRleCAtIDEgfTtcblxuICByZXR1cm4geyBmcm9tLCB0bywgbmV4dCB9O1xufVxuXG5mdW5jdGlvbiBhbGxvY2F0ZURlY2xhcmF0aW9uKGRlY2xhcmF0aW9uLCByZWZzLCBzbG90LCBpbmRleCkge1xuICBsZXQgZGVmaW5pdGlvbiA9IHJlZnNbZGVjbGFyYXRpb24uaWRdLmRlZmluaXRpb247XG4gIHZhciBieXRlU2l6ZSA9IHN0b3JhZ2VTaXplKGRlZmluaXRpb24pOyAgLy8geXVtXG5cbiAgaWYgKHR5cGVDbGFzcyhkZWZpbml0aW9uKSAhPSBcInN0cnVjdFwiKSB7XG4gICAgcmV0dXJuIGFsbG9jYXRlVmFsdWUoc2xvdCwgaW5kZXgsIGJ5dGVTaXplKTtcbiAgfVxuXG4gIGxldCBzdHJ1Y3QgPSByZWZzW2RlZmluaXRpb24udHlwZU5hbWUucmVmZXJlbmNlZERlY2xhcmF0aW9uXTtcbiAgZGVidWcoXCJzdHJ1Y3Q6ICVPXCIsIHN0cnVjdCk7XG5cbiAgbGV0IHJlc3VsdCA9ICBhbGxvY2F0ZURlY2xhcmF0aW9ucyhzdHJ1Y3QudmFyaWFibGVzIHx8IFtdLCByZWZzLCBzbG90LCBpbmRleCk7XG4gIGRlYnVnKFwic3RydWN0IHJlc3VsdCAlb1wiLCByZXN1bHQpO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIGUuZy4gdWludDQ4IC0+IDZcbiAqIEByZXR1cm4gc2l6ZSBpbiBieXRlcyBmb3IgZXhwbGljaXQgdHlwZSBzaXplLCBvciBgbnVsbGAgaWYgbm90IHN0YXRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gc3BlY2lmaWVkU2l6ZShkZWZpbml0aW9uKSB7XG4gIGxldCBzcGVjaWZpZWQgPSB0eXBlSWRlbnRpZmllcihkZWZpbml0aW9uKS5tYXRjaCgvdF9bYS16XSsoWzAtOV0rKS8pO1xuXG4gIGlmICghc3BlY2lmaWVkKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBsZXQgbnVtID0gc3BlY2lmaWVkWzFdO1xuXG4gIHN3aXRjaCAodHlwZUNsYXNzKGRlZmluaXRpb24pKSB7XG4gICAgY2FzZSBcImludFwiOlxuICAgIGNhc2UgXCJ1aW50XCI6XG4gICAgICByZXR1cm4gbnVtIC8gODtcblxuICAgIGNhc2UgXCJieXRlc1wiOlxuICAgICAgcmV0dXJuIG51bTtcblxuICAgIGRlZmF1bHQ6XG4gICAgICBkZWJ1ZyhcIlVua25vd24gdHlwZSBmb3Igc2l6ZSBzcGVjaWZpY2F0aW9uOiAlc1wiLCB0eXBlSWRlbnRpZmllcihkZWZpbml0aW9uKSk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0b3JhZ2VTaXplKGRlZmluaXRpb24pIHtcbiAgc3dpdGNoICh0eXBlQ2xhc3MoZGVmaW5pdGlvbikpIHtcbiAgICBjYXNlIFwiYm9vbFwiOlxuICAgICAgcmV0dXJuIDE7XG5cbiAgICBjYXNlIFwiYWRkcmVzc1wiOlxuICAgICAgcmV0dXJuIDIwO1xuXG4gICAgY2FzZSBcImludFwiOlxuICAgIGNhc2UgXCJ1aW50XCI6XG4gICAgICAvLyBpcyB0aGlzIGEgSEFDSz8gKFwiMjU2XCIgLyA4KVxuICAgICAgcmV0dXJuIHR5cGVJZGVudGlmaWVyKGRlZmluaXRpb24pLm1hdGNoKC90X1thLXpdKyhbMC05XSspLylbMV0gLyA4O1xuXG4gICAgY2FzZSBcInN0cmluZ1wiOlxuICAgIGNhc2UgXCJieXRlc1wiOlxuICAgIGNhc2UgXCJhcnJheVwiOlxuICAgICAgcmV0dXJuIFdPUkRfU0laRTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNSZWZlcmVuY2UoZGVmaW5pdGlvbikge1xuICByZXR1cm4gdHlwZUlkZW50aWZpZXIoZGVmaW5pdGlvbikubWF0Y2goL18obWVtb3J5fHN0b3JhZ2UpKF9wdHIpPyQvKSAhPSBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVmZXJlbmNlVHlwZShkZWZpbml0aW9uKSB7XG4gIHJldHVybiB0eXBlSWRlbnRpZmllcihkZWZpbml0aW9uKS5tYXRjaCgvXyhbXl9dKykoX3B0cik/JC8pWzFdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYmFzZURlZmluaXRpb24oZGVmaW5pdGlvbikge1xuICBsZXQgYmFzZUlkZW50aWZpZXIgPSB0eXBlSWRlbnRpZmllcihkZWZpbml0aW9uKVxuICAgIC8vIGZpcnN0IGRvbGxhciBzaWduICAgICBsYXN0IGRvbGxhciBzaWduXG4gICAgLy8gICBgLS0tLS0tLS0tLiAgICAgICAsLS0tJ1xuICAgIC5tYXRjaCgvXlteJF0rXFwkXyguKylfXFwkW14kXSskLylbMV1cbiAgICAvLyAgICAgICAgICAgICAgYC0tLS0nIGdyZWVkeSBtYXRjaFxuXG4gIC8vIEhBQ0sgLSBpbnRlcm5hbCB0eXBlcyBmb3IgbWVtb3J5IG9yIHN0b3JhZ2UgYWxzbyBzZWVtIHRvIGJlIHBvaW50ZXJzXG4gIGlmIChiYXNlSWRlbnRpZmllci5tYXRjaCgvXyhtZW1vcnl8c3RvcmFnZSkkLykgIT0gbnVsbCkge1xuICAgIGJhc2VJZGVudGlmaWVyID0gYCR7YmFzZUlkZW50aWZpZXJ9X3B0cmA7XG4gIH1cblxuICAvLyBhbm90aGVyIEhBQ0sgLSB3ZSBnZXQgYXdheSB3aXRoIGl0IGJlY2F1c2V3ZSdyZSBvbmx5IHVzaW5nIHRoYXQgb25lIHByb3BlcnR5XG4gIHJldHVybiB7XG4gICAgdHlwZURlc2NyaXB0aW9uczoge1xuICAgICAgdHlwZUlkZW50aWZpZXI6IGJhc2VJZGVudGlmaWVyXG4gICAgfVxuICB9O1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiB0b0JpZ051bWJlcihieXRlcykge1xuICBpZiAoYnl0ZXMgPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfSBlbHNlIGlmICh0eXBlb2YgYnl0ZXMgPT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiBuZXcgQmlnTnVtYmVyKGJ5dGVzLCAxNik7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGJ5dGVzID09IFwibnVtYmVyXCIgfHwgQmlnTnVtYmVyLmlzQmlnTnVtYmVyKGJ5dGVzKSkge1xuICAgIHJldHVybiBuZXcgQmlnTnVtYmVyKGJ5dGVzKTtcbiAgfSBlbHNlIGlmIChieXRlcy5yZWR1Y2UpIHtcbiAgICByZXR1cm4gYnl0ZXMucmVkdWNlKFxuICAgICAgKG51bSwgYnl0ZSkgPT4gbnVtLnRpbWVzKDB4MTAwKS5wbHVzKGJ5dGUpLFxuICAgICAgbmV3IEJpZ051bWJlcigwKVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvU2lnbmVkQmlnTnVtYmVyKGJ5dGVzKSB7XG4gIGlmIChieXRlc1swXSA8IDBiMTAwMDAwMDApIHsgIC8vIGZpcnN0IGJpdCBpcyAwXG4gICAgcmV0dXJuIHRvQmlnTnVtYmVyKGJ5dGVzKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdG9CaWdOdW1iZXIoYnl0ZXMubWFwKCAoYikgPT4gMHhmZiAtIGIgKSkucGx1cygxKS5uZWdhdGVkKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0gYnl0ZXMgLSBVaW50OEFycmF5XG4gKiBAcGFyYW0gbGVuZ3RoIC0gZGVzaXJlZCBieXRlIGxlbmd0aCAocGFkIHdpdGggemVyb2VzKVxuICogQHBhcmFtIHRyaW0gLSBvbWl0IGxlYWRpbmcgemVyb2VzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b0hleFN0cmluZyhieXRlcywgbGVuZ3RoID0gMCwgdHJpbSA9IGZhbHNlKSB7XG4gIGlmICh0eXBlb2YgbGVuZ3RoID09IFwiYm9vbGVhblwiKSB7XG4gICAgdHJpbSA9IGxlbmd0aDtcbiAgICBsZW5ndGggPSAwO1xuICB9XG5cbiAgaWYgKEJpZ051bWJlci5pc0JpZ051bWJlcihieXRlcykpIHtcbiAgICBieXRlcyA9IHRvQnl0ZXMoYnl0ZXMpO1xuICB9XG5cbiAgY29uc3QgcGFkID0gKHMpID0+IGAke1wiMDBcIi5zbGljZSgwLCAyIC0gcy5sZW5ndGgpfSR7c31gXG5cbiAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwICAxICAyICAzICA0XG4gIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCAgMSAgMiAgMyAgNCAgNSAgNiAgN1xuICAvLyBieXRlcy5sZW5ndGg6ICAgICAgICA1ICAtICAweCggICAgICAgICAgZTUgYzIgYWEgMDkgMTEgKVxuICAvLyBsZW5ndGggKHByZWZlcnJlZCk6ICA4ICAtICAweCggMDAgMDAgMDAgZTUgYzIgYWEgMDkgMTEgKVxuICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYC0tLi0tLSdcbiAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0IDNcbiAgaWYgKGJ5dGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIGxldCBwcmlvciA9IGJ5dGVzO1xuICAgIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTtcblxuICAgIGJ5dGVzLnNldChwcmlvciwgbGVuZ3RoIC0gcHJpb3IubGVuZ3RoKTtcbiAgfVxuXG4gIGRlYnVnKFwiYnl0ZXM6ICVvXCIsIGJ5dGVzKTtcblxuICBsZXQgc3RyaW5nID0gYnl0ZXMucmVkdWNlKFxuICAgIChzdHIsIGJ5dGUpID0+IGAke3N0cn0ke3BhZChieXRlLnRvU3RyaW5nKDE2KSl9YCwgXCJcIlxuICApO1xuXG4gIGlmICh0cmltKSB7XG4gICAgc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoL14oMDApKy8sIFwiXCIpO1xuICB9XG5cbiAgaWYgKHN0cmluZy5sZW5ndGggPT0gMCkge1xuICAgIHN0cmluZyA9IFwiMDBcIjtcbiAgfVxuXG4gIHJldHVybiBgMHgke3N0cmluZ31gO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9CeXRlcyhudW1iZXIsIGxlbmd0aCA9IDApIHtcbiAgaWYgKG51bWJlciA8IDApIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBsZXQgaGV4ID0gbnVtYmVyLnRvU3RyaW5nKDE2KTtcbiAgaWYgKGhleC5sZW5ndGggJSAyID09IDEpIHtcbiAgICBoZXggPSBgMCR7aGV4fWA7XG4gIH1cblxuICBsZXQgYnl0ZXMgPSBuZXcgVWludDhBcnJheShcbiAgICBoZXgubWF0Y2goLy57Mn0vZylcbiAgICAgIC5tYXAoIChieXRlKSA9PiBwYXJzZUludChieXRlLCAxNikgKVxuICApO1xuXG4gIGlmIChieXRlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICBsZXQgcHJpb3IgPSBieXRlcztcbiAgICBieXRlcyA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XG4gICAgYnl0ZXMuc2V0KHByaW9yLCBsZW5ndGggLSBwcmlvci5sZW5ndGgpO1xuICB9XG5cbiAgcmV0dXJuIGJ5dGVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24ga2VjY2FrMjU2KC4uLmFyZ3MpIHtcbiAgbGV0IHdlYjMgPSBuZXcgV2ViMygpO1xuXG4gIGRlYnVnKFwiYXJncyAlb1wiLCBhcmdzKTtcblxuICBhcmdzID0gYXJncy5tYXAoIChhcmcpID0+IHtcbiAgICBpZiAodHlwZW9mIGFyZyA9PSBcIm51bWJlclwiIHx8IEJpZ051bWJlci5pc0JpZ051bWJlcihhcmcpKSB7XG4gICAgICByZXR1cm4gdG9IZXhTdHJpbmcodG9CeXRlcyhhcmcsIFdPUkRfU0laRSkpLnNsaWNlKDIpXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYXJnID09IFwic3RyaW5nXCIpIHtcbiAgICAgIHJldHVybiB3ZWIzLnV0aWxzLnRvSGV4KGFyZykuc2xpY2UoMik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cbiAgfSk7XG5cbiAgZGVidWcoXCJwcm9jZXNzZWQgYXJncyAlb1wiLCBhcmdzKTtcblxuICBsZXQgc2hhID0gd2ViMy51dGlscy5zb2xpZGl0eVNoYTMoLi4uYXJncyk7XG4gIGRlYnVnKFwic2hhICVvXCIsIHNoYSk7XG4gIHJldHVybiB0b0JpZ051bWJlcihzaGEpO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9kYXRhL2RlY29kZS91dGlscy5qcyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9nZXQtaXRlcmF0b3JcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2NvcmUtanMvZ2V0LWl0ZXJhdG9yXCJcbi8vIG1vZHVsZSBpZCA9IDE2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNoYWlcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJjaGFpXCJcbi8vIG1vZHVsZSBpZCA9IDE3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tIFwiZGVidWdcIjtcbmNvbnN0IGRlYnVnID0gZGVidWdNb2R1bGUoXCJ0ZXN0OmhlbHBlcnNcIik7XG5cbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgYXN5bmMgZnJvbSBcImFzeW5jXCI7XG5pbXBvcnQgQ29udHJhY3RzIGZyb20gXCJ0cnVmZmxlLXdvcmtmbG93LWNvbXBpbGVcIjtcbmltcG9ydCBEZWJ1ZyBmcm9tIFwidHJ1ZmZsZS1kZWJ1Zy11dGlsc1wiO1xuaW1wb3J0IEFydGlmYWN0b3IgZnJvbSBcInRydWZmbGUtYXJ0aWZhY3RvclwiO1xuaW1wb3J0IFdlYjMgZnJvbSBcIndlYjNcIjtcbmltcG9ydCBNaWdyYXRlIGZyb20gXCJ0cnVmZmxlLW1pZ3JhdGVcIjtcbmltcG9ydCBCb3ggZnJvbSBcInRydWZmbGUtYm94XCI7XG5pbXBvcnQgUmVzb2x2ZXIgZnJvbSBcInRydWZmbGUtcmVzb2x2ZXJcIjtcbmltcG9ydCBleHBlY3QgZnJvbSBcInRydWZmbGUtZXhwZWN0XCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcmVwYXJlQ29udHJhY3RzKHByb3ZpZGVyLCBzb3VyY2VzID0ge30sIG1pZ3JhdGlvbnMpIHtcbiAgbGV0IGNvbmZpZyA9IGF3YWl0IGNyZWF0ZVNhbmRib3goKTtcblxuICBsZXQgYWNjb3VudHMgPSBhd2FpdCBnZXRBY2NvdW50cyhwcm92aWRlcik7XG5cbiAgY29uZmlnLm5ldHdvcmtzW1wiZGVidWdnZXJcIl0gPSB7XG4gICAgcHJvdmlkZXI6IHByb3ZpZGVyLFxuICAgIG5ldHdvcmtfaWQ6IFwiKlwiLFxuICAgIGZyb206IGFjY291bnRzWzBdXG4gIH1cbiAgY29uZmlnLm5ldHdvcmsgPSBcImRlYnVnZ2VyXCI7XG5cbiAgYXdhaXQgYWRkQ29udHJhY3RzKGNvbmZpZywgc291cmNlcyk7XG4gIGxldCB7IGNvbnRyYWN0cywgZmlsZXMgfSA9IGF3YWl0IGNvbXBpbGUoY29uZmlnKTtcbiAgbGV0IGNvbnRyYWN0TmFtZXMgPSBPYmplY3Qua2V5cyhjb250cmFjdHMpO1xuXG4gIGlmICghbWlncmF0aW9ucykge1xuICAgIG1pZ3JhdGlvbnMgPSBhd2FpdCBkZWZhdWx0TWlncmF0aW9ucyhjb250cmFjdE5hbWVzKTtcbiAgfVxuXG4gIGF3YWl0IGFkZE1pZ3JhdGlvbnMoY29uZmlnLCBtaWdyYXRpb25zKTtcbiAgYXdhaXQgbWlncmF0ZShjb25maWcpO1xuXG4gIGxldCBhcnRpZmFjdHMgPSBhd2FpdCBnYXRoZXJBcnRpZmFjdHMoY29uZmlnKTtcbiAgZGVidWcoXCJhcnRpZmFjdHM6ICVvXCIsIGFydGlmYWN0cy5tYXAoKGEpID0+IGEuY29udHJhY3ROYW1lKSk7XG5cbiAgbGV0IGFic3RyYWN0aW9ucyA9IHt9O1xuICBjb250cmFjdE5hbWVzLmZvckVhY2goIChuYW1lKSA9PiB7XG4gICAgYWJzdHJhY3Rpb25zW25hbWVdID0gY29uZmlnLnJlc29sdmVyLnJlcXVpcmUobmFtZSk7XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgZmlsZXMsXG4gICAgYWJzdHJhY3Rpb25zLFxuICAgIGFydGlmYWN0cyxcbiAgICBjb25maWdcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFjY291bnRzKHByb3ZpZGVyKSB7XG4gIGxldCB3ZWIzID0gbmV3IFdlYjMocHJvdmlkZXIpO1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3QpIHtcbiAgICB3ZWIzLmV0aC5nZXRBY2NvdW50cyhmdW5jdGlvbihlcnIsIGFjY291bnRzKSB7XG4gICAgICBpZiAoZXJyKSByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICBhY2NlcHQoYWNjb3VudHMpO1xuICAgIH0pO1xuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVNhbmRib3goKSB7XG4gIGxldCBjb25maWcgPSBhd2FpdCBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCkge1xuICAgIEJveC5zYW5kYm94KGZ1bmN0aW9uKGVyciwgcmVzdWx0KSB7XG4gICAgICBpZiAoZXJyKSByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICByZXN1bHQucmVzb2x2ZXIgPSBuZXcgUmVzb2x2ZXIocmVzdWx0KTtcbiAgICAgIHJlc3VsdC5hcnRpZmFjdG9yID0gbmV3IEFydGlmYWN0b3IocmVzdWx0LmNvbnRyYWN0c19idWlsZF9kaXJlY3RvcnkpO1xuICAgICAgcmVzdWx0Lm5ldHdvcmtzID0ge307XG5cbiAgICAgIGFjY2VwdChyZXN1bHQpO1xuICAgIH0pO1xuICB9KTtcblxuICBhd2FpdCBmcy5yZW1vdmUocGF0aC5qb2luKGNvbmZpZy5jb250cmFjdHNfZGlyZWN0b3J5LCBcIk1ldGFDb2luLnNvbFwiKSk7XG4gIGF3YWl0IGZzLnJlbW92ZShwYXRoLmpvaW4oY29uZmlnLmNvbnRyYWN0c19kaXJlY3RvcnksIFwiQ29udmVydExpYi5zb2xcIikpO1xuICBhd2FpdCBmcy5yZW1vdmUocGF0aC5qb2luKGNvbmZpZy5taWdyYXRpb25zX2RpcmVjdG9yeSwgXCIyX2RlcGxveV9jb250cmFjdHMuanNcIikpO1xuXG4gIHJldHVybiBjb25maWc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRDb250cmFjdHMoY29uZmlnLCBzb3VyY2VzID0ge30pIHtcbiAgbGV0IHByb21pc2VzID0gW107XG4gIGZvciAobGV0IGZpbGVuYW1lIG9mIE9iamVjdC5rZXlzKHNvdXJjZXMpKSB7XG4gICAgbGV0IHNvdXJjZSA9IHNvdXJjZXNbZmlsZW5hbWVdO1xuICAgIHByb21pc2VzLnB1c2goXG4gICAgICBmcy5vdXRwdXRGaWxlKHBhdGguam9pbihjb25maWcuY29udHJhY3RzX2RpcmVjdG9yeSwgZmlsZW5hbWUpLCBzb3VyY2UpXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRNaWdyYXRpb25zKGNvbmZpZywgbWlncmF0aW9ucyA9IHt9KSB7XG4gIGxldCBwcm9taXNlcyA9IFtdO1xuICBmb3IgKGxldCBmaWxlbmFtZSBvZiBPYmplY3Qua2V5cyhtaWdyYXRpb25zKSkge1xuICAgIGxldCBzb3VyY2UgPSBtaWdyYXRpb25zW2ZpbGVuYW1lXTtcbiAgICBwcm9taXNlcy5wdXNoKFxuICAgICAgZnMub3V0cHV0RmlsZShwYXRoLmpvaW4oY29uZmlnLm1pZ3JhdGlvbnNfZGlyZWN0b3J5LCBmaWxlbmFtZSksIHNvdXJjZSlcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlZmF1bHRNaWdyYXRpb25zKGNvbnRyYWN0TmFtZXMpIHtcbiAgY29udHJhY3ROYW1lcyA9IGNvbnRyYWN0TmFtZXMuZmlsdGVyKChuYW1lKSA9PiBuYW1lICE9IFwiTWlncmF0aW9uc1wiKTtcblxuICBsZXQgbWlncmF0aW9ucyA9IHt9O1xuXG4gIGNvbnRyYWN0TmFtZXMuZm9yRWFjaCggKGNvbnRyYWN0TmFtZSwgaSkgPT4ge1xuICAgIGxldCBpbmRleCA9IGkgKyAyOyAgLy8gc3RhcnQgYXQgMiBjYXVzZSBNaWdyYXRpb25zIG1pZ3JhdGlvblxuICAgIGxldCBmaWxlbmFtZSA9IGAke2luZGV4fV9taWdyYXRlXyR7Y29udHJhY3ROYW1lfS5qc2A7XG4gICAgbGV0IHNvdXJjZSA9IGBcbiAgICAgIHZhciAke2NvbnRyYWN0TmFtZX0gPSBhcnRpZmFjdHMucmVxdWlyZShcIiR7Y29udHJhY3ROYW1lfVwiKTtcblxuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihkZXBsb3llcikge1xuICAgICAgICBkZXBsb3llci5kZXBsb3koJHtjb250cmFjdE5hbWV9KTtcbiAgICAgIH07XG4gICAgYDtcblxuICAgIG1pZ3JhdGlvbnNbZmlsZW5hbWVdID0gc291cmNlXG4gIH0pO1xuXG4gIHJldHVybiBtaWdyYXRpb25zO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tcGlsZShjb25maWcpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KSB7XG4gICAgQ29udHJhY3RzLmNvbXBpbGUoY29uZmlnLndpdGgoe1xuICAgICAgYWxsOiB0cnVlLFxuICAgICAgcXVpZXQ6IHRydWVcbiAgICB9KSwgZnVuY3Rpb24oZXJyLCBjb250cmFjdHMsIGZpbGVzKSB7XG4gICAgICBpZiAoZXJyKSByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICByZXR1cm4gYWNjZXB0KHtjb250cmFjdHMsIGZpbGVzfSk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWlncmF0ZShjb25maWcpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KSB7XG4gICAgTWlncmF0ZS5ydW4oY29uZmlnLndpdGgoe1xuICAgICAgcXVpZXQ6IHRydWVcbiAgICB9KSwgZnVuY3Rpb24oZXJyLCBjb250cmFjdHMpIHtcbiAgICAgIGlmIChlcnIpIHJldHVybiByZWplY3QoZXJyKTtcbiAgICAgIGFjY2VwdChjb250cmFjdHMpO1xuICAgIH0pO1xuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdhdGhlckFydGlmYWN0cyhjb25maWcpIHtcbiAgcmV0dXJuIERlYnVnLmdhdGhlckFydGlmYWN0cyhjb25maWcpO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHRlc3QvaGVscGVycy5qcyIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tIFwiZGVidWdcIjtcbmNvbnN0IGRlYnVnID0gZGVidWdNb2R1bGUoXCJkZWJ1Z2dlcjphc3Q6c2VsZWN0b3JzXCIpO1xuXG5pbXBvcnQgeyBjcmVhdGVTZWxlY3RvclRyZWUsIGNyZWF0ZUxlYWYgfSBmcm9tIFwicmVzZWxlY3QtdHJlZVwiO1xuaW1wb3J0IGpzb25wb2ludGVyIGZyb20gXCJqc29uLXBvaW50ZXJcIjtcblxuaW1wb3J0IHNvbGlkaXR5IGZyb20gXCJsaWIvc29saWRpdHkvc2VsZWN0b3JzXCI7XG5cbmltcG9ydCB7IGZpbmRSYW5nZSB9IGZyb20gXCIuLi9tYXBcIjtcblxuXG4vKipcbiAqIGFzdFxuICovXG5jb25zdCBhc3QgPSBjcmVhdGVTZWxlY3RvclRyZWUoe1xuICAvKipcbiAgICogYXN0LnZpZXdzXG4gICAqL1xuICB2aWV3czoge1xuICAgIC8qKlxuICAgICAqIGFzdC52aWV3cy5zb3VyY2VzXG4gICAgICovXG4gICAgc291cmNlczogY3JlYXRlTGVhZihbc29saWRpdHkuaW5mby5zb3VyY2VzXSwgc291cmNlcyA9PiBzb3VyY2VzKVxuICB9LFxuXG4gIC8qKlxuICAgKiBhc3QuY3VycmVudFxuICAgKi9cbiAgY3VycmVudDoge1xuXG4gICAgLyoqXG4gICAgICogYXN0LmN1cnJlbnQudHJlZVxuICAgICAqXG4gICAgICogYXN0IGZvciBjdXJyZW50IHNvdXJjZVxuICAgICAqL1xuICAgIHRyZWU6IGNyZWF0ZUxlYWYoXG4gICAgICBbc29saWRpdHkuY3VycmVudC5zb3VyY2VdLCAoe2FzdH0pID0+IGFzdFxuICAgICksXG5cbiAgICAvKipcbiAgICAgKiBhc3QuY3VycmVudC5pbmRleFxuICAgICAqXG4gICAgICogc291cmNlIElEXG4gICAgICovXG4gICAgaW5kZXg6IGNyZWF0ZUxlYWYoXG4gICAgICBbc29saWRpdHkuY3VycmVudC5zb3VyY2VdLCAoe2lkfSkgPT4gaWRcbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogYXN0LmN1cnJlbnQucG9pbnRlclxuICAgICAqXG4gICAgICoganNvbnBvaW50ZXIgZm9yIGN1cnJlbnQgYXN0IG5vZGVcbiAgICAgKi9cbiAgICBwb2ludGVyOiBjcmVhdGVMZWFmKFxuICAgICAgW1wiLi90cmVlXCIsIHNvbGlkaXR5LmN1cnJlbnQuc291cmNlUmFuZ2VdLFxuXG4gICAgICAoYXN0LCByYW5nZSkgPT4gZmluZFJhbmdlKGFzdCwgcmFuZ2Uuc3RhcnQsIHJhbmdlLmxlbmd0aClcbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogYXN0LmN1cnJlbnQubm9kZVxuICAgICAqXG4gICAgICogY3VycmVudCBhc3Qgbm9kZSB0byBleGVjdXRlXG4gICAgICovXG4gICAgbm9kZTogY3JlYXRlTGVhZihcbiAgICAgIFtcIi4vdHJlZVwiLCBcIi4vcG9pbnRlclwiXSwgKGFzdCwgcG9pbnRlcikgPT5cbiAgICAgICAgKHBvaW50ZXIpXG4gICAgICAgICAgPyBqc29ucG9pbnRlci5nZXQoYXN0LCBwb2ludGVyKVxuICAgICAgICAgIDoganNvbnBvaW50ZXIuZ2V0KGFzdCwgXCJcIilcbiAgICApLFxuXG4gIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBhc3Q7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL2FzdC9zZWxlY3RvcnMvaW5kZXguanMiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWR1eFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInJlZHV4XCJcbi8vIG1vZHVsZSBpZCA9IDIwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImdhbmFjaGUtY2xpXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiZ2FuYWNoZS1jbGlcIlxuLy8gbW9kdWxlIGlkID0gMjFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzXCJcbi8vIG1vZHVsZSBpZCA9IDIyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tICdkZWJ1Zyc7XG5pbXBvcnQgZXhwZWN0IGZyb20gXCJ0cnVmZmxlLWV4cGVjdFwiO1xuXG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi9zZXNzaW9uXCI7XG5cbmltcG9ydCB7IGNyZWF0ZU5lc3RlZFNlbGVjdG9yIH0gZnJvbSBcInJlc2VsZWN0LXRyZWVcIjtcblxuaW1wb3J0IGRhdGFTZWxlY3RvciBmcm9tIFwiLi9kYXRhL3NlbGVjdG9yc1wiO1xuaW1wb3J0IGFzdFNlbGVjdG9yIGZyb20gXCIuL2FzdC9zZWxlY3RvcnNcIjtcbmltcG9ydCB0cmFjZVNlbGVjdG9yIGZyb20gXCIuL3RyYWNlL3NlbGVjdG9yc1wiO1xuaW1wb3J0IGV2bVNlbGVjdG9yIGZyb20gXCIuL2V2bS9zZWxlY3RvcnNcIjtcbmltcG9ydCBzb2xpZGl0eVNlbGVjdG9yIGZyb20gXCIuL3NvbGlkaXR5L3NlbGVjdG9yc1wiO1xuaW1wb3J0IHNlc3Npb25TZWxlY3RvciBmcm9tIFwiLi9zZXNzaW9uL3NlbGVjdG9yc1wiO1xuXG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXJcIik7XG5cbi8qKlxuICogQGV4YW1wbGVcbiAqIGxldCBzZXNzaW9uID0gRGVidWdnZXJcbiAqICAgLmZvclR4KDx0eEhhc2g+LCB7XG4gKiAgICAgY29udHJhY3RzOiBbPGNvbnRyYWN0IG9iaj4sIC4uLl0sXG4gKiAgICAgcHJvdmlkZXI6IDxwcm92aWRlciBpbnN0YW5jZT5cbiAqICAgfSlcbiAqICAgLmNvbm5lY3QoKTtcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGVidWdnZXIge1xuICAvKipcbiAgICogQHBhcmFtIHtTZXNzaW9ufSBzZXNzaW9uIC0gZGVidWdnZXIgc2Vzc2lvblxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgY29uc3RydWN0b3Ioc2Vzc2lvbikge1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdGhpcy5fc2Vzc2lvbiA9IHNlc3Npb247XG4gIH1cblxuICAvKipcbiAgICogSW5zdGFudGlhdGVzIGEgRGVidWdnZXIgZm9yIGEgZ2l2ZW4gdHJhbnNhY3Rpb24gaGFzaC5cbiAgICpcbiAgICogQHBhcmFtIHtTdHJpbmd9IHR4SGFzaCAtIHRyYW5zYWN0aW9uIGhhc2ggd2l0aCBsZWFkaW5nIFwiMHhcIlxuICAgKiBAcGFyYW0ge3tjb250cmFjdHM6IEFycmF5PENvbnRyYWN0PiwgZmlsZXM6IEFycmF5PFN0cmluZz4sIHByb3ZpZGVyOiBXZWIzUHJvdmlkZXJ9fSBvcHRpb25zIC1cbiAgICogQHJldHVybiB7RGVidWdnZXJ9IGluc3RhbmNlXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZm9yVHgodHhIYXNoLCBvcHRpb25zID0ge30pIHtcbiAgICBleHBlY3Qub3B0aW9ucyhvcHRpb25zLCBbXG4gICAgICBcImNvbnRyYWN0c1wiLFxuICAgICAgXCJwcm92aWRlclwiXG4gICAgXSk7XG5cbiAgICBsZXQgc2Vzc2lvbiA9IG5ldyBTZXNzaW9uKFxuICAgICAgb3B0aW9ucy5jb250cmFjdHMsIG9wdGlvbnMuZmlsZXMsXG4gICAgICB0eEhhc2gsIG9wdGlvbnMucHJvdmlkZXJcbiAgICApO1xuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHNlc3Npb24ucmVhZHkoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgdGhpcyhzZXNzaW9uKTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIENvbm5lY3RzIHRvIHRoZSBpbnN0YW50aWF0ZWQgRGVidWdnZXIuXG4gICAqXG4gICAqIEByZXR1cm4ge1Nlc3Npb259IHNlc3Npb24gaW5zdGFuY2VcbiAgICovXG4gIGNvbm5lY3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Nlc3Npb247XG4gIH1cblxuICAvKipcbiAgICogRXhwb3J0ZWQgc2VsZWN0b3JzXG4gICAqXG4gICAqIFNlZSBpbmRpdmlkdWFsIHNlbGVjdG9yIGRvY3MgZm9yIGZ1bGwgbGlzdGluZ1xuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBEZWJ1Z2dlci5zZWxlY3RvcnMuYXN0LmN1cnJlbnQudHJlZVxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBEZWJ1Z2dlci5zZWxlY3RvcnMuc29saWRpdHkuY3VycmVudC5pbnN0cnVjdGlvblxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBEZWJ1Z2dlci5zZWxlY3RvcnMudHJhY2Uuc3RlcHNcbiAgICovXG4gIHN0YXRpYyBnZXQgc2VsZWN0b3JzKCkge1xuICAgIHJldHVybiBjcmVhdGVOZXN0ZWRTZWxlY3Rvcih7XG4gICAgICBhc3Q6IGFzdFNlbGVjdG9yLFxuICAgICAgZGF0YTogZGF0YVNlbGVjdG9yLFxuICAgICAgdHJhY2U6IHRyYWNlU2VsZWN0b3IsXG4gICAgICBldm06IGV2bVNlbGVjdG9yLFxuICAgICAgc29saWRpdHk6IHNvbGlkaXR5U2VsZWN0b3IsXG4gICAgICBzZXNzaW9uOiBzZXNzaW9uU2VsZWN0b3IsXG4gICAgfSk7XG4gIH1cbn1cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBDb250cmFjdFxuICogQHByb3BlcnR5IHtzdHJpbmd9IGNvbnRyYWN0TmFtZSBjb250cmFjdCBuYW1lXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlIHNvbGlkaXR5IHNvdXJjZSBjb2RlXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc291cmNlUGF0aCBwYXRoIHRvIHNvdXJjZSBmaWxlXG4gKiBAcHJvcGVydHkge3N0cmluZ30gYmluYXJ5IDB4LXByZWZpeGVkIGhleCBzdHJpbmcgd2l0aCBjcmVhdGUgYnl0ZWNvZGVcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzb3VyY2VNYXAgc29saWRpdHkgc291cmNlIG1hcCBmb3IgY3JlYXRlIGJ5dGVjb2RlXG4gKiBAcHJvcGVydHkge09iamVjdH0gYXN0IEFic3RyYWN0IFN5bnRheCBUcmVlIGZyb20gU29saWRpdHlcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXBsb3llZEJpbmFyeSAweC1wcmVmaXhlZCBjb21waWxlZCBiaW5hcnkgKG9uIGNoYWluKVxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRlcGxveWVkU291cmNlTWFwIHNvbGlkaXR5IHNvdXJjZSBtYXAgZm9yIG9uLWNoYWluIGJ5dGVjb2RlXG4gKi9cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvZGVidWdnZXIuanMiLCJpbXBvcnQgeyBjcmVhdGVTZWxlY3RvclRyZWUsIGNyZWF0ZUxlYWYgfSBmcm9tIFwicmVzZWxlY3QtdHJlZVwiO1xuXG5sZXQgdHJhY2UgPSBjcmVhdGVTZWxlY3RvclRyZWUoe1xuICAvKipcbiAgICogdHJhY2UuaW5kZXhcbiAgICpcbiAgICogY3VycmVudCBzdGVwIGluZGV4XG4gICAqL1xuICBpbmRleDogKHN0YXRlKSA9PiBzdGF0ZS50cmFjZS5wcm9jLmluZGV4LFxuXG4gIC8qKlxuICAgKiB0cmFjZS5zdGVwc1xuICAgKlxuICAgKiBhbGwgdHJhY2Ugc3RlcHNcbiAgICovXG4gIHN0ZXBzOiAoc3RhdGUpID0+IHN0YXRlLnRyYWNlLmluZm8uc3RlcHMsXG5cbiAgLyoqXG4gICAqIHRyYWNlLnN0ZXBzUmVtYWluaW5nXG4gICAqXG4gICAqIG51bWJlciBvZiBzdGVwcyByZW1haW5pbmcgaW4gdHJhY2VcbiAgICovXG4gIHN0ZXBzUmVtYWluaW5nOiBjcmVhdGVMZWFmKFxuICAgIFtcIi4vc3RlcHNcIiwgXCIuL2luZGV4XCJdLCAoc3RlcHMsIGluZGV4KSA9PiBzdGVwcy5sZW5ndGggLSBpbmRleFxuICApLFxuXG4gIC8qKlxuICAgKiB0cmFjZS5zdGVwXG4gICAqXG4gICAqIGN1cnJlbnQgdHJhY2Ugc3RlcFxuICAgKi9cbiAgc3RlcDogY3JlYXRlTGVhZihcbiAgICBbXCIuL3N0ZXBzXCIsIFwiLi9pbmRleFwiXSwgKHN0ZXBzLCBpbmRleCkgPT4gc3RlcHNbaW5kZXhdXG4gICksXG5cbiAgLyoqXG4gICAqIHRyYWNlLm5leHRcbiAgICpcbiAgICogbmV4dCB0cmFjZSBzdGVwIG9yIHt9XG4gICAqL1xuICBuZXh0OiBjcmVhdGVMZWFmKFxuICAgIFtcIi4vc3RlcHNcIiwgXCIuL2luZGV4XCJdLCAoc3RlcHMsIGluZGV4KSA9PlxuICAgICAgaW5kZXggPCBzdGVwcy5sZW5ndGggLSAxID8gc3RlcHNbaW5kZXggKyAxXSA6IHt9XG4gIClcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCB0cmFjZTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvdHJhY2Uvc2VsZWN0b3JzL2luZGV4LmpzIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmlnbnVtYmVyLmpzXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiYmlnbnVtYmVyLmpzXCJcbi8vIG1vZHVsZSBpZCA9IDI1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImV4cG9ydCBjb25zdCBTQVZFX1NURVBTID0gXCJTQVZFX1NURVBTXCI7XG5leHBvcnQgZnVuY3Rpb24gc2F2ZVN0ZXBzKHN0ZXBzKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogU0FWRV9TVEVQUyxcbiAgICBzdGVwc1xuICB9O1xufVxuXG5leHBvcnQgY29uc3QgUkVDRUlWRV9BRERSRVNTRVMgPSBcIlJFQ0VJVkVfQUREUkVTU0VTXCI7XG5leHBvcnQgZnVuY3Rpb24gcmVjZWl2ZUFkZHJlc3NlcyhhZGRyZXNzZXMpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBSRUNFSVZFX0FERFJFU1NFUyxcbiAgICBhZGRyZXNzZXNcbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IE5FWFQgPSBcIk5FWFRcIjtcbmV4cG9ydCBmdW5jdGlvbiBuZXh0KCkge1xuICByZXR1cm4ge3R5cGU6IE5FWFR9O1xufVxuXG5leHBvcnQgY29uc3QgVElDSyA9IFwiVElDS1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHRpY2soKSB7XG4gIHJldHVybiB7dHlwZTogVElDS307XG59XG5cbmV4cG9ydCBjb25zdCBUT0NLID0gXCJUT0NLXCI7XG5leHBvcnQgZnVuY3Rpb24gdG9jaygpIHtcbiAgcmV0dXJuIHt0eXBlOiBUT0NLfTtcbn1cblxuZXhwb3J0IGNvbnN0IEVORF9PRl9UUkFDRSA9IFwiRU9UXCI7XG5leHBvcnQgZnVuY3Rpb24gZW5kVHJhY2UoKSB7XG4gIHJldHVybiB7dHlwZTogRU5EX09GX1RSQUNFfTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvdHJhY2UvYWN0aW9ucy9pbmRleC5qcyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2VcIlxuLy8gbW9kdWxlIGlkID0gMjdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCJcbi8vIG1vZHVsZSBpZCA9IDI4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzc1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzc1wiXG4vLyBtb2R1bGUgaWQgPSAyOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJqc29uLXBvaW50ZXJcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJqc29uLXBvaW50ZXJcIlxuLy8gbW9kdWxlIGlkID0gMzBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiZXhwb3J0IGNvbnN0IFNUQVJUID0gXCJTRVNTSU9OX1NUQVJUXCI7XG5leHBvcnQgZnVuY3Rpb24gc3RhcnQodHhIYXNoLCBwcm92aWRlcikge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFNUQVJULFxuICAgIHR4SGFzaCwgcHJvdmlkZXJcbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IFJFQURZID0gXCJTRVNTSU9OX1JFQURZXCI7XG5leHBvcnQgZnVuY3Rpb24gcmVhZHkoKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogUkVBRFksXG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBFUlJPUiA9IFwiU0VTU0lPTl9FUlJPUlwiO1xuZXhwb3J0IGZ1bmN0aW9uIGVycm9yKGVycm9yKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogRVJST1IsXG4gICAgZXJyb3JcbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IEZJTklTSCA9IFwiU0VTU0lPTl9GSU5JU0hcIjtcbmV4cG9ydCBmdW5jdGlvbiBmaW5pc2goKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogRklOSVNILFxuICB9O1xufVxuXG5leHBvcnQgY29uc3QgUkVDT1JEX0NPTlRSQUNUUyA9IFwiUkVDT1JEX0NPTlRSQUNUU1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHJlY29yZENvbnRyYWN0cyhjb250ZXh0cywgc291cmNlcykge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFJFQ09SRF9DT05UUkFDVFMsXG4gICAgY29udGV4dHMsIHNvdXJjZXNcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9zZXNzaW9uL2FjdGlvbnMvaW5kZXguanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6ZGF0YTpzZWxlY3RvcnNcIik7XG5cbmltcG9ydCB7IGNyZWF0ZVNlbGVjdG9yVHJlZSwgY3JlYXRlTGVhZiB9IGZyb20gXCJyZXNlbGVjdC10cmVlXCI7XG5pbXBvcnQganNvbnBvaW50ZXIgZnJvbSBcImpzb24tcG9pbnRlclwiO1xuXG5pbXBvcnQgYXN0IGZyb20gXCJsaWIvYXN0L3NlbGVjdG9yc1wiO1xuaW1wb3J0IGV2bSBmcm9tIFwibGliL2V2bS9zZWxlY3RvcnNcIjtcbmltcG9ydCBzb2xpZGl0eSBmcm9tIFwibGliL3NvbGlkaXR5L3NlbGVjdG9yc1wiO1xuXG5pbXBvcnQgZGVjb2RlIGZyb20gXCIuLi9kZWNvZGVcIjtcbmltcG9ydCAqIGFzIGRlY29kZVV0aWxzIGZyb20gXCIuLi9kZWNvZGUvdXRpbHNcIjtcblxuaW1wb3J0IHsgQmlnTnVtYmVyIH0gZnJvbSBcImJpZ251bWJlci5qc1wiO1xuXG5mdW5jdGlvbiBjcmVhdGVTdGF0ZVNlbGVjdG9ycyh7IHN0YWNrLCBtZW1vcnksIHN0b3JhZ2UgfSkge1xuICByZXR1cm4ge1xuICAgIC8qKlxuICAgICAqIC5zdGFja1xuICAgICAqL1xuICAgIHN0YWNrOiBjcmVhdGVMZWFmKFxuICAgICAgW3N0YWNrXSxcblxuICAgICAgKHdvcmRzKSA9PiAod29yZHMgfHwgW10pLm1hcChcbiAgICAgICAgKHdvcmQpID0+IGRlY29kZVV0aWxzLnRvQnl0ZXMoZGVjb2RlVXRpbHMudG9CaWdOdW1iZXIod29yZCwgZGVjb2RlVXRpbHMuV09SRF9TSVpFKSlcbiAgICAgIClcbiAgICApLFxuXG4gICAgLyoqXG4gICAgICogLm1lbW9yeVxuICAgICAqL1xuICAgIG1lbW9yeTogY3JlYXRlTGVhZihcbiAgICAgIFttZW1vcnldLFxuXG4gICAgICAod29yZHMpID0+IG5ldyBVaW50OEFycmF5KFxuICAgICAgICAod29yZHMuam9pbihcIlwiKS5tYXRjaCgvLnsxLDJ9L2cpIHx8IFtdKVxuICAgICAgICAgIC5tYXAoIChieXRlKSA9PiBwYXJzZUludChieXRlLCAxNikgKVxuICAgICAgKVxuICAgICksXG5cbiAgICAvKipcbiAgICAgKiAuc3RvcmFnZVxuICAgICAqL1xuICAgIHN0b3JhZ2U6IGNyZWF0ZUxlYWYoXG4gICAgICBbc3RvcmFnZV0sXG5cbiAgICAgIChtYXBwaW5nKSA9PiBPYmplY3QuYXNzaWduKFxuICAgICAgICB7fSwgLi4uT2JqZWN0LmVudHJpZXMobWFwcGluZykubWFwKCAoWyBhZGRyZXNzLCB3b3JkIF0pID0+XG4gICAgICAgICAgKHtcbiAgICAgICAgICAgIFtgMHgke2FkZHJlc3N9YF06IG5ldyBVaW50OEFycmF5KFxuICAgICAgICAgICAgICAod29yZC5tYXRjaCgvLnsxLDJ9L2cpIHx8IFtdKVxuICAgICAgICAgICAgICAgIC5tYXAoIChieXRlKSA9PiBwYXJzZUludChieXRlLCAxNikgKVxuICAgICAgICAgICAgKVxuICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgIClcbiAgICApXG4gIH07XG59XG5cbmNvbnN0IGRhdGEgPSBjcmVhdGVTZWxlY3RvclRyZWUoe1xuICBzdGF0ZTogKHN0YXRlKSA9PiBzdGF0ZS5kYXRhLFxuXG4gIC8qKlxuICAgKiBkYXRhLnZpZXdzXG4gICAqL1xuICB2aWV3czoge1xuICAgIGFzdDogY3JlYXRlTGVhZihcbiAgICAgIFthc3QuY3VycmVudF0sICh0cmVlKSA9PiB0cmVlXG4gICAgKSxcblxuICAgIGF0TGFzdEluc3RydWN0aW9uRm9yU291cmNlUmFuZ2U6IGNyZWF0ZUxlYWYoXG4gICAgICBbc29saWRpdHkuY3VycmVudC5pc1NvdXJjZVJhbmdlRmluYWxdLCAoZmluYWwpID0+IGZpbmFsXG4gICAgKSxcblxuICAgIC8qKlxuICAgICAqIGRhdGEudmlld3Muc2NvcGVzXG4gICAgICovXG4gICAgc2NvcGVzOiB7XG5cbiAgICAgIC8qKlxuICAgICAgICogZGF0YS52aWV3cy5zY29wZXMuaW5saW5lZFxuICAgICAgICovXG4gICAgICBpbmxpbmVkOiBjcmVhdGVMZWFmKFxuICAgICAgICBbXCIvaW5mby9zY29wZXNcIiwgc29saWRpdHkuaW5mby5zb3VyY2VzXSxcblxuICAgICAgICAoc2NvcGVzLCBzb3VyY2VzKSA9PiBPYmplY3QuYXNzaWduKHt9LFxuICAgICAgICAgIC4uLk9iamVjdC5lbnRyaWVzKHNjb3BlcykubWFwKFxuICAgICAgICAgICAgKFtpZCwgZW50cnldKSA9PiAoe1xuICAgICAgICAgICAgICBbaWRdOiB7XG4gICAgICAgICAgICAgICAgLi4uZW50cnksXG5cbiAgICAgICAgICAgICAgICBkZWZpbml0aW9uOiBqc29ucG9pbnRlci5nZXQoXG4gICAgICAgICAgICAgICAgICBzb3VyY2VzW2VudHJ5LnNvdXJjZUlkXS5hc3QsIGVudHJ5LnBvaW50ZXJcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIGRhdGEudmlld3MuZGVjb2RlclxuICAgICAqXG4gICAgICogc2VsZWN0b3IgcmV0dXJucyAoYXN0IG5vZGUgZGVmaW5pdGlvbiwgZGF0YSByZWZlcmVuY2UpID0+IHZhbHVlXG4gICAgICovXG4gICAgZGVjb2RlcjogY3JlYXRlTGVhZihcbiAgICAgIFtcIi92aWV3cy9zY29wZXMvaW5saW5lZFwiLCBcIi9jdXJyZW50L3N0YXRlXCJdLFxuXG4gICAgICAoc2NvcGVzLCBzdGF0ZSkgPT4ge1xuICAgICAgICByZXR1cm4gKGRlZmluaXRpb24sIHJlZikgPT4gZGVjb2RlKGRlZmluaXRpb24sIHJlZiwgc3RhdGUsIHNjb3BlcylcbiAgICAgIH1cbiAgICApXG4gIH0sXG5cbiAgLyoqXG4gICAqIGRhdGEuaW5mb1xuICAgKi9cbiAgaW5mbzoge1xuXG4gICAgLyoqXG4gICAgICogZGF0YS5pbmZvLnNjb3Blc1xuICAgICAqL1xuICAgIHNjb3BlczogY3JlYXRlTGVhZihbXCIvc3RhdGVcIl0sIChzdGF0ZSkgPT4gc3RhdGUuaW5mby5zY29wZXMuYnlJZClcbiAgfSxcblxuICAvKipcbiAgICogZGF0YS5wcm9jXG4gICAqL1xuICBwcm9jOiB7XG5cbiAgICAvKipcbiAgICAgKiBkYXRhLnByb2MuYXNzaWdubWVudHNcbiAgICAgKi9cbiAgICBhc3NpZ25tZW50czogY3JlYXRlTGVhZihbXCIvc3RhdGVcIl0sIChzdGF0ZSkgPT4gc3RhdGUucHJvYy5hc3NpZ25tZW50cy5ieUlkKVxuICB9LFxuXG4gIC8qKlxuICAgKiBkYXRhLmN1cnJlbnRcbiAgICovXG4gIGN1cnJlbnQ6IHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIGRhdGEuY3VycmVudC5zY29wZVxuICAgICAqL1xuICAgIHNjb3BlOiB7XG5cbiAgICAgIC8qKlxuICAgICAgICogZGF0YS5jdXJyZW50LnNjb3BlLmlkXG4gICAgICAgKi9cbiAgICAgIGlkOiBjcmVhdGVMZWFmKFxuICAgICAgICBbYXN0LmN1cnJlbnQubm9kZV0sIChub2RlKSA9PiBub2RlLmlkXG4gICAgICApXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIGRhdGEuY3VycmVudC5zdGF0ZVxuICAgICAqL1xuICAgIHN0YXRlOiBjcmVhdGVTdGF0ZVNlbGVjdG9ycyhldm0uY3VycmVudC5zdGF0ZSksXG5cbiAgICAvKipcbiAgICAgKiBkYXRhLmN1cnJlbnQuaWRlbnRpZmllcnMgKG5hbWVzcGFjZSlcbiAgICAgKi9cbiAgICBpZGVudGlmaWVyczoge1xuXG4gICAgICAvKipcbiAgICAgICAqIGRhdGEuY3VycmVudC5pZGVudGlmaWVycyAoc2VsZWN0b3IpXG4gICAgICAgKlxuICAgICAgICogcmV0dXJucyBpZGVudGlmZXJzIGFuZCBjb3JyZXNwb25kaW5nIGRlZmluaXRpb24gbm9kZSBJRFxuICAgICAgICovXG4gICAgICBfOiBjcmVhdGVMZWFmKFxuICAgICAgICBbXG4gICAgICAgICAgXCIvdmlld3Mvc2NvcGVzL2lubGluZWRcIixcbiAgICAgICAgICBcIi9jdXJyZW50L3Njb3BlXCIsXG4gICAgICAgIF0sXG5cbiAgICAgICAgKHNjb3Blcywgc2NvcGUpID0+IHtcbiAgICAgICAgICBsZXQgY3VyID0gc2NvcGUuaWQ7XG4gICAgICAgICAgbGV0IHZhcmlhYmxlcyA9IHt9O1xuXG4gICAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyaWFibGVzID0gT2JqZWN0LmFzc2lnbihcbiAgICAgICAgICAgICAgdmFyaWFibGVzLFxuICAgICAgICAgICAgICAuLi4oc2NvcGVzW2N1cl0udmFyaWFibGVzIHx8IFtdKVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoICh2KSA9PiB2YXJpYWJsZXNbdi5uYW1lXSA9PSB1bmRlZmluZWQgKVxuICAgICAgICAgICAgICAgIC5tYXAoICh2KSA9PiAoeyBbdi5uYW1lXTogdi5pZCB9KSApXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjdXIgPSBzY29wZXNbY3VyXS5wYXJlbnRJZDtcbiAgICAgICAgICB9IHdoaWxlIChjdXIgIT0gbnVsbCk7XG5cbiAgICAgICAgICByZXR1cm4gdmFyaWFibGVzO1xuICAgICAgICB9XG4gICAgICApLFxuXG4gICAgICAvKipcbiAgICAgICAqIGRhdGEuY3VycmVudC5pZGVudGlmaWVycy5kZWZpbml0aW9uc1xuICAgICAgICpcbiAgICAgICAqIGN1cnJlbnQgdmFyaWFibGUgZGVmaW5pdGlvbnNcbiAgICAgICAqL1xuICAgICAgZGVmaW5pdGlvbnM6IGNyZWF0ZUxlYWYoXG4gICAgICAgIFtcbiAgICAgICAgICBcIi92aWV3cy9zY29wZXMvaW5saW5lZFwiLFxuICAgICAgICAgIFwiLi9fXCJcbiAgICAgICAgXSxcblxuICAgICAgICAoc2NvcGVzLCBpZGVudGlmaWVycykgPT4gT2JqZWN0LmFzc2lnbih7fSxcbiAgICAgICAgICAuLi5PYmplY3QuZW50cmllcyhpZGVudGlmaWVycylcbiAgICAgICAgICAgIC5tYXAoIChbaWRlbnRpZmllciwgaWRdKSA9PiB7XG4gICAgICAgICAgICAgIGxldCB7IGRlZmluaXRpb24gfSA9IHNjb3Blc1tpZF07XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHsgW2lkZW50aWZpZXJdOiBkZWZpbml0aW9uIH07XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICApLFxuXG4gICAgICAvKipcbiAgICAgICAqIGRhdGEuY3VycmVudC5pZGVudGlmaWVycy5yZWZzXG4gICAgICAgKlxuICAgICAgICogY3VycmVudCB2YXJpYWJsZXMnIHZhbHVlIHJlZnNcbiAgICAgICAqL1xuICAgICAgcmVmczogY3JlYXRlTGVhZihcbiAgICAgICAgW1xuICAgICAgICAgIFwiL3Byb2MvYXNzaWdubWVudHNcIixcbiAgICAgICAgICBcIi4vX1wiXG4gICAgICAgIF0sXG5cbiAgICAgICAgKGFzc2lnbm1lbnRzLCBpZGVudGlmaWVycykgPT4gT2JqZWN0LmFzc2lnbih7fSxcbiAgICAgICAgICAuLi5PYmplY3QuZW50cmllcyhpZGVudGlmaWVycylcbiAgICAgICAgICAgIC5tYXAoIChbaWRlbnRpZmllciwgaWRdKSA9PiB7XG4gICAgICAgICAgICAgIGxldCB7IHJlZiB9ID0gKGFzc2lnbm1lbnRzW2lkXSB8fCB7fSlcbiAgICAgICAgICAgICAgaWYgKCFyZWYpIHsgcmV0dXJuIHVuZGVmaW5lZCB9O1xuXG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgW2lkZW50aWZpZXJdOiByZWZcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgICksXG5cbiAgICAgIGRlY29kZWQ6IGNyZWF0ZUxlYWYoXG4gICAgICAgIFtcbiAgICAgICAgICBcIi92aWV3cy9kZWNvZGVyXCIsXG4gICAgICAgICAgXCIuL2RlZmluaXRpb25zXCIsXG4gICAgICAgICAgXCIuL3JlZnNcIixcbiAgICAgICAgXSxcblxuICAgICAgICAoZGVjb2RlLCBkZWZpbml0aW9ucywgcmVmcykgPT4gT2JqZWN0LmFzc2lnbih7fSxcbiAgICAgICAgICAuLi5PYmplY3QuZW50cmllcyhyZWZzKVxuICAgICAgICAgICAgLm1hcCggKFtpZGVudGlmaWVyLCByZWZdKSA9PiAoe1xuICAgICAgICAgICAgICBbaWRlbnRpZmllcl06IGRlY29kZShkZWZpbml0aW9uc1tpZGVudGlmaWVyXSwgcmVmKVxuICAgICAgICAgICAgfSkgKVxuICAgICAgICApXG4gICAgICApLFxuXG4gICAgICBuYXRpdmU6IGNyZWF0ZUxlYWYoWycuL2RlY29kZWQnXSwgZGVjb2RlVXRpbHMuY2xlYW5CaWdOdW1iZXJzKVxuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogZGF0YS5uZXh0XG4gICAqL1xuICBuZXh0OiB7XG5cbiAgICAvKipcbiAgICAgKiBkYXRhLm5leHQuc3RhdGVcbiAgICAgKi9cbiAgICBzdGF0ZTogY3JlYXRlU3RhdGVTZWxlY3RvcnMoZXZtLm5leHQuc3RhdGUpXG4gIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBkYXRhO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9kYXRhL3NlbGVjdG9ycy9pbmRleC5qcyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9zZXRcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJiYWJlbC1ydW50aW1lL2NvcmUtanMvc2V0XCJcbi8vIG1vZHVsZSBpZCA9IDMzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInRydWZmbGUtZXhwZWN0XCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwidHJ1ZmZsZS1leHBlY3RcIlxuLy8gbW9kdWxlIGlkID0gMzRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9oZWxwZXJzL3R5cGVvZlwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImJhYmVsLXJ1bnRpbWUvaGVscGVycy90eXBlb2ZcIlxuLy8gbW9kdWxlIGlkID0gMzVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IGRlYnVnTW9kdWxlIGZyb20gXCJkZWJ1Z1wiO1xuY29uc3QgZGVidWcgPSBkZWJ1Z01vZHVsZShcImRlYnVnZ2VyOmFzdDptYXBcIik7XG5cbmltcG9ydCBJbnRlcnZhbFRyZWUgZnJvbSBcIm5vZGUtaW50ZXJ2YWwtdHJlZVwiO1xuXG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJhbmdlKG5vZGUpIHtcbiAgLy8gc3JjOiBcIjxzdGFydD46PGxlbmd0aD46PF8+XCJcbiAgLy8gcmV0dXJucyBbc3RhcnQsIGVuZF1cbiAgbGV0IFtzdGFydCwgbGVuZ3RoXSA9IG5vZGUuc3JjXG4gICAgLnNwbGl0KFwiOlwiKVxuICAgIC5zbGljZSgwLCAyKVxuICAgIC5tYXAoIChpKSA9PiBwYXJzZUludChpKSApO1xuXG4gIHJldHVybiBbc3RhcnQsIHN0YXJ0ICsgbGVuZ3RoXTtcbn1cblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmFuZ2VOb2Rlcyhub2RlLCBwb2ludGVyID0gXCJcIikge1xuICBpZiAobm9kZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgcmV0dXJuIFtdLmNvbmNhdChcbiAgICAgIC4uLm5vZGUubWFwKCAoc3ViLCBpKSA9PiByYW5nZU5vZGVzKHN1YiwgYCR7cG9pbnRlcn0vJHtpfWApIClcbiAgICApO1xuICB9IGVsc2UgaWYgKG5vZGUgaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICBsZXQgcmVzdWx0cyA9IFtdO1xuXG4gICAgaWYgKG5vZGUuc3JjKSB7XG4gICAgICByZXN1bHRzLnB1c2goe3BvaW50ZXIsIHJhbmdlOiBnZXRSYW5nZShub2RlKX0pO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRzLmNvbmNhdChcbiAgICAgIC4uLk9iamVjdC5rZXlzKG5vZGUpLm1hcChcbiAgICAgICAgKGtleSkgPT4gcmFuZ2VOb2Rlcyhub2RlW2tleV0sIGAke3BvaW50ZXJ9LyR7a2V5fWApXG4gICAgICApXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZmluZFJhbmdlKG5vZGUsIHNvdXJjZVN0YXJ0LCBzb3VyY2VMZW5ndGgpIHtcbiAgbGV0IHJhbmdlcyA9IHJhbmdlTm9kZXMobm9kZSk7XG4gIGxldCB0cmVlID0gbmV3IEludGVydmFsVHJlZSgpO1xuXG4gIHJhbmdlcy5mb3JFYWNoKCAoe3JhbmdlLCBwb2ludGVyfSkgPT4ge1xuICAgIGxldCBbc3RhcnQsIGVuZF0gPSByYW5nZTtcblxuICAgIHRyZWUuaW5zZXJ0KHN0YXJ0LCBlbmQsIHtyYW5nZSwgcG9pbnRlcn0pO1xuICB9KTtcblxuICBsZXQgc291cmNlRW5kID0gc291cmNlU3RhcnQgKyBzb3VyY2VMZW5ndGg7XG5cbiAgbGV0IG92ZXJsYXBwaW5nID0gdHJlZS5zZWFyY2goc291cmNlU3RhcnQsIHNvdXJjZUVuZCk7XG5cbiAgLy8gZmluZCBub2RlcyB0aGF0IGZ1bGx5IGNvbnRhaW4gcmVxdWVzdGVkIHJhbmdlLFxuICAvLyByZXR1cm4gbG9uZ2VzdCBwb2ludGVyXG4gIHJldHVybiBvdmVybGFwcGluZ1xuICAgIC5maWx0ZXIoICh7cmFuZ2V9KSA9PiBzb3VyY2VTdGFydCA+PSByYW5nZVswXSAmJiBzb3VyY2VFbmQgPD0gcmFuZ2VbMV0gKVxuICAgIC5tYXAoICh7cG9pbnRlcn0pID0+IHBvaW50ZXIgKVxuICAgIC5yZWR1Y2UoIChhLCBiKSA9PiBhLmxlbmd0aCA+IGIubGVuZ3RoID8gYSA6IGIsIFwiXCIgKTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvYXN0L21hcC5qcyIsImV4cG9ydCBjb25zdCBCRUdJTl9TVEVQID0gXCJCRUdJTl9TVEVQXCI7XG5leHBvcnQgZnVuY3Rpb24gYmVnaW5TdGVwKHR5cGUpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBCRUdJTl9TVEVQLFxuICAgIHN0ZXBUeXBlOiB0eXBlXG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBBRFZBTkNFID0gXCJBRFZBTkNFXCI7XG5leHBvcnQgZnVuY3Rpb24gYWR2YW5jZSgpIHtcbiAgcmV0dXJuIHt0eXBlOiBBRFZBTkNFfTtcbn1cblxuZXhwb3J0IGNvbnN0IFNURVBfTkVYVCA9IFwiU1RFUF9ORVhUXCI7XG5leHBvcnQgZnVuY3Rpb24gc3RlcE5leHQoKSB7XG4gIHJldHVybiB7dHlwZTogU1RFUF9ORVhUfTtcbn1cblxuZXhwb3J0IGNvbnN0IFNURVBfT1ZFUiA9IFwiU1RFUF9PVkVSXCI7XG5leHBvcnQgZnVuY3Rpb24gc3RlcE92ZXIoKSB7XG4gIHJldHVybiB7dHlwZTogU1RFUF9PVkVSfTtcbn1cblxuZXhwb3J0IGNvbnN0IFNURVBfSU5UTyA9IFwiU1RFUF9JTlRPXCI7XG5leHBvcnQgZnVuY3Rpb24gc3RlcEludG8oKSB7XG4gIHJldHVybiB7dHlwZTogU1RFUF9JTlRPfTtcbn1cblxuZXhwb3J0IGNvbnN0IFNURVBfT1VUID0gXCJTVEVQX09VVFwiO1xuZXhwb3J0IGZ1bmN0aW9uIHN0ZXBPdXQoKSB7XG4gIHJldHVybiB7dHlwZTogU1RFUF9PVVR9O1xufVxuXG5leHBvcnQgY29uc3QgSU5URVJSVVBUID0gXCJJTlRFUlJVUFRcIjtcbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnJ1cHQgKCkge1xuICByZXR1cm4ge3R5cGU6IElOVEVSUlVQVH07XG59XG5cblxuZXhwb3J0IGNvbnN0IENPTlRJTlVFX1VOVElMID0gXCJDT05USU5VRV9VTlRJTFwiO1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnRpbnVlVW50aWwoLi4uYnJlYWtwb2ludHMpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBDT05USU5VRV9VTlRJTCxcbiAgICBicmVha3BvaW50c1xuICB9O1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9jb250cm9sbGVyL2FjdGlvbnMvaW5kZXguanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6ZGF0YTpzYWdhc1wiKTtcblxuaW1wb3J0IHsgcHV0LCB0YWtlRXZlcnksIHNlbGVjdCB9IGZyb20gXCJyZWR1eC1zYWdhL2VmZmVjdHNcIjtcbmltcG9ydCBqc29ucG9pbnRlciBmcm9tIFwianNvbi1wb2ludGVyXCI7XG5cbmltcG9ydCB7IHByZWZpeE5hbWUgfSBmcm9tIFwibGliL2hlbHBlcnNcIjtcblxuaW1wb3J0IHsgVElDSyB9IGZyb20gXCJsaWIvdHJhY2UvYWN0aW9uc1wiO1xuaW1wb3J0ICogYXMgYWN0aW9ucyBmcm9tIFwiLi4vYWN0aW9uc1wiO1xuXG5pbXBvcnQgZGF0YSBmcm9tIFwiLi4vc2VsZWN0b3JzXCI7XG5cbmltcG9ydCB7IFdPUkRfU0laRSB9IGZyb20gXCJsaWIvZGF0YS9kZWNvZGUvdXRpbHNcIjtcbmltcG9ydCAqIGFzIHV0aWxzIGZyb20gXCJsaWIvZGF0YS9kZWNvZGUvdXRpbHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uICpzY29wZShub2RlSWQsIHBvaW50ZXIsIHBhcmVudElkLCBzb3VyY2VJZCkge1xuICB5aWVsZCBwdXQoYWN0aW9ucy5zY29wZShub2RlSWQsIHBvaW50ZXIsIHBhcmVudElkLCBzb3VyY2VJZCkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gKmRlY2xhcmUobm9kZSkge1xuICB5aWVsZCBwdXQoYWN0aW9ucy5kZWNsYXJlKG5vZGUpKTtcbn1cblxuZnVuY3Rpb24gKnRpY2tTYWdhKCkge1xuICBsZXQge1xuICAgIHRyZWUsXG4gICAgaWQ6IHRyZWVJZCxcbiAgICBub2RlLFxuICAgIHBvaW50ZXJcbiAgfSA9IHlpZWxkIHNlbGVjdChkYXRhLnZpZXdzLmFzdCk7XG5cbiAgbGV0IHNjb3BlcyA9IHlpZWxkIHNlbGVjdChkYXRhLmluZm8uc2NvcGVzKTtcbiAgbGV0IGRlZmluaXRpb25zID0geWllbGQgc2VsZWN0KGRhdGEudmlld3Muc2NvcGVzLmlubGluZWQpO1xuXG4gIGxldCBzdGFjayA9IHlpZWxkIHNlbGVjdChkYXRhLm5leHQuc3RhdGUuc3RhY2spO1xuICBpZiAoIXN0YWNrKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IHRvcCA9IHN0YWNrLmxlbmd0aCAtIDE7XG4gIHZhciBwYXJhbWV0ZXJzLCByZXR1cm5QYXJhbWV0ZXJzLCBhc3NpZ25tZW50cywgc3RvcmFnZVZhcnM7XG5cbiAgaWYgKCFub2RlKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgc3dpdGNoIChub2RlLm5vZGVUeXBlKSB7XG5cbiAgICBjYXNlIFwiRnVuY3Rpb25EZWZpbml0aW9uXCI6XG4gICAgICAvLyBzdGFjayBpcyBvbmx5IHJlYWR5IGZvciBpbnRlcnByZXRhdGlvbiBhZnRlciB0aGUgbGFzdCBzdGVwIG9mIGVhY2hcbiAgICAgIC8vIHNvdXJjZSByYW5nZVxuICAgICAgLy9cbiAgICAgIC8vIHRoZSBkYXRhIG1vZHVsZSBhbHdheXMgbG9va3MgYXQgdGhlIHJlc3VsdCBvZiBhIHBhcnRpY3VsYXIgb3Bjb2RlXG4gICAgICAvLyAoaS5lLiwgdGhlIGZvbGxvd2luZyB0cmFjZSBzdGVwJ3Mgc3RhY2svbWVtb3J5L3N0b3JhZ2UpLCBzbyB0aGlzXG4gICAgICAvLyBhc3NlcnRzIHRoYXQgdGhlIF9jdXJyZW50XyBvcGVyYXRpb24gaXMgdGhlIGZpbmFsIG9uZSBiZWZvcmVcbiAgICAgIC8vIHByb2NlZWRpbmdcbiAgICAgIGlmICghKHlpZWxkIHNlbGVjdChkYXRhLnZpZXdzLmF0TGFzdEluc3RydWN0aW9uRm9yU291cmNlUmFuZ2UpKSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgcGFyYW1ldGVycyA9IG5vZGUucGFyYW1ldGVycy5wYXJhbWV0ZXJzXG4gICAgICAgIC5tYXAoIChwLCBpKSA9PiBgJHtwb2ludGVyfS9wYXJhbWV0ZXJzL3BhcmFtZXRlcnMvJHtpfWAgKTtcblxuICAgICAgcmV0dXJuUGFyYW1ldGVycyA9IG5vZGUucmV0dXJuUGFyYW1ldGVycy5wYXJhbWV0ZXJzXG4gICAgICAgIC5tYXAoIChwLCBpKSA9PiBgJHtwb2ludGVyfS9yZXR1cm5QYXJhbWV0ZXJzL3BhcmFtZXRlcnMvJHtpfWAgKTtcblxuICAgICAgYXNzaWdubWVudHMgPSByZXR1cm5QYXJhbWV0ZXJzLmNvbmNhdChwYXJhbWV0ZXJzKS5yZXZlcnNlKClcbiAgICAgICAgLm1hcCggKHBvaW50ZXIpID0+IGpzb25wb2ludGVyLmdldCh0cmVlLCBwb2ludGVyKS5pZCApXG4gICAgICAgIC5tYXAoIChpZCwgaSkgPT4gKHsgW2lkXToge1wic3RhY2tcIjogdG9wIC0gaX0gfSkgKVxuICAgICAgICAucmVkdWNlKCAoYWNjLCBhc3NpZ25tZW50KSA9PiBPYmplY3QuYXNzaWduKGFjYywgYXNzaWdubWVudCksIHt9ICk7XG5cbiAgICAgIHlpZWxkIHB1dChhY3Rpb25zLmFzc2lnbih0cmVlSWQsIGFzc2lnbm1lbnRzKSk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgXCJDb250cmFjdERlZmluaXRpb25cIjpcbiAgICAgIGxldCBzdG9yYWdlVmFycyA9IHNjb3Blc1tub2RlLmlkXS52YXJpYWJsZXMgfHwgW107XG4gICAgICBsZXQgc2xvdCA9IDA7XG4gICAgICBsZXQgaW5kZXggPSBXT1JEX1NJWkUgLSAxOyAgLy8gY2F1c2UgbG93ZXItb3JkZXJcbiAgICAgIGRlYnVnKFwic3RvcmFnZSB2YXJzICVvXCIsIHN0b3JhZ2VWYXJzKTtcblxuICAgICAgbGV0IGFsbG9jYXRpb24gPSB1dGlscy5hbGxvY2F0ZURlY2xhcmF0aW9ucyhzdG9yYWdlVmFycywgZGVmaW5pdGlvbnMpO1xuICAgICAgYXNzaWdubWVudHMgPSBPYmplY3QuYXNzaWduKFxuICAgICAgICB7fSwgLi4uT2JqZWN0LmVudHJpZXMoYWxsb2NhdGlvbi5jaGlsZHJlbilcbiAgICAgICAgICAubWFwKCAoW2lkLCBzdG9yYWdlXSkgPT4gKHsgW2lkXToge3N0b3JhZ2V9IH0pIClcbiAgICAgICk7XG4gICAgICBkZWJ1ZyhcImFzc2lnbm1lbnRzICVPXCIsIGFzc2lnbm1lbnRzKTtcblxuICAgICAgeWllbGQgcHV0KGFjdGlvbnMuYXNzaWduKHRyZWVJZCwgYXNzaWdubWVudHMpKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBcIlZhcmlhYmxlRGVjbGFyYXRpb25cIjpcbiAgICAgIHlpZWxkIHB1dChhY3Rpb25zLmFzc2lnbih0cmVlSWQsIHtcbiAgICAgICAgW2pzb25wb2ludGVyLmdldCh0cmVlLCBwb2ludGVyKS5pZF06IHtcInN0YWNrXCI6IHRvcH1cbiAgICAgIH0pKTtcblxuICAgIGRlZmF1bHQ6XG4gICAgICBicmVhaztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIHNhZ2EgKCkge1xuICB5aWVsZCB0YWtlRXZlcnkoVElDSywgZnVuY3Rpb24qICgpIHtcbiAgICB0cnkge1xuICAgICAgeWllbGQgKnRpY2tTYWdhKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgZGVidWcoZSk7XG4gICAgfVxuICB9KTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgcHJlZml4TmFtZShcImRhdGFcIiwgc2FnYSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL2RhdGEvc2FnYXMvaW5kZXguanMiLCJleHBvcnQgY29uc3QgU0NPUEUgPSBcIlNDT1BFXCI7XG5leHBvcnQgZnVuY3Rpb24gc2NvcGUoaWQsIHBvaW50ZXIsIHBhcmVudElkLCBzb3VyY2VJZCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFNDT1BFLFxuICAgIGlkLCBwb2ludGVyLCBwYXJlbnRJZCwgc291cmNlSWRcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgREVDTEFSRSA9IFwiREVDTEFSRV9WQVJJQUJMRVwiO1xuZXhwb3J0IGZ1bmN0aW9uIGRlY2xhcmUobm9kZSkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IERFQ0xBUkUsXG4gICAgbm9kZVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBBU1NJR04gPSBcIkFTU0lHTlwiO1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2lnbihjb250ZXh0LCBhc3NpZ25tZW50cykge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IEFTU0lHTixcbiAgICBjb250ZXh0LCBhc3NpZ25tZW50c1xuICB9O1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9kYXRhL2FjdGlvbnMvaW5kZXguanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6dHJhY2U6c2FnYXNcIik7XG5cbmltcG9ydCB7IHRha2UsIHRha2VFdmVyeSwgcHV0LCBzZWxlY3QgfSBmcm9tIFwicmVkdXgtc2FnYS9lZmZlY3RzXCI7XG5pbXBvcnQgeyBwcmVmaXhOYW1lIH0gZnJvbSBcImxpYi9oZWxwZXJzXCI7XG5cbmltcG9ydCAqIGFzIGFjdGlvbnMgZnJvbSBcIi4uL2FjdGlvbnNcIjtcblxuaW1wb3J0IHRyYWNlIGZyb20gXCIuLi9zZWxlY3RvcnNcIjtcblxuZnVuY3Rpb24gKndhaXRGb3JUcmFjZSgpIHtcbiAgbGV0IHtzdGVwc30gPSB5aWVsZCB0YWtlKGFjdGlvbnMuU0FWRV9TVEVQUyk7XG5cbiAgbGV0IGFkZHJlc3NlcyA9IFtcbiAgICAuLi5uZXcgU2V0KFxuICAgICAgc3RlcHNcbiAgICAgICAgLmZpbHRlciggKHtvcH0pID0+IG9wID09IFwiQ0FMTFwiIHx8IG9wID09IFwiREVMRUdBVEVDQUxMXCIgKVxuICAgICAgICAubWFwKCAoe3N0YWNrfSkgPT4gXCIweFwiICsgc3RhY2tbc3RhY2subGVuZ3RoIC0gMl0uc3Vic3RyaW5nKDI0KSApXG4gICAgKVxuICBdO1xuXG4gIHlpZWxkIHB1dChhY3Rpb25zLnJlY2VpdmVBZGRyZXNzZXMoYWRkcmVzc2VzKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiAqYWR2YW5jZSgpIHtcbiAgeWllbGQgcHV0KGFjdGlvbnMubmV4dCgpKTtcblxuICB5aWVsZCB0YWtlKGFjdGlvbnMuVE9DSyk7XG59XG5cbmZ1bmN0aW9uKiBuZXh0KCkge1xuICBsZXQgcmVtYWluaW5nID0geWllbGQgc2VsZWN0KHRyYWNlLnN0ZXBzUmVtYWluaW5nKTtcbiAgZGVidWcoXCJyZW1haW5pbmc6ICVvXCIsIHJlbWFpbmluZyk7XG4gIGxldCBzdGVwcyA9IHlpZWxkIHNlbGVjdCh0cmFjZS5zdGVwcyk7XG4gIGRlYnVnKFwidG90YWwgc3RlcHM6ICVvXCIsIHN0ZXBzLmxlbmd0aCk7XG5cbiAgaWYgKHJlbWFpbmluZyA+IDApIHtcbiAgICBkZWJ1ZyhcInB1dHRpbmcgVElDS1wiKTtcbiAgICAvLyB1cGRhdGVzIHN0YXRlIGZvciBjdXJyZW50IHN0ZXBcbiAgICB5aWVsZCBwdXQoYWN0aW9ucy50aWNrKCkpO1xuICAgIGRlYnVnKFwicHV0IFRJQ0tcIik7XG5cbiAgICByZW1haW5pbmctLTsgLy8gbG9jYWwgdXBkYXRlLCBqdXN0IGZvciBjb252ZW5pZW5jZVxuICB9XG5cbiAgaWYgKHJlbWFpbmluZykge1xuICAgIGRlYnVnKFwicHV0dGluZyBUT0NLXCIpO1xuICAgIC8vIHVwZGF0ZXMgc3RlcCB0byBuZXh0IHN0ZXAgaW4gdHJhY2VcbiAgICB5aWVsZCBwdXQoYWN0aW9ucy50b2NrKCkpO1xuICAgIGRlYnVnKFwicHV0IFRPQ0tcIik7XG5cbiAgfSBlbHNlIHtcblxuICAgIHlpZWxkIHB1dChhY3Rpb25zLmVuZFRyYWNlKCkpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiogd2FpdCgpIHtcbiAgeWllbGQgdGFrZShhY3Rpb25zLkVORF9PRl9UUkFDRSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiAqcHJvY2Vzc1RyYWNlKHRyYWNlKSB7XG4gIHlpZWxkIHB1dChhY3Rpb25zLnNhdmVTdGVwcyh0cmFjZSkpO1xuXG4gIGxldCB7YWRkcmVzc2VzfSA9IHlpZWxkIHRha2UoYWN0aW9ucy5SRUNFSVZFX0FERFJFU1NFUyk7XG4gIGRlYnVnKFwicmVjZWl2ZWQgYWRkcmVzc2VzXCIpO1xuXG4gIHJldHVybiBhZGRyZXNzZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiogc2FnYSgpIHtcbiAgLy8gd2FpdCBmb3IgdHJhY2UgdG8gYmUgZGVmaW5lZFxuICB5aWVsZCAqd2FpdEZvclRyYWNlKCk7XG5cbiAgeWllbGQgdGFrZUV2ZXJ5KGFjdGlvbnMuTkVYVCwgbmV4dCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHByZWZpeE5hbWUoXCJ0cmFjZVwiLCBzYWdhKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvdHJhY2Uvc2FnYXMvaW5kZXguanMiLCJleHBvcnQgY29uc3QgQUREX1NPVVJDRSA9IFwiU09MSURJVFlfQUREX1NPVVJDRVwiO1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFNvdXJjZShzb3VyY2UsIHNvdXJjZVBhdGgsIGFzdCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IEFERF9TT1VSQ0UsXG4gICAgc291cmNlLCBzb3VyY2VQYXRoLCBhc3RcbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IEFERF9TT1VSQ0VNQVAgPSBcIlNPTElESVRZX0FERF9TT1VSQ0VNQVBcIjtcbmV4cG9ydCBmdW5jdGlvbiBhZGRTb3VyY2VNYXAoYmluYXJ5LCBzb3VyY2VNYXApIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBBRERfU09VUkNFTUFQLFxuICAgIGJpbmFyeSwgc291cmNlTWFwXG4gIH07XG59XG5cblxuZXhwb3J0IGNvbnN0IEpVTVAgPSBcIkpVTVBcIjtcbmV4cG9ydCBmdW5jdGlvbiBqdW1wKGp1bXBEaXJlY3Rpb24pIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBKVU1QLFxuICAgIGp1bXBEaXJlY3Rpb25cbiAgfTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvc29saWRpdHkvYWN0aW9ucy9pbmRleC5qcyIsImV4cG9ydCBjb25zdCBBRERfQ09OVEVYVCA9IFwiRVZNX0FERF9DT05URVhUXCI7XG5leHBvcnQgZnVuY3Rpb24gYWRkQ29udGV4dChjb250cmFjdE5hbWUsIGJpbmFyeSkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IEFERF9DT05URVhULFxuICAgIGNvbnRyYWN0TmFtZSwgYmluYXJ5XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IEFERF9JTlNUQU5DRSA9IFwiRVZNX0FERF9JTlNUQU5DRVwiO1xuZXhwb3J0IGZ1bmN0aW9uIGFkZEluc3RhbmNlKGFkZHJlc3MsIGNvbnRleHQsIGJpbmFyeSkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IEFERF9JTlNUQU5DRSxcbiAgICBhZGRyZXNzLCBjb250ZXh0LCBiaW5hcnlcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgQ0FMTCA9IFwiQ0FMTFwiO1xuZXhwb3J0IGZ1bmN0aW9uIGNhbGwoYWRkcmVzcykge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IENBTEwsXG4gICAgYWRkcmVzc1xuICB9O1xufVxuXG5leHBvcnQgY29uc3QgQ1JFQVRFID0gXCJDUkVBVEVcIjtcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGUoYmluYXJ5KSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogQ1JFQVRFLFxuICAgIGJpbmFyeVxuICB9O1xufVxuXG5leHBvcnQgY29uc3QgUkVUVVJOID0gXCJSRVRVUk5cIjtcbmV4cG9ydCBmdW5jdGlvbiByZXR1cm5DYWxsKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFJFVFVSTlxuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL2V2bS9hY3Rpb25zL2luZGV4LmpzIiwiaW1wb3J0IGRlYnVnTW9kdWxlIGZyb20gXCJkZWJ1Z1wiO1xuY29uc3QgZGVidWcgPSBkZWJ1Z01vZHVsZShcImRlYnVnZ2VyOnNlc3Npb246c2VsZWN0b3JzXCIpO1xuXG5pbXBvcnQgeyBjcmVhdGVTZWxlY3RvclRyZWUsIGNyZWF0ZUxlYWYgfSBmcm9tIFwicmVzZWxlY3QtdHJlZVwiO1xuXG5pbXBvcnQgZXZtIGZyb20gXCJsaWIvZXZtL3NlbGVjdG9yc1wiO1xuaW1wb3J0IHNvbGlkaXR5IGZyb20gXCJsaWIvc29saWRpdHkvc2VsZWN0b3JzXCI7XG5cbmNvbnN0IHNlc3Npb24gPSBjcmVhdGVTZWxlY3RvclRyZWUoe1xuICAvKipcbiAgICogc2Vzc2lvbi5pbmZvXG4gICAqL1xuICBpbmZvOiB7XG5cbiAgICAvKipcbiAgICAgKiBzZXNzaW9uLmluZm8uYWZmZWN0ZWRJbnN0YW5jZXNcbiAgICAgKi9cbiAgICBhZmZlY3RlZEluc3RhbmNlczogY3JlYXRlTGVhZihcbiAgICAgIFtldm0uaW5mby5pbnN0YW5jZXMsIGV2bS5pbmZvLmNvbnRleHRzLCBzb2xpZGl0eS5pbmZvLnNvdXJjZXMsIHNvbGlkaXR5LmluZm8uc291cmNlTWFwc10sXG5cbiAgICAgIChpbnN0YW5jZXMsIGNvbnRleHRzLCBzb3VyY2VzLCBzb3VyY2VNYXBzKSA9PiBPYmplY3QuYXNzaWduKHt9LFxuICAgICAgICAuLi5PYmplY3QuZW50cmllcyhpbnN0YW5jZXMpLm1hcChcbiAgICAgICAgICAoW2FkZHJlc3MsIHtjb250ZXh0fV0pID0+IHtcbiAgICAgICAgICAgIGxldCB7IGNvbnRyYWN0TmFtZSwgYmluYXJ5IH0gPSBjb250ZXh0c1tjb250ZXh0XTtcbiAgICAgICAgICAgIGxldCB7IHNvdXJjZU1hcCB9ID0gc291cmNlTWFwc1tjb250ZXh0XTtcblxuICAgICAgICAgICAgbGV0IHsgc291cmNlIH0gPSBzb3VyY2VNYXAgP1xuICAgICAgICAgICAgICAvLyBsb29rIGZvciBzb3VyY2UgSUQgYmV0d2VlbiBzZWNvbmQgYW5kIHRoaXJkIGNvbG9ucyAoSEFDSylcbiAgICAgICAgICAgICAgc291cmNlc1tzb3VyY2VNYXAubWF0Y2goL15bXjpdKzpbXjpdKzooW146XSspOi8pWzFdXSA6XG4gICAgICAgICAgICAgIHt9O1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBbYWRkcmVzc106IHtcbiAgICAgICAgICAgICAgICBjb250cmFjdE5hbWUsIHNvdXJjZSwgYmluYXJ5XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICApXG4gICAgICApXG4gICAgKVxuICB9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgc2Vzc2lvbjtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvc2Vzc2lvbi9zZWxlY3RvcnMvaW5kZXguanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwidGVzdDpkYXRhOmRlY29kZVwiKTtcblxuaW1wb3J0IEdhbmFjaGUgZnJvbSBcImdhbmFjaGUtY2xpXCI7XG5pbXBvcnQgV2ViMyBmcm9tIFwid2ViM1wiO1xuaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSBcImNoYWlcIjtcblxuaW1wb3J0IHsgcHJlcGFyZUNvbnRyYWN0cyB9IGZyb20gXCJ0ZXN0L2hlbHBlcnNcIjtcblxuaW1wb3J0IERlYnVnZ2VyIGZyb20gXCJsaWIvZGVidWdnZXJcIjtcblxuaW1wb3J0IHsgY2xlYW5CaWdOdW1iZXJzIH0gZnJvbSBcImxpYi9kYXRhL2RlY29kZS91dGlsc1wiO1xuXG5pbXBvcnQgZGF0YSBmcm9tIFwibGliL2RhdGEvc2VsZWN0b3JzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiAqZ2VuZXJhdGVVaW50cygpIHtcbiAgbGV0IHggPSAwO1xuICB3aGlsZSAodHJ1ZSkge1xuICAgIHlpZWxkIHg7XG4gICAgeCsrO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbnRyYWN0TmFtZSh0ZXN0TmFtZSkge1xuICByZXR1cm4gdGVzdE5hbWUucmVwbGFjZSgvIC9nLCBcIlwiKTtcbn1cblxuZnVuY3Rpb24gZmlsZU5hbWUodGVzdE5hbWUpIHtcbiAgcmV0dXJuIGAke2NvbnRyYWN0TmFtZSh0ZXN0TmFtZSl9LnNvbGA7XG59XG5cblxuZnVuY3Rpb24gZ2VuZXJhdGVUZXN0cyhmaXh0dXJlcykge1xuICBmb3IgKGxldCB7IG5hbWUsIHZhbHVlOiBleHBlY3RlZCB9IG9mIGZpeHR1cmVzKSB7XG4gICAgaXQoYGNvcnJlY3RseSBkZWNvZGVzICR7bmFtZX1gLFxuICAgICAgKCkgPT4geyBhc3NlcnQuZGVlcEVxdWFsKHRoaXMuZGVjb2RlKG5hbWUpLCBleHBlY3RlZCk7IH1cbiAgICApO1xuICB9XG59XG5cbmZ1bmN0aW9uIGxhc3RTdGF0ZW1lbnRMaW5lKHNvdXJjZSkge1xuICBjb25zdCBsaW5lcyA9IHNvdXJjZS5zcGxpdChcIlxcblwiKTtcbiAgZm9yIChsZXQgaSA9IGxpbmVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgbGV0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICBpZiAobGluZS5pbmRleE9mKFwiO1wiKSAhPSAtMSkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICB9XG59XG5cblxuYXN5bmMgZnVuY3Rpb24gcHJlcGFyZURlYnVnZ2VyKHRlc3ROYW1lLCBzb3VyY2VzKSB7XG4gIGNvbnN0IHByb3ZpZGVyID0gR2FuYWNoZS5wcm92aWRlcih7c2VlZDogXCJkZWJ1Z2dlclwiLCBnYXNMaW1pdDogNzAwMDAwMH0pO1xuICBjb25zdCB3ZWIzID0gbmV3IFdlYjMocHJvdmlkZXIpO1xuXG4gIGxldCB7IGFic3RyYWN0aW9ucywgYXJ0aWZhY3RzOiBjb250cmFjdHMsIGZpbGVzIH0gPVxuICAgIGF3YWl0IHByZXBhcmVDb250cmFjdHMocHJvdmlkZXIsIHNvdXJjZXMpO1xuXG4gIGxldCBpbnN0YW5jZSA9IGF3YWl0IGFic3RyYWN0aW9uc1tjb250cmFjdE5hbWUodGVzdE5hbWUpXS5kZXBsb3llZCgpO1xuICBsZXQgcmVjZWlwdCA9IGF3YWl0IGluc3RhbmNlLnJ1bigpO1xuICBsZXQgdHhIYXNoID0gcmVjZWlwdC50eDtcblxuICBsZXQgYnVnZ2VyID0gYXdhaXQgRGVidWdnZXIuZm9yVHgodHhIYXNoLCB7IHByb3ZpZGVyLCBmaWxlcywgY29udHJhY3RzIH0pO1xuXG4gIGxldCBzZXNzaW9uID0gYnVnZ2VyLmNvbm5lY3QoKTtcblxuICBsZXQgYnJlYWtwb2ludCA9IHtcbiAgICBhZGRyZXNzOiBpbnN0YW5jZS5hZGRyZXNzLFxuICAgIGxpbmU6IGxhc3RTdGF0ZW1lbnRMaW5lKHNvdXJjZXNbZmlsZU5hbWUodGVzdE5hbWUpXSlcbiAgfTtcblxuICBzZXNzaW9uLmNvbnRpbnVlVW50aWwoYnJlYWtwb2ludCk7XG5cbiAgcmV0dXJuIHNlc3Npb247XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldERlY29kZShzZXNzaW9uKSB7XG4gIGNvbnN0IGRlZmluaXRpb25zID0gc2Vzc2lvbi52aWV3KGRhdGEuY3VycmVudC5pZGVudGlmaWVycy5kZWZpbml0aW9ucyk7XG4gIGNvbnN0IHJlZnMgPSBzZXNzaW9uLnZpZXcoZGF0YS5jdXJyZW50LmlkZW50aWZpZXJzLnJlZnMpO1xuXG4gIGNvbnN0IGRlY29kZSA9IHNlc3Npb24udmlldyhkYXRhLnZpZXdzLmRlY29kZXIpO1xuICByZXR1cm4gKG5hbWUpID0+IGNsZWFuQmlnTnVtYmVycyhcbiAgICBkZWNvZGUoZGVmaW5pdGlvbnNbbmFtZV0sIHJlZnNbbmFtZV0pXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXNjcmliZURlY29kaW5nKHRlc3ROYW1lLCBmaXh0dXJlcywgc2VsZWN0b3IsIGdlbmVyYXRlU291cmNlKSB7XG4gIGNvbnN0IHNvdXJjZXMgPSB7XG4gICAgW2ZpbGVOYW1lKHRlc3ROYW1lKV06IGdlbmVyYXRlU291cmNlKGNvbnRyYWN0TmFtZSh0ZXN0TmFtZSkpXG4gIH07XG5cbiAgZGVzY3JpYmUodGVzdE5hbWUsIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMudGltZW91dCgzMDAwMCk7XG5cbiAgICBiZWZvcmUoXCJydW5zIGFuZCBvYnNlcnZlcyBkZWJ1Z2dlclwiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJlcGFyZURlYnVnZ2VyKHRlc3ROYW1lLCBzb3VyY2VzKTtcbiAgICAgIHRoaXMuZGVjb2RlID0gYXdhaXQgZ2V0RGVjb2RlKHNlc3Npb24pO1xuXG4gICAgICBpZiAoc2VsZWN0b3IpIHtcbiAgICAgICAgZGVidWcoXCJzZWxlY3RvciAlT1wiLCBzZXNzaW9uLnZpZXcoc2VsZWN0b3IpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGdlbmVyYXRlVGVzdHMuYmluZCh0aGlzKShmaXh0dXJlcyk7XG4gIH0pO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHRlc3QvZGF0YS9kZWNvZGUvaGVscGVycy5qcyIsIi8vIHJ1bnRpbWUgaGVscGVyXG5mdW5jdGlvbiBpbk1hbmlmZXN0KGlkKSB7IHJldHVybiBnbG9iYWwuX193ZWJwYWNrTWFuaWZlc3RfXy5pbmRleE9mKGlkKSA+PSAwO31cbmZ1bmN0aW9uIHJ1bihpZCkgeyBfX3dlYnBhY2tfcmVxdWlyZV9fKGlkKTt9XG5cbi8vIG1vZHVsZXMgdG8gZXhlY3V0ZSBnb2VzIGhlcmVcbnZhciBpZHMgPSBbXG5yZXF1aXJlLnJlc29sdmUoXCIuLi8uLi8uLi9wYWNrYWdlcy90cnVmZmxlLWRlYnVnZ2VyL3Rlc3QvYXN0LmpzXCIpLHJlcXVpcmUucmVzb2x2ZShcIi4uLy4uLy4uL3BhY2thZ2VzL3RydWZmbGUtZGVidWdnZXIvdGVzdC9jb250ZXh0LmpzXCIpLHJlcXVpcmUucmVzb2x2ZShcIi4uLy4uLy4uL3BhY2thZ2VzL3RydWZmbGUtZGVidWdnZXIvdGVzdC9kYXRhL2RlY29kZS9kZWNvZGluZy5qc1wiKSxyZXF1aXJlLnJlc29sdmUoXCIuLi8uLi8uLi9wYWNrYWdlcy90cnVmZmxlLWRlYnVnZ2VyL3Rlc3QvZGF0YS9kZWNvZGUvaGVscGVycy5qc1wiKSxyZXF1aXJlLnJlc29sdmUoXCIuLi8uLi8uLi9wYWNrYWdlcy90cnVmZmxlLWRlYnVnZ2VyL3Rlc3QvZGF0YS9kZWNvZGUvdXRpbHMuanNcIikscmVxdWlyZS5yZXNvbHZlKFwiLi4vLi4vLi4vcGFja2FnZXMvdHJ1ZmZsZS1kZWJ1Z2dlci90ZXN0L2V2bS5qc1wiKSxyZXF1aXJlLnJlc29sdmUoXCIuLi8uLi8uLi9wYWNrYWdlcy90cnVmZmxlLWRlYnVnZ2VyL3Rlc3QvaGVscGVycy5qc1wiKSxyZXF1aXJlLnJlc29sdmUoXCIuLi8uLi8uLi9wYWNrYWdlcy90cnVmZmxlLWRlYnVnZ2VyL3Rlc3Qvc29saWRpdHkuanNcIilcbl07XG5cbmlkcy5maWx0ZXIoaW5NYW5pZmVzdCkuZm9yRWFjaChydW4pXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gL1VzZXJzL2duaWRhbi9zcmMvd29yay90cnVmZmxlL25vZGVfbW9kdWxlcy9tb2NoYS13ZWJwYWNrL2xpYi9lbnRyeS5qc1xuLy8gbW9kdWxlIGlkID0gNDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IGRlYnVnTW9kdWxlIGZyb20gXCJkZWJ1Z1wiO1xuY29uc3QgZGVidWcgPSBkZWJ1Z01vZHVsZShcInRlc3Q6YXN0XCIpO1xuXG5pbXBvcnQgeyBhc3NlcnQgfSBmcm9tIFwiY2hhaVwiO1xuXG5pbXBvcnQgR2FuYWNoZSBmcm9tIFwiZ2FuYWNoZS1jbGlcIjtcbmltcG9ydCBXZWIzIGZyb20gXCJ3ZWIzXCI7XG5cbmltcG9ydCB7IHByZXBhcmVDb250cmFjdHMgfSBmcm9tIFwiLi9oZWxwZXJzXCI7XG5pbXBvcnQgRGVidWdnZXIgZnJvbSBcImxpYi9kZWJ1Z2dlclwiO1xuXG5pbXBvcnQgYXN0IGZyb20gXCJsaWIvYXN0L3NlbGVjdG9yc1wiO1xuaW1wb3J0IHNvbGlkaXR5IGZyb20gXCJsaWIvc29saWRpdHkvc2VsZWN0b3JzXCI7XG5cbmltcG9ydCB7IGdldFJhbmdlLCBmaW5kUmFuZ2UsIHJhbmdlTm9kZXMgfSBmcm9tIFwibGliL2FzdC9tYXBcIjtcblxuY29uc3QgX19WQVJJQUJMRVMgPSBgXG5wcmFnbWEgc29saWRpdHkgXjAuNC4xODtcblxuY29udHJhY3QgVmFyaWFibGVzIHtcbiAgZXZlbnQgUmVzdWx0KHVpbnQyNTYgcmVzdWx0KTtcblxuICB1aW50MjU2IHF1eDtcbiAgc3RyaW5nIHF1dXg7XG5cbiAgZnVuY3Rpb24gc3RhY2sodWludDI1NiBmb28pIHB1YmxpYyByZXR1cm5zICh1aW50MjU2KSB7XG4gICAgdWludDI1NiBiYXIgPSBmb28gKyAxO1xuICAgIHVpbnQyNTYgYmF6ID0gaW5uZXJTdGFjayhiYXIpO1xuXG4gICAgYmF6ICs9IDQ7XG5cbiAgICBxdXggPSBiYXo7XG5cbiAgICBSZXN1bHQoYmF6KTtcblxuICAgIHJldHVybiBiYXo7XG4gIH1cblxuICBmdW5jdGlvbiBpbm5lclN0YWNrKHVpbnQyNTYgYmF6KSBwdWJsaWMgcmV0dXJucyAodWludDI1Nikge1xuICAgIHVpbnQyNTYgYmFyID0gYmF6ICsgMjtcbiAgICByZXR1cm4gYmFyO1xuICB9XG59XG5gO1xuXG5cbmxldCBzb3VyY2VzID0ge1xuICBcIlZhcmlhYmxlcy5zb2xcIjogX19WQVJJQUJMRVNcbn1cblxuZGVzY3JpYmUoXCJBU1RcIiwgZnVuY3Rpb24oKSB7XG4gIHZhciBwcm92aWRlcjtcbiAgdmFyIHdlYjM7XG5cbiAgdmFyIGFic3RyYWN0aW9ucztcbiAgdmFyIGFydGlmYWN0cztcbiAgdmFyIGZpbGVzO1xuXG4gIGJlZm9yZShcIkNyZWF0ZSBQcm92aWRlclwiLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICBwcm92aWRlciA9IEdhbmFjaGUucHJvdmlkZXIoe3NlZWQ6IFwiZGVidWdnZXJcIiwgZ2FzTGltaXQ6IDcwMDAwMDB9KTtcbiAgICB3ZWIzID0gbmV3IFdlYjMocHJvdmlkZXIpO1xuICB9KTtcblxuICBiZWZvcmUoXCJQcmVwYXJlIGNvbnRyYWN0cyBhbmQgYXJ0aWZhY3RzXCIsIGFzeW5jIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMudGltZW91dCgzMDAwMCk7XG5cbiAgICBsZXQgcHJlcGFyZWQgPSBhd2FpdCBwcmVwYXJlQ29udHJhY3RzKHByb3ZpZGVyLCBzb3VyY2VzKVxuICAgIGFic3RyYWN0aW9ucyA9IHByZXBhcmVkLmFic3RyYWN0aW9ucztcbiAgICBhcnRpZmFjdHMgPSBwcmVwYXJlZC5hcnRpZmFjdHM7XG4gICAgZmlsZXMgPSBwcmVwYXJlZC5maWxlcztcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJOb2RlIHBvaW50ZXJcIiwgZnVuY3Rpb24oKSB7XG4gICAgaXQoXCJ0cmF2ZXJzZXNcIiwgYXN5bmMgZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLnRpbWVvdXQoMCk7XG4gICAgICBsZXQgaW5zdGFuY2UgPSBhd2FpdCBhYnN0cmFjdGlvbnMuVmFyaWFibGVzLmRlcGxveWVkKCk7XG4gICAgICBsZXQgcmVjZWlwdCA9IGF3YWl0IGluc3RhbmNlLnN0YWNrKDQpO1xuICAgICAgbGV0IHR4SGFzaCA9IHJlY2VpcHQudHg7XG5cbiAgICAgIGxldCBidWdnZXIgPSBhd2FpdCBEZWJ1Z2dlci5mb3JUeCh0eEhhc2gsIHtcbiAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgIGZpbGVzLFxuICAgICAgICBjb250cmFjdHM6IGFydGlmYWN0c1xuICAgICAgfSk7XG5cbiAgICAgIGxldCBzZXNzaW9uID0gYnVnZ2VyLmNvbm5lY3QoKTtcbiAgICAgIGRlYnVnKFwiYXN0OiAlT1wiLCBzZXNzaW9uLnZpZXcoYXN0LmN1cnJlbnQudHJlZSkpO1xuXG4gICAgICBkbyB7XG4gICAgICAgIGxldCB7IHN0YXJ0LCBsZW5ndGggfSA9IHNlc3Npb24udmlldyhzb2xpZGl0eS5jdXJyZW50LnNvdXJjZVJhbmdlKTtcbiAgICAgICAgbGV0IGVuZCA9IHN0YXJ0ICsgbGVuZ3RoO1xuXG4gICAgICAgIGxldCBub2RlID0gc2Vzc2lvbi52aWV3KGFzdC5jdXJyZW50Lm5vZGUpO1xuXG4gICAgICAgIGxldCBbIG5vZGVTdGFydCwgbm9kZUxlbmd0aCBdID0gZ2V0UmFuZ2Uobm9kZSk7XG4gICAgICAgIGxldCBub2RlRW5kID0gbm9kZVN0YXJ0ICsgbm9kZUxlbmd0aDtcblxuICAgICAgICBsZXQgcG9pbnRlciA9IHNlc3Npb24udmlldyhhc3QuY3VycmVudC5wb2ludGVyKTtcblxuICAgICAgICBhc3NlcnQuaXNBdE1vc3QoXG4gICAgICAgICAgbm9kZVN0YXJ0LCBzdGFydCxcbiAgICAgICAgICBgTm9kZSAke3BvaW50ZXJ9IGF0IHNob3VsZCBub3QgYmVnaW4gYWZ0ZXIgaW5zdHJ1Y3Rpb24gc291cmNlIHJhbmdlYFxuICAgICAgICApO1xuICAgICAgICBhc3NlcnQuaXNBdExlYXN0KFxuICAgICAgICAgIG5vZGVFbmQsIGVuZCxcbiAgICAgICAgICBgTm9kZSAke3BvaW50ZXJ9IHNob3VsZCBub3QgZW5kIGFmdGVyIHNvdXJjZWBcbiAgICAgICAgKTtcblxuICAgICAgICBzZXNzaW9uLnN0ZXBOZXh0KCk7XG4gICAgICB9IHdoaWxlKCFzZXNzaW9uLmZpbmlzaGVkKTtcblxuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHRlc3QvYXN0LmpzIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicGF0aFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInBhdGhcIlxuLy8gbW9kdWxlIGlkID0gNDdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZnMtZXh0cmFcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJmcy1leHRyYVwiXG4vLyBtb2R1bGUgaWQgPSA0OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJhc3luY1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImFzeW5jXCJcbi8vIG1vZHVsZSBpZCA9IDQ5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInRydWZmbGUtd29ya2Zsb3ctY29tcGlsZVwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInRydWZmbGUtd29ya2Zsb3ctY29tcGlsZVwiXG4vLyBtb2R1bGUgaWQgPSA1MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJ0cnVmZmxlLWRlYnVnLXV0aWxzXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwidHJ1ZmZsZS1kZWJ1Zy11dGlsc1wiXG4vLyBtb2R1bGUgaWQgPSA1MVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJ0cnVmZmxlLWFydGlmYWN0b3JcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJ0cnVmZmxlLWFydGlmYWN0b3JcIlxuLy8gbW9kdWxlIGlkID0gNTJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwidHJ1ZmZsZS1taWdyYXRlXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwidHJ1ZmZsZS1taWdyYXRlXCJcbi8vIG1vZHVsZSBpZCA9IDUzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInRydWZmbGUtYm94XCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwidHJ1ZmZsZS1ib3hcIlxuLy8gbW9kdWxlIGlkID0gNTRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwidHJ1ZmZsZS1yZXNvbHZlclwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInRydWZmbGUtcmVzb2x2ZXJcIlxuLy8gbW9kdWxlIGlkID0gNTVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IGRlYnVnTW9kdWxlIGZyb20gXCJkZWJ1Z1wiO1xuY29uc3QgZGVidWcgPSBkZWJ1Z01vZHVsZShcImRlYnVnZ2VyOnNlc3Npb25cIik7XG5cbmltcG9ydCB0cmFjZSBmcm9tIFwibGliL3RyYWNlL3NlbGVjdG9yc1wiO1xuaW1wb3J0IGV2bSBmcm9tIFwibGliL2V2bS9zZWxlY3RvcnNcIjtcbmltcG9ydCBhc3QgZnJvbSBcImxpYi9hc3Qvc2VsZWN0b3JzXCI7XG5pbXBvcnQgc29saWRpdHkgZnJvbSBcImxpYi9zb2xpZGl0eS9zZWxlY3RvcnNcIjtcblxuaW1wb3J0IGNvbmZpZ3VyZVN0b3JlIGZyb20gXCJsaWIvc3RvcmVcIjtcblxuaW1wb3J0ICogYXMgY29udHJvbGxlciBmcm9tIFwibGliL2NvbnRyb2xsZXIvYWN0aW9uc1wiO1xuaW1wb3J0ICogYXMgYWN0aW9ucyBmcm9tIFwiLi9hY3Rpb25zXCI7XG5cbmltcG9ydCByb290U2FnYSBmcm9tIFwiLi9zYWdhc1wiO1xuaW1wb3J0IHJlZHVjZXIgZnJvbSBcIi4vcmVkdWNlcnNcIjtcblxuLyoqXG4gKiBEZWJ1Z2dlciBTZXNzaW9uXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlc3Npb24ge1xuICAvKipcbiAgICogQHBhcmFtIHtBcnJheTxDb250cmFjdD59IGNvbnRyYWN0cyAtIGNvbnRyYWN0IGRlZmluaXRpb25zXG4gICAqIEBwYXJhbSB7QXJyYXk8U3RyaW5nPn0gZmlsZXMgLSBhcnJheSBvZiBmaWxlbmFtZXMgZm9yIHNvdXJjZU1hcCBpbmRleGVzXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0eEhhc2ggLSB0cmFuc2FjdGlvbiBoYXNoXG4gICAqIEBwYXJhbSB7V2ViM1Byb3ZpZGVyfSBwcm92aWRlciAtIHdlYjMgcHJvdmlkZXJcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGNvbnN0cnVjdG9yKGNvbnRyYWN0cywgZmlsZXMsIHR4SGFzaCwgcHJvdmlkZXIpIHtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMuX3N0b3JlID0gY29uZmlndXJlU3RvcmUocmVkdWNlciwgcm9vdFNhZ2EpO1xuXG4gICAgbGV0IHsgY29udGV4dHMsIHNvdXJjZXMgfSA9IFNlc3Npb24ubm9ybWFsaXplKGNvbnRyYWN0cywgZmlsZXMpO1xuXG4gICAgLy8gcmVjb3JkIGNvbnRyYWN0c1xuICAgIHRoaXMuX3N0b3JlLmRpc3BhdGNoKGFjdGlvbnMucmVjb3JkQ29udHJhY3RzKGNvbnRleHRzLCBzb3VyY2VzKSk7XG5cbiAgICB0aGlzLl9zdG9yZS5kaXNwYXRjaChhY3Rpb25zLnN0YXJ0KHR4SGFzaCwgcHJvdmlkZXIpKTtcbiAgfVxuXG4gIHJlYWR5KCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSggKGFjY2VwdCwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLl9zdG9yZS5zdWJzY3JpYmUoICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2Vzc2lvbiA9PSBcIkFDVElWRVwiKSB7XG4gICAgICAgICAgYWNjZXB0KClcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5zdGF0ZS5zZXNzaW9uID09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICByZWplY3QodGhpcy5zdGF0ZS5zZXNzaW9uLmVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogU3BsaXQgdXAgYXJ0aWZhY3RzIGludG8gXCJjb250ZXh0c1wiIGFuZCBcInNvdXJjZXNcIiwgZGl2aWRpbmcgYXJ0aWZhY3RcbiAgICogZGF0YSBpbnRvIGFwcHJvcHJpYXRlIGJ1Y2tldHMuXG4gICAqXG4gICAqIE11bHRpcGxlIGNvbnRyYWN0cyBjYW4gYmUgZGVmaW5lZCBpbiB0aGUgc2FtZSBzb3VyY2UgZmlsZSwgYnV0IGhhdmVcbiAgICogZGlmZmVyZW50IGJ5dGVjb2Rlcy5cbiAgICpcbiAgICogVGhpcyBpdGVyYXRlcyBvdmVyIHRoZSBjb250cmFjdHMgYW5kIGNvbGxlY3RzIGJpbmFyaWVzIHNlcGFyYXRlbHlcbiAgICogZnJvbSBzb3VyY2VzLCB1c2luZyB0aGUgb3B0aW9uYWwgYGZpbGVzYCBhcmd1bWVudCB0byBmb3JjZVxuICAgKiBzb3VyY2Ugb3JkZXJpbmcuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzdGF0aWMgbm9ybWFsaXplKGNvbnRyYWN0cywgZmlsZXMgPSBudWxsKSB7XG4gICAgbGV0IHNvdXJjZXNCeVBhdGggPSB7fTtcbiAgICBsZXQgY29udGV4dHMgPSBbXTtcbiAgICBsZXQgc291cmNlcztcblxuICAgIGZvciAobGV0IGNvbnRyYWN0IG9mIGNvbnRyYWN0cykge1xuICAgICAgbGV0IHtcbiAgICAgICAgY29udHJhY3ROYW1lLFxuICAgICAgICBiaW5hcnksXG4gICAgICAgIHNvdXJjZU1hcCxcbiAgICAgICAgZGVwbG95ZWRCaW5hcnksXG4gICAgICAgIGRlcGxveWVkU291cmNlTWFwLFxuICAgICAgICBzb3VyY2VQYXRoLFxuICAgICAgICBzb3VyY2UsXG4gICAgICAgIGFzdFxuICAgICAgfSA9IGNvbnRyYWN0O1xuXG4gICAgICBzb3VyY2VzQnlQYXRoW3NvdXJjZVBhdGhdID0geyBzb3VyY2VQYXRoLCBzb3VyY2UsIGFzdCB9O1xuXG4gICAgICBpZiAoYmluYXJ5ICYmIGJpbmFyeSAhPSBcIjB4XCIpIHtcbiAgICAgICAgY29udGV4dHMucHVzaCh7XG4gICAgICAgICAgY29udHJhY3ROYW1lLFxuICAgICAgICAgIGJpbmFyeSxcbiAgICAgICAgICBzb3VyY2VNYXBcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChkZXBsb3llZEJpbmFyeSAmJiBkZXBsb3llZEJpbmFyeSAhPSBcIjB4XCIpIHtcbiAgICAgICAgY29udGV4dHMucHVzaCh7XG4gICAgICAgICAgY29udHJhY3ROYW1lLFxuICAgICAgICAgIGJpbmFyeTogZGVwbG95ZWRCaW5hcnksXG4gICAgICAgICAgc291cmNlTWFwOiBkZXBsb3llZFNvdXJjZU1hcFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWZpbGVzKSB7XG4gICAgICBzb3VyY2VzID0gT2JqZWN0LnZhbHVlcyhzb3VyY2VzQnlQYXRoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc291cmNlcyA9IGZpbGVzLm1hcChmaWxlID0+IHNvdXJjZXNCeVBhdGhbZmlsZV0pO1xuICAgIH1cblxuICAgIHJldHVybiB7IGNvbnRleHRzLCBzb3VyY2VzIH07XG4gIH1cblxuICBnZXQgc3RhdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3N0b3JlLmdldFN0YXRlKCk7XG4gIH1cblxuICB2aWV3KHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIHNlbGVjdG9yKHRoaXMuc3RhdGUpO1xuICB9XG5cbiAgZ2V0IGZpbmlzaGVkKCkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlLnNlc3Npb24gPT0gXCJGSU5JU0hFRFwiO1xuICB9XG5cbiAgZ2V0IGZhaWxlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5maW5pc2hlZCAmJiB0aGlzLnZpZXcoZXZtLmN1cnJlbnQuY2FsbHN0YWNrKS5sZW5ndGhcbiAgfVxuXG4gIGRpc3BhdGNoKGFjdGlvbikge1xuICAgIGlmICh0aGlzLmZpbmlzaGVkKSB7XG4gICAgICBkZWJ1ZyhcImZpbmlzaGVkOiBpbnRlcmNlcHRpbmcgYWN0aW9uICVvXCIsIGFjdGlvbik7XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLl9zdG9yZS5kaXNwYXRjaChhY3Rpb24pO1xuXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBpbnRlcnJ1cHQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGlzcGF0Y2goY29udHJvbGxlci5pbnRlcnJ1cHQoKSk7XG4gIH1cblxuICBhZHZhbmNlKCkge1xuICAgIHJldHVybiB0aGlzLmRpc3BhdGNoKGNvbnRyb2xsZXIuYWR2YW5jZSgpKTtcbiAgfVxuXG4gIHN0ZXBOZXh0KCkge1xuICAgIHJldHVybiB0aGlzLmRpc3BhdGNoKGNvbnRyb2xsZXIuc3RlcE5leHQoKSk7XG4gIH1cblxuICBzdGVwT3ZlcigpIHtcbiAgICByZXR1cm4gdGhpcy5kaXNwYXRjaChjb250cm9sbGVyLnN0ZXBPdmVyKCkpO1xuICB9XG5cbiAgc3RlcEludG8oKSB7XG4gICAgcmV0dXJuIHRoaXMuZGlzcGF0Y2goY29udHJvbGxlci5zdGVwSW50bygpKTtcbiAgfVxuXG4gIHN0ZXBPdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGlzcGF0Y2goY29udHJvbGxlci5zdGVwT3V0KCkpO1xuICB9XG5cbiAgY29udGludWVVbnRpbCguLi5icmVha3BvaW50cykge1xuICAgIHJldHVybiB0aGlzLmRpc3BhdGNoKGNvbnRyb2xsZXIuY29udGludWVVbnRpbCguLi5icmVha3BvaW50cykpO1xuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL3Nlc3Npb24vaW5kZXguanMiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L3ZhbHVlc1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvdmFsdWVzXCJcbi8vIG1vZHVsZSBpZCA9IDU3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInRydWZmbGUtc29saWRpdHktdXRpbHNcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJ0cnVmZmxlLXNvbGlkaXR5LXV0aWxzXCJcbi8vIG1vZHVsZSBpZCA9IDU4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInRydWZmbGUtY29kZS11dGlsc1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInRydWZmbGUtY29kZS11dGlsc1wiXG4vLyBtb2R1bGUgaWQgPSA1OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJub2RlLWludGVydmFsLXRyZWVcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJub2RlLWludGVydmFsLXRyZWVcIlxuLy8gbW9kdWxlIGlkID0gNjBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09IFwicHJvZHVjdGlvblwiKSB7XG4gIG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi4vcHJvZHVjdGlvblwiKTtcbn0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT0gXCJ0ZXN0XCIpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi90ZXN0XCIpO1xufSBlbHNlIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi9kZXZlbG9wbWVudFwiKTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvc3RvcmUvaW5kZXguanMiLCJpbXBvcnQgY29uZmlndXJlU3RvcmUgZnJvbSBcIi4vY29tbW9uXCI7XG5leHBvcnQgZGVmYXVsdCBjb25maWd1cmVTdG9yZTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvc3RvcmUvdGVzdC5qcyIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tIFwiZGVidWdcIjtcbmNvbnN0IGRlYnVnID0gZGVidWdNb2R1bGUoXCJkZWJ1Z2dlcjpzdG9yZTpjb21tb25cIik7XG5jb25zdCByZWR1eERlYnVnID0gZGVidWdNb2R1bGUoXCJkZWJ1Z2dlcjpyZWR1eFwiKTtcblxuaW1wb3J0IHsgY29tcG9zZSwgY3JlYXRlU3RvcmUsIGFwcGx5TWlkZGxld2FyZSB9IGZyb20gXCJyZWR1eFwiO1xuaW1wb3J0IGNyZWF0ZVNhZ2FNaWRkbGV3YXJlIGZyb20gXCJyZWR1eC1zYWdhXCI7XG5pbXBvcnQgY3JlYXRlTG9nZ2VyIGZyb20gXCJyZWR1eC1jbGktbG9nZ2VyXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBhYmJyZXZpYXRlVmFsdWVzKHZhbHVlLCBvcHRpb25zID0ge30sIGRlcHRoID0gMCkge1xuICBvcHRpb25zLnN0cmluZ0xpbWl0ID0gb3B0aW9ucy5zdHJpbmdMaW1pdCB8fCA2NjtcbiAgb3B0aW9ucy5hcnJheUxpbWl0ID0gb3B0aW9ucy5hcnJheUxpbWl0IHx8IDg7XG4gIG9wdGlvbnMucmVjdXJzZUxpbWl0ID0gb3B0aW9ucy5yZWN1cnNlTGltaXQgfHwgNDtcblxuICBpZiAoZGVwdGggPiBvcHRpb25zLnJlY3Vyc2VMaW1pdCkge1xuICAgIHJldHVybiBcIi4uLlwiO1xuICB9XG5cbiAgY29uc3QgcmVjdXJzZSA9IChjaGlsZCkgPT4gYWJicmV2aWF0ZVZhbHVlcyhjaGlsZCwgb3B0aW9ucywgZGVwdGggKyAxKTtcblxuICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgIGlmICh2YWx1ZS5sZW5ndGggPiBvcHRpb25zLmFycmF5TGltaXQpIHtcbiAgICAgIHZhbHVlID0gW1xuICAgICAgICAuLi52YWx1ZS5zbGljZSgwLCBvcHRpb25zLmFycmF5TGltaXQgLyAyKSxcbiAgICAgICAgXCIuLi5cIixcbiAgICAgICAgLi4udmFsdWUuc2xpY2UodmFsdWUubGVuZ3RoIC0gb3B0aW9ucy5hcnJheUxpbWl0IC8gMiArIDEpXG4gICAgICBdO1xuICAgIH1cblxuICAgIHJldHVybiB2YWx1ZS5tYXAocmVjdXJzZSk7XG5cbiAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LFxuICAgICAgLi4uT2JqZWN0LmVudHJpZXModmFsdWUpLm1hcChcbiAgICAgICAgKFtrLCB2XSkgPT4gKHsgW3JlY3Vyc2UoayldOiByZWN1cnNlKHYpIH0pXG4gICAgICApXG4gICAgKTtcblxuICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB2YWx1ZS5sZW5ndGggPiBvcHRpb25zLnN0cmluZ0xpbWl0KSB7XG4gICAgbGV0IGlubmVyID0gXCIuLi5cIjtcbiAgICBsZXQgZXh0cmFjdEFtb3VudCA9IChvcHRpb25zLnN0cmluZ0xpbWl0IC0gaW5uZXIubGVuZ3RoKSAvIDI7XG4gICAgbGV0IGxlYWRpbmcgPSB2YWx1ZS5zbGljZSgwLCBNYXRoLmNlaWwoZXh0cmFjdEFtb3VudCkpO1xuICAgIGxldCB0cmFpbGluZyA9IHZhbHVlLnNsaWNlKHZhbHVlLmxlbmd0aCAtIE1hdGguZmxvb3IoZXh0cmFjdEFtb3VudCkpO1xuICAgIHJldHVybiBgJHtsZWFkaW5nfSR7aW5uZXJ9JHt0cmFpbGluZ31gO1xuXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNvbmZpZ3VyZVN0b3JlIChyZWR1Y2VyLCBzYWdhLCBpbml0aWFsU3RhdGUsIGNvbXBvc2VFbmhhbmNlcnMpIHtcbiAgY29uc3Qgc2FnYU1pZGRsZXdhcmUgPSBjcmVhdGVTYWdhTWlkZGxld2FyZSgpO1xuXG4gIGlmICghY29tcG9zZUVuaGFuY2Vycykge1xuICAgIGNvbXBvc2VFbmhhbmNlcnMgPSBjb21wb3NlO1xuICB9XG5cbiAgY29uc3QgbG9nZ2VyTWlkZGxld2FyZSA9IGNyZWF0ZUxvZ2dlcih7XG4gICAgbG9nOiByZWR1eERlYnVnLFxuICAgIHN0YXRlVHJhbnNmb3JtZXI6IChzdGF0ZSkgPT4gYWJicmV2aWF0ZVZhbHVlcyhzdGF0ZSwge1xuICAgICAgYXJyYXlMaW1pdDogNCxcbiAgICAgIHJlY3Vyc2VMaW1pdDogM1xuICAgIH0pLFxuICAgIGFjdGlvblRyYW5zZm9ybWVyOiBhYmJyZXZpYXRlVmFsdWVzLFxuICB9KTtcblxuICBsZXQgc3RvcmUgPSBjcmVhdGVTdG9yZShcbiAgICByZWR1Y2VyLCBpbml0aWFsU3RhdGUsXG5cbiAgICBjb21wb3NlRW5oYW5jZXJzKFxuICAgICAgYXBwbHlNaWRkbGV3YXJlKFxuICAgICAgICBzYWdhTWlkZGxld2FyZSxcbiAgICAgICAgbG9nZ2VyTWlkZGxld2FyZVxuICAgICAgKVxuICAgIClcbiAgKTtcblxuICBzYWdhTWlkZGxld2FyZS5ydW4oc2FnYSk7XG5cbiAgcmV0dXJuIHN0b3JlO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9zdG9yZS9jb21tb24uanMiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWR1eC1zYWdhXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwicmVkdXgtc2FnYVwiXG4vLyBtb2R1bGUgaWQgPSA2NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWR1eC1jbGktbG9nZ2VyXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwicmVkdXgtY2xpLWxvZ2dlclwiXG4vLyBtb2R1bGUgaWQgPSA2NVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6c2Vzc2lvbjpzYWdhc1wiKTtcblxuaW1wb3J0IHsgY2FuY2VsLCBjYWxsLCBhbGwsIGZvcmssIHRha2UsIHB1dCB9IGZyb20gJ3JlZHV4LXNhZ2EvZWZmZWN0cyc7XG5cbmltcG9ydCB7IHByZWZpeE5hbWUgfSBmcm9tIFwibGliL2hlbHBlcnNcIjtcblxuaW1wb3J0ICogYXMgYXN0IGZyb20gXCJsaWIvYXN0L3NhZ2FzXCI7XG5pbXBvcnQgKiBhcyBjb250cm9sbGVyIGZyb20gXCJsaWIvY29udHJvbGxlci9zYWdhc1wiO1xuaW1wb3J0ICogYXMgc29saWRpdHkgZnJvbSBcImxpYi9zb2xpZGl0eS9zYWdhc1wiO1xuaW1wb3J0ICogYXMgZXZtIGZyb20gXCJsaWIvZXZtL3NhZ2FzXCI7XG5pbXBvcnQgKiBhcyB0cmFjZSBmcm9tIFwibGliL3RyYWNlL3NhZ2FzXCI7XG5pbXBvcnQgKiBhcyBkYXRhIGZyb20gXCJsaWIvZGF0YS9zYWdhc1wiO1xuaW1wb3J0ICogYXMgd2ViMyBmcm9tIFwibGliL3dlYjMvc2FnYXNcIjtcblxuaW1wb3J0ICogYXMgYWN0aW9ucyBmcm9tIFwiLi4vYWN0aW9uc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gKnNhZ2EgKCkge1xuICBkZWJ1ZyhcInN0YXJ0aW5nIGxpc3RlbmVyc1wiKTtcbiAgbGV0IGxpc3RlbmVycyA9IHlpZWxkICpmb3JrTGlzdGVuZXJzKCk7XG5cbiAgLy8gcmVjZWl2aW5nICYgc2F2aW5nIGNvbnRyYWN0cyBpbnRvIHN0YXRlXG4gIGRlYnVnKFwid2FpdGluZyBmb3IgY29udHJhY3QgaW5mb3JtYXRpb25cIik7XG4gIGxldCB7IGNvbnRleHRzLCBzb3VyY2VzIH0gPSB5aWVsZCB0YWtlKGFjdGlvbnMuUkVDT1JEX0NPTlRSQUNUUyk7XG5cbiAgZGVidWcoXCJyZWNvcmRpbmcgY29udHJhY3QgYmluYXJpZXNcIik7XG4gIHlpZWxkICpyZWNvcmRDb250ZXh0cyguLi5jb250ZXh0cyk7XG5cbiAgZGVidWcoXCJyZWNvcmRpbmcgY29udHJhY3Qgc291cmNlc1wiKTtcbiAgeWllbGQgKnJlY29yZFNvdXJjZXMoLi4uc291cmNlcyk7XG5cbiAgZGVidWcoXCJ3YWl0aW5nIGZvciBzdGFydFwiKTtcbiAgLy8gd2FpdCBmb3Igc3RhcnQgc2lnbmFsXG4gIGxldCB7dHhIYXNoLCBwcm92aWRlcn0gPSB5aWVsZCB0YWtlKGFjdGlvbnMuU1RBUlQpO1xuICBkZWJ1ZyhcInN0YXJ0aW5nXCIpO1xuXG4gIC8vIHByb2Nlc3MgdHJhbnNhY3Rpb25cbiAgZGVidWcoXCJmZXRjaGluZyB0cmFuc2FjdGlvbiBpbmZvXCIpO1xuICBsZXQgZXJyID0geWllbGQgKmZldGNoVHgodHhIYXNoLCBwcm92aWRlcik7XG4gIGlmIChlcnIpIHtcbiAgICBkZWJ1ZyhcImVycm9yICVvXCIsIGVycik7XG4gICAgeWllbGQgKmVycm9yKGVycik7XG5cbiAgfSBlbHNlIHtcbiAgICBkZWJ1ZyhcInZpc2l0aW5nIEFTVHNcIik7XG4gICAgLy8gdmlzaXQgYXN0c1xuICAgIHlpZWxkICphc3QudmlzaXRBbGwoKTtcblxuICAgIGRlYnVnKFwicmVhZHlpbmdcIik7XG4gICAgLy8gc2lnbmFsIHRoYXQgc3RlcHBpbmcgY2FuIGJlZ2luXG4gICAgeWllbGQgKnJlYWR5KCk7XG5cbiAgICBkZWJ1ZyhcIndhaXRpbmcgZm9yIHRyYWNlIEVPVFwiKTtcbiAgICAvLyB3YWl0IHVudGlsIHRyYWNlIGhpdHMgRU9UXG4gICAgeWllbGQgKnRyYWNlLndhaXQoKTtcblxuICAgIGRlYnVnKFwiZmluaXNoaW5nXCIpO1xuICAgIC8vIGZpbmlzaFxuICAgIHlpZWxkIHB1dChhY3Rpb25zLmZpbmlzaCgpKTtcbiAgfVxuXG4gIGRlYnVnKFwic3RvcHBpbmcgbGlzdGVuZXJzXCIpO1xuICB5aWVsZCBhbGwoXG4gICAgbGlzdGVuZXJzLm1hcCh0YXNrID0+IGNhbmNlbCh0YXNrKSlcbiAgKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgcHJlZml4TmFtZShcInNlc3Npb25cIiwgc2FnYSk7XG5cblxuZnVuY3Rpb24gKmZvcmtMaXN0ZW5lcnMoKSB7XG4gIHJldHVybiB5aWVsZCBhbGwoXG4gICAgW2FzdCwgY29udHJvbGxlciwgZGF0YSwgZXZtLCBzb2xpZGl0eSwgdHJhY2UsIHdlYjNdXG4gICAgICAubWFwKCBhcHAgPT4gZm9yayhhcHAuc2FnYSkgKVxuICApO1xufVxuXG5mdW5jdGlvbiogZmV0Y2hUeCh0eEhhc2gsIHByb3ZpZGVyKSB7XG4gIGxldCByZXN1bHQgPSB5aWVsZCAqd2ViMy5pbnNwZWN0VHJhbnNhY3Rpb24odHhIYXNoLCBwcm92aWRlcik7XG5cbiAgaWYgKHJlc3VsdC5lcnJvcikge1xuICAgIHJldHVybiByZXN1bHQuZXJyb3I7XG4gIH1cblxuICB5aWVsZCAqZXZtLmJlZ2luKHJlc3VsdCk7XG5cbiAgbGV0IGFkZHJlc3NlcyA9IHlpZWxkICp0cmFjZS5wcm9jZXNzVHJhY2UocmVzdWx0LnRyYWNlKTtcbiAgaWYgKHJlc3VsdC5hZGRyZXNzICYmIGFkZHJlc3Nlcy5pbmRleE9mKHJlc3VsdC5hZGRyZXNzKSA9PSAtMSkge1xuICAgIGFkZHJlc3Nlcy5wdXNoKHJlc3VsdC5hZGRyZXNzKTtcbiAgfVxuXG4gIGxldCBiaW5hcmllcyA9IHlpZWxkICp3ZWIzLm9idGFpbkJpbmFyaWVzKGFkZHJlc3Nlcyk7XG5cbiAgeWllbGQgYWxsKFxuICAgIGFkZHJlc3Nlcy5tYXAoIChhZGRyZXNzLCBpKSA9PiBjYWxsKHJlY29yZEluc3RhbmNlLCBhZGRyZXNzLCBiaW5hcmllc1tpXSkgKVxuICApO1xufVxuXG5mdW5jdGlvbiogcmVjb3JkQ29udGV4dHMoLi4uY29udGV4dHMpIHtcbiAgZm9yIChsZXQgeyBjb250cmFjdE5hbWUsIGJpbmFyeSwgc291cmNlTWFwIH0gb2YgY29udGV4dHMpIHtcbiAgICB5aWVsZCAqZXZtLmFkZENvbnRleHQoY29udHJhY3ROYW1lLCBiaW5hcnkpO1xuXG4gICAgaWYgKHNvdXJjZU1hcCkge1xuICAgICAgeWllbGQgKnNvbGlkaXR5LmFkZFNvdXJjZU1hcChiaW5hcnksIHNvdXJjZU1hcCk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uKiByZWNvcmRTb3VyY2VzKC4uLnNvdXJjZXMpIHtcbiAgZm9yIChsZXQgeyBzb3VyY2VQYXRoLCBzb3VyY2UsIGFzdCB9IG9mIHNvdXJjZXMpIHtcbiAgICB5aWVsZCAqc29saWRpdHkuYWRkU291cmNlKHNvdXJjZSwgc291cmNlUGF0aCwgYXN0KTtcbiAgfVxufVxuXG5mdW5jdGlvbiAqcmVjb3JkSW5zdGFuY2UoYWRkcmVzcywgYmluYXJ5KSB7XG4gIHlpZWxkICpldm0uYWRkSW5zdGFuY2UoYWRkcmVzcywgYmluYXJ5KTtcbn1cblxuZnVuY3Rpb24gKnJlYWR5KCkge1xuICB5aWVsZCBwdXQoYWN0aW9ucy5yZWFkeSgpKTtcbn1cblxuZnVuY3Rpb24gKmVycm9yKGVycikge1xuICB5aWVsZCBwdXQoYWN0aW9ucy5lcnJvcihlcnIpKTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvc2Vzc2lvbi9zYWdhcy9pbmRleC5qcyIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tIFwiZGVidWdcIjtcbmNvbnN0IGRlYnVnID0gZGVidWdNb2R1bGUoXCJkZWJ1Z2dlcjphc3Q6c2FnYXNcIik7XG5cbmltcG9ydCB7IGFsbCwgY2FsbCwgcmFjZSwgZm9yaywgam9pbiwgdGFrZSwgdGFrZUV2ZXJ5LCBwdXQsIHNlbGVjdCB9IGZyb20gXCJyZWR1eC1zYWdhL2VmZmVjdHNcIjtcblxuaW1wb3J0IHsgcHJlZml4TmFtZSB9IGZyb20gXCJsaWIvaGVscGVyc1wiO1xuXG5pbXBvcnQgKiBhcyBkYXRhIGZyb20gXCJsaWIvZGF0YS9zYWdhc1wiO1xuXG5pbXBvcnQgKiBhcyBhY3Rpb25zIGZyb20gXCIuLi9hY3Rpb25zXCI7XG5cbmltcG9ydCBhc3QgZnJvbSBcIi4uL3NlbGVjdG9yc1wiO1xuXG5cbmZ1bmN0aW9uICp3YWxrKHNvdXJjZUlkLCBub2RlLCBwb2ludGVyID0gXCJcIiwgcGFyZW50SWQgPSBudWxsKSB7XG4gIGRlYnVnKFwid2Fsa2luZyAlbyAlb1wiLCBwb2ludGVyLCBub2RlKTtcblxuICB5aWVsZCAqaGFuZGxlRW50ZXIoc291cmNlSWQsIG5vZGUsIHBvaW50ZXIsIHBhcmVudElkKTtcblxuICBpZiAobm9kZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgZm9yIChsZXQgW2ksIGNoaWxkXSBvZiBub2RlLmVudHJpZXMoKSkge1xuICAgICAgeWllbGQgY2FsbCh3YWxrLCBzb3VyY2VJZCwgY2hpbGQsIGAke3BvaW50ZXJ9LyR7aX1gLCBwYXJlbnRJZCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKG5vZGUgaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICBmb3IgKGxldCBba2V5LCBjaGlsZF0gb2YgT2JqZWN0LmVudHJpZXMobm9kZSkpIHtcbiAgICAgIHlpZWxkIGNhbGwod2Fsaywgc291cmNlSWQsIGNoaWxkLCBgJHtwb2ludGVyfS8ke2tleX1gLCBub2RlLmlkKTtcbiAgICB9XG4gIH1cblxuICB5aWVsZCAqaGFuZGxlRXhpdChzb3VyY2VJZCwgbm9kZSwgcG9pbnRlcik7XG59XG5cbmZ1bmN0aW9uICpoYW5kbGVFbnRlcihzb3VyY2VJZCwgbm9kZSwgcG9pbnRlciwgcGFyZW50SWQpIHtcbiAgaWYgKCEobm9kZSBpbnN0YW5jZW9mIE9iamVjdCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBkZWJ1ZyhcImVudGVyaW5nICVzXCIsIHBvaW50ZXIpO1xuXG4gIGlmIChub2RlLmlkICE9PSB1bmRlZmluZWQpIHtcbiAgICBkZWJ1ZyhcIiVzIHJlY29yZGluZyBzY29wZSAlc1wiLCBwb2ludGVyLCBub2RlLmlkKTtcbiAgICB5aWVsZCAqZGF0YS5zY29wZShub2RlLmlkLCBwb2ludGVyLCBwYXJlbnRJZCwgc291cmNlSWQpO1xuICB9XG5cbiAgc3dpdGNoIChub2RlLm5vZGVUeXBlKSB7XG4gICAgY2FzZSBcIlZhcmlhYmxlRGVjbGFyYXRpb25cIjpcbiAgICAgIGRlYnVnKFwiJXMgcmVjb3JkaW5nIHZhcmlhYmxlICVvXCIsIHBvaW50ZXIsIG5vZGUpO1xuICAgICAgeWllbGQgKmRhdGEuZGVjbGFyZShub2RlKTtcbiAgICAgIGJyZWFrO1xuICB9XG59XG5cbmZ1bmN0aW9uICpoYW5kbGVFeGl0KHNvdXJjZUlkLCBub2RlLCBwb2ludGVyKSB7XG4gIGRlYnVnKFwiZXhpdGluZyAlc1wiLCBwb2ludGVyKTtcblxuICAvLyBuby1vcCByaWdodCBub3dcbn1cblxuZnVuY3Rpb24gKndhbGtTYWdhKHtzb3VyY2VJZCwgYXN0fSkge1xuICB5aWVsZCB3YWxrKHNvdXJjZUlkLCBhc3QpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gKnZpc2l0QWxsKGlkeCkge1xuICBsZXQgc291cmNlcyA9IHlpZWxkIHNlbGVjdChhc3Qudmlld3Muc291cmNlcyk7XG5cbiAgbGV0IHRhc2tzID0geWllbGQgYWxsKFxuICAgIE9iamVjdC5lbnRyaWVzKHNvdXJjZXMpXG4gICAgICAuZmlsdGVyKCAoW2lkLCB7YXN0fV0pID0+ICEhYXN0IClcbiAgICAgIC5tYXAoIChbaWQsIHthc3R9XSkgPT4gZm9yayggKCkgPT4gcHV0KGFjdGlvbnMudmlzaXQoaWQsIGFzdCkpKSApXG4gIClcblxuICBpZiAodGFza3MubGVuZ3RoID4gMCkge1xuICAgIHlpZWxkIGpvaW4oLi4udGFza3MpO1xuICB9XG5cbiAgeWllbGQgcHV0KGFjdGlvbnMuZG9uZVZpc2l0aW5nKCkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24qIHNhZ2EoKSB7XG4gIHlpZWxkIHJhY2Uoe1xuICAgIHZpc2l0b3I6IHRha2VFdmVyeShhY3Rpb25zLlZJU0lULCB3YWxrU2FnYSksXG4gICAgZG9uZTogdGFrZShhY3Rpb25zLkRPTkVfVklTSVRJTkcpXG4gIH0pO1xufVxuXG5leHBvcnQgZGVmYXVsdCBwcmVmaXhOYW1lKFwiYXN0XCIsIHNhZ2EpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9hc3Qvc2FnYXMvaW5kZXguanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6ZGF0YTpkZWNvZGVcIik7XG5cbmltcG9ydCB7QmlnTnVtYmVyfSBmcm9tIFwiYmlnbnVtYmVyLmpzXCI7XG5cbmltcG9ydCAqIGFzIG1lbW9yeSBmcm9tIFwiLi9tZW1vcnlcIjtcbmltcG9ydCAqIGFzIHN0b3JhZ2UgZnJvbSBcIi4vc3RvcmFnZVwiO1xuaW1wb3J0ICogYXMgdXRpbHMgZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7IFdPUkRfU0laRSB9IGZyb20gXCIuL3V0aWxzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkKHBvaW50ZXIsIHN0YXRlKSB7XG4gIGlmIChwb2ludGVyLnN0YWNrICE9IHVuZGVmaW5lZCAmJiBzdGF0ZS5zdGFjayAmJiBwb2ludGVyLnN0YWNrIDwgc3RhdGUuc3RhY2subGVuZ3RoKSB7XG4gICAgcmV0dXJuIHN0YXRlLnN0YWNrW3BvaW50ZXIuc3RhY2tdO1xuICB9IGVsc2UgaWYgKHBvaW50ZXIuc3RvcmFnZSAhPSB1bmRlZmluZWQgJiYgc3RhdGUuc3RvcmFnZSkge1xuICAgIHJldHVybiBzdG9yYWdlLnJlYWRSYW5nZShzdGF0ZS5zdG9yYWdlLCBwb2ludGVyLnN0b3JhZ2UpO1xuICB9IGVsc2UgaWYgKHBvaW50ZXIubWVtb3J5ICE9IHVuZGVmaW5lZCAmJiBzdGF0ZS5tZW1vcnkpIHtcbiAgICByZXR1cm4gbWVtb3J5LnJlYWRCeXRlcyhzdGF0ZS5tZW1vcnksIHBvaW50ZXIubWVtb3J5LnN0YXJ0LCBwb2ludGVyLm1lbW9yeS5sZW5ndGgpO1xuICB9IGVsc2UgaWYgKHBvaW50ZXIubGl0ZXJhbCkge1xuICAgIHJldHVybiBwb2ludGVyLmxpdGVyYWw7XG4gIH1cbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlVmFsdWUoZGVmaW5pdGlvbiwgcG9pbnRlciwgc3RhdGUsIC4uLmFyZ3MpIHtcbiAgbGV0IGJ5dGVzID0gcmVhZChwb2ludGVyLCBzdGF0ZSk7XG4gIGlmICghYnl0ZXMpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgc3dpdGNoICh1dGlscy50eXBlQ2xhc3MoZGVmaW5pdGlvbikpIHtcbiAgICBjYXNlIFwiYm9vbFwiOlxuICAgICAgcmV0dXJuICF1dGlscy50b0JpZ051bWJlcihieXRlcykuaXNaZXJvKCk7XG5cbiAgICBjYXNlIFwidWludFwiOlxuICAgICAgcmV0dXJuIHV0aWxzLnRvQmlnTnVtYmVyKGJ5dGVzKTtcblxuICAgIGNhc2UgXCJpbnRcIjpcbiAgICAgIHJldHVybiB1dGlscy50b1NpZ25lZEJpZ051bWJlcihieXRlcyk7XG5cbiAgICBjYXNlIFwiYWRkcmVzc1wiOlxuICAgICAgcmV0dXJuIHV0aWxzLnRvSGV4U3RyaW5nKGJ5dGVzLCB0cnVlKTtcblxuICAgIGNhc2UgXCJieXRlc1wiOlxuICAgICAgZGVidWcoXCJ0eXBlSWRlbnRpZmllciAlcyAlb1wiLCB1dGlscy50eXBlSWRlbnRpZmllcihkZWZpbml0aW9uKSwgYnl0ZXMpO1xuICAgICAgbGV0IGxlbmd0aCA9IHV0aWxzLnNwZWNpZmllZFNpemUoZGVmaW5pdGlvbik7XG4gICAgICByZXR1cm4gdXRpbHMudG9IZXhTdHJpbmcoYnl0ZXMsIGxlbmd0aCk7XG5cbiAgICBjYXNlIFwic3RyaW5nXCI6XG4gICAgICBkZWJ1ZyhcInR5cGVJZGVudGlmaWVyICVzICVvXCIsIHV0aWxzLnR5cGVJZGVudGlmaWVyKGRlZmluaXRpb24pLCBieXRlcyk7XG4gICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBieXRlcyk7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgZGVidWcoXCJVbmtub3duIHZhbHVlIHR5cGU6ICVzXCIsIHV0aWxzLnR5cGVJZGVudGlmaWVyKGRlZmluaXRpb24pKTtcbiAgICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWNvZGVNZW1vcnlSZWZlcmVuY2UoZGVmaW5pdGlvbiwgcG9pbnRlciwgc3RhdGUsIC4uLmFyZ3MpIHtcbiAgbGV0IHJhd1ZhbHVlID0gdXRpbHMudG9CaWdOdW1iZXIocmVhZChwb2ludGVyLCBzdGF0ZSkpLnRvTnVtYmVyKCk7XG5cbiAgdmFyIGJ5dGVzO1xuICBzd2l0Y2ggKHV0aWxzLnR5cGVDbGFzcyhkZWZpbml0aW9uKSkge1xuXG4gICAgY2FzZSBcImJ5dGVzXCI6XG4gICAgY2FzZSBcInN0cmluZ1wiOlxuICAgICAgYnl0ZXMgPSByZWFkKHtcbiAgICAgICAgbWVtb3J5OiB7IHN0YXJ0OiByYXdWYWx1ZSwgbGVuZ3RoOiBXT1JEX1NJWkV9XG4gICAgICB9LCBzdGF0ZSk7IC8vIGJ5dGVzIGNvbnRhaW4gbGVuZ3RoXG5cbiAgICAgIHJldHVybiBkZWNvZGVWYWx1ZShkZWZpbml0aW9uLCB7XG4gICAgICAgIG1lbW9yeTogeyBzdGFydDogcmF3VmFsdWUgKyBXT1JEX1NJWkUsIGxlbmd0aDogYnl0ZXMgfVxuICAgICAgfSwgc3RhdGUsIC4uLmFyZ3MpO1xuXG4gICAgY2FzZSBcImFycmF5XCI6XG4gICAgICBieXRlcyA9IHV0aWxzLnRvQmlnTnVtYmVyKHJlYWQoe1xuICAgICAgICBtZW1vcnk6IHsgc3RhcnQ6IHJhd1ZhbHVlLCBsZW5ndGg6IFdPUkRfU0laRSB9LFxuICAgICAgfSwgc3RhdGUpKS50b051bWJlcigpOyAgLy8gYnl0ZXMgY29udGFpbiBhcnJheSBsZW5ndGhcblxuICAgICAgYnl0ZXMgPSByZWFkKHsgbWVtb3J5OiB7XG4gICAgICAgIHN0YXJ0OiByYXdWYWx1ZSArIFdPUkRfU0laRSwgbGVuZ3RoOiBieXRlcyAqIFdPUkRfU0laRVxuICAgICAgfX0sIHN0YXRlKTsgLy8gbm93IGJ5dGVzIGNvbnRhaW4gaXRlbXNcblxuICAgICAgcmV0dXJuIG1lbW9yeS5jaHVuayhieXRlcywgV09SRF9TSVpFKVxuICAgICAgICAubWFwKFxuICAgICAgICAgIChjaHVuaykgPT4gZGVjb2RlKHV0aWxzLmJhc2VEZWZpbml0aW9uKGRlZmluaXRpb24pLCB7XG4gICAgICAgICAgICBsaXRlcmFsOiBjaHVua1xuICAgICAgICAgIH0sIHN0YXRlLCAuLi5hcmdzKVxuICAgICAgICApXG5cbiAgICBjYXNlIFwic3RydWN0XCI6XG4gICAgICBsZXQgW3JlZnNdID0gYXJncztcbiAgICAgIGxldCBzdHJ1Y3REZWZpbml0aW9uID0gcmVmc1tkZWZpbml0aW9uLnR5cGVOYW1lLnJlZmVyZW5jZWREZWNsYXJhdGlvbl07XG4gICAgICBsZXQgc3RydWN0VmFyaWFibGVzID0gc3RydWN0RGVmaW5pdGlvbi52YXJpYWJsZXMgfHwgW107XG5cbiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKFxuICAgICAgICB7fSwgLi4uc3RydWN0VmFyaWFibGVzXG4gICAgICAgICAgLm1hcChcbiAgICAgICAgICAgICh7bmFtZSwgaWR9LCBpKSA9PiB7XG4gICAgICAgICAgICAgIGxldCBtZW1iZXJEZWZpbml0aW9uID0gcmVmc1tpZF0uZGVmaW5pdGlvbjtcbiAgICAgICAgICAgICAgbGV0IG1lbWJlclBvaW50ZXIgPSB7XG4gICAgICAgICAgICAgICAgbWVtb3J5OiB7IHN0YXJ0OiByYXdWYWx1ZSArIGkgKiBXT1JEX1NJWkUsIGxlbmd0aDogV09SRF9TSVpFIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgLy8gbGV0IG1lbWJlclBvaW50ZXIgPSBtZW1vcnkucmVhZChzdGF0ZS5tZW1vcnksIHBvaW50ZXIgKyBpICogV09SRF9TSVpFKTtcblxuICAgICAgICAgICAgICAvLyBIQUNLXG4gICAgICAgICAgICAgIG1lbWJlckRlZmluaXRpb24gPSB7XG4gICAgICAgICAgICAgICAgLi4ubWVtYmVyRGVmaW5pdGlvbixcblxuICAgICAgICAgICAgICAgIHR5cGVEZXNjcmlwdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgIC4uLm1lbWJlckRlZmluaXRpb24udHlwZURlc2NyaXB0aW9ucyxcblxuICAgICAgICAgICAgICAgICAgdHlwZUlkZW50aWZpZXI6XG4gICAgICAgICAgICAgICAgICAgIG1lbWJlckRlZmluaXRpb24udHlwZURlc2NyaXB0aW9ucy50eXBlSWRlbnRpZmllclxuICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9fc3RvcmFnZV8vZywgXCJfbWVtb3J5X1wiKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIFtuYW1lXTogZGVjb2RlKFxuICAgICAgICAgICAgICAgICAgbWVtYmVyRGVmaW5pdGlvbiwgbWVtYmVyUG9pbnRlciwgc3RhdGUsIC4uLmFyZ3NcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKVxuICAgICAgKTtcblxuXG4gICAgZGVmYXVsdDpcbiAgICAgIGRlYnVnKFwiVW5rbm93biBtZW1vcnkgcmVmZXJlbmNlIHR5cGU6ICVzXCIsIHV0aWxzLnR5cGVJZGVudGlmaWVyKGRlZmluaXRpb24pKTtcbiAgICAgIHJldHVybiBudWxsO1xuXG4gIH1cblxufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlU3RvcmFnZVJlZmVyZW5jZShkZWZpbml0aW9uLCBwb2ludGVyLCBzdGF0ZSwgLi4uYXJncykge1xuICB2YXIgZGF0YTtcbiAgdmFyIGJ5dGVzO1xuICB2YXIgbGVuZ3RoO1xuICB2YXIgc2xvdDtcblxuICBzd2l0Y2ggKHV0aWxzLnR5cGVDbGFzcyhkZWZpbml0aW9uKSkge1xuICAgIGNhc2UgXCJhcnJheVwiOlxuICAgICAgZGVidWcoXCJzdG9yYWdlIGFycmF5ISAlb1wiLCBwb2ludGVyKTtcbiAgICAgIGRhdGEgPSByZWFkKHBvaW50ZXIsIHN0YXRlKTtcbiAgICAgIGlmICghZGF0YSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgbGVuZ3RoID0gdXRpbHMudG9CaWdOdW1iZXIoZGF0YSkudG9OdW1iZXIoKTtcbiAgICAgIGRlYnVnKFwibGVuZ3RoICVvXCIsIGxlbmd0aCk7XG5cbiAgICAgIGNvbnN0IGJhc2VTaXplID0gdXRpbHMuc3RvcmFnZVNpemUodXRpbHMuYmFzZURlZmluaXRpb24oZGVmaW5pdGlvbikpO1xuICAgICAgY29uc3QgcGVyV29yZCA9IE1hdGguZmxvb3IoV09SRF9TSVpFIC8gYmFzZVNpemUpO1xuICAgICAgZGVidWcoXCJiYXNlU2l6ZSAlb1wiLCBiYXNlU2l6ZSk7XG4gICAgICBkZWJ1ZyhcInBlcldvcmQgJWRcIiwgcGVyV29yZCk7XG5cbiAgICAgIGNvbnN0IG9mZnNldCA9IChpKSA9PiB7XG4gICAgICAgIGlmIChwZXJXb3JkID09IDEpIHtcbiAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKGkgKiBiYXNlU2l6ZSAvIFdPUkRfU0laRSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGluZGV4ID0gKGkpID0+IHtcbiAgICAgICAgaWYgKHBlcldvcmQgPT0gMSkge1xuICAgICAgICAgIHJldHVybiBXT1JEX1NJWkUgLSBiYXNlU2l6ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gcGVyV29yZCAtIGkgJSBwZXJXb3JkIC0gMTtcbiAgICAgICAgcmV0dXJuIHBvc2l0aW9uICogYmFzZVNpemU7XG4gICAgICB9XG5cbiAgICAgIGRlYnVnKFwicG9pbnRlcjogJW9cIiwgcG9pbnRlcik7XG4gICAgICByZXR1cm4gWy4uLkFycmF5KGxlbmd0aCkua2V5cygpXVxuICAgICAgICAubWFwKCAoaSkgPT4ge1xuICAgICAgICAgIGxldCBjaGlsZEZyb20gPSBwb2ludGVyLnN0b3JhZ2UuZnJvbS5vZmZzZXQgIT0gdW5kZWZpbmVkID9cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgc2xvdDogW1wiMHhcIiArIHV0aWxzLnRvQmlnTnVtYmVyKFxuICAgICAgICAgICAgICAgIHV0aWxzLmtlY2NhazI1NiguLi5wb2ludGVyLnN0b3JhZ2UuZnJvbS5zbG90KVxuICAgICAgICAgICAgICApLnBsdXMocG9pbnRlci5zdG9yYWdlLmZyb20ub2Zmc2V0KS50b1N0cmluZygxNildLFxuICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldChpKSxcbiAgICAgICAgICAgICAgaW5kZXg6IGluZGV4KGkpXG4gICAgICAgICAgICB9IDoge1xuICAgICAgICAgICAgICBzbG90OiBbcG9pbnRlci5zdG9yYWdlLmZyb20uc2xvdF0sXG4gICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0KGkpLFxuICAgICAgICAgICAgICBpbmRleDogaW5kZXgoaSlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgcmV0dXJuIGNoaWxkRnJvbTtcbiAgICAgICAgfSlcbiAgICAgICAgLm1hcCggKGNoaWxkRnJvbSwgaWR4KSA9PiB7XG4gICAgICAgICAgZGVidWcoXCJjaGlsZEZyb20gJWQsICVvXCIsIGlkeCwgY2hpbGRGcm9tKTtcbiAgICAgICAgICByZXR1cm4gZGVjb2RlKHV0aWxzLmJhc2VEZWZpbml0aW9uKGRlZmluaXRpb24pLCB7IHN0b3JhZ2U6IHtcbiAgICAgICAgICAgIGZyb206IGNoaWxkRnJvbSxcbiAgICAgICAgICAgIGxlbmd0aDogYmFzZVNpemVcbiAgICAgICAgICB9fSwgc3RhdGUsIC4uLmFyZ3MpO1xuICAgICAgICB9KTtcblxuICAgIGNhc2UgXCJieXRlc1wiOlxuICAgIGNhc2UgXCJzdHJpbmdcIjpcbiAgICAgIGRhdGEgPSByZWFkKHBvaW50ZXIsIHN0YXRlKTtcbiAgICAgIGlmICghZGF0YSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgaWYgKGRhdGFbV09SRF9TSVpFIC0gMV0gJSAyID09IDApIHtcbiAgICAgICAgLy8gc3RyaW5nIGxpdmVzIGluIHdvcmQsIGxlbmd0aCBpcyBsYXN0IGJ5dGUgLyAyXG4gICAgICAgIGxlbmd0aCA9IGRhdGFbV09SRF9TSVpFIC0gMV0gLyAyO1xuICAgICAgICBkZWJ1ZyhcImluLXdvcmQ7IGxlbmd0aCAlb1wiLCBsZW5ndGgpO1xuICAgICAgICBpZiAobGVuZ3RoID09IDApIHtcbiAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkZWNvZGVWYWx1ZShkZWZpbml0aW9uLCB7IHN0b3JhZ2U6IHtcbiAgICAgICAgICBmcm9tOiB7IHNsb3Q6IHBvaW50ZXIuc3RvcmFnZS5mcm9tLnNsb3QsIGluZGV4OiAwIH0sXG4gICAgICAgICAgdG86IHsgc2xvdDogcG9pbnRlci5zdG9yYWdlLmZyb20uc2xvdCwgaW5kZXg6IGxlbmd0aCAtIDF9XG4gICAgICAgIH19LCBzdGF0ZSwgLi4uYXJncyk7XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxlbmd0aCA9IHV0aWxzLnRvQmlnTnVtYmVyKGRhdGEpLm1pbnVzKDEpLmRpdigyKS50b051bWJlcigpO1xuICAgICAgICBkZWJ1ZyhcIm5ldy13b3JkLCBsZW5ndGggJW9cIiwgbGVuZ3RoKTtcblxuICAgICAgICByZXR1cm4gZGVjb2RlVmFsdWUoZGVmaW5pdGlvbiwgeyBzdG9yYWdlOiB7XG4gICAgICAgICAgZnJvbTogeyBzbG90OiBbcG9pbnRlci5zdG9yYWdlLmZyb20uc2xvdF0sIGluZGV4OiAwIH0sXG4gICAgICAgICAgbGVuZ3RoXG4gICAgICAgIH19LCBzdGF0ZSwgLi4uYXJncyk7XG4gICAgICB9XG5cbiAgICBjYXNlIFwic3RydWN0XCI6XG4gICAgICBsZXQgW3JlZnNdID0gYXJncztcblxuICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oXG4gICAgICAgIHt9LCAuLi5PYmplY3QuZW50cmllcyhwb2ludGVyLnN0b3JhZ2UuY2hpbGRyZW4pXG4gICAgICAgICAgLm1hcCggKFtpZCwgY2hpbGRQb2ludGVyXSkgPT4gKHtcbiAgICAgICAgICAgIFtjaGlsZFBvaW50ZXIubmFtZV06IGRlY29kZShcbiAgICAgICAgICAgICAgcmVmc1tpZF0uZGVmaW5pdGlvbiwgeyBzdG9yYWdlOiBjaGlsZFBvaW50ZXIgfSwgc3RhdGUsIC4uLmFyZ3NcbiAgICAgICAgICAgIClcbiAgICAgICAgICB9KSlcbiAgICAgICk7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgZGVidWcoXCJVbmtub3duIHN0b3JhZ2UgcmVmZXJlbmNlIHR5cGU6ICVzXCIsIHV0aWxzLnR5cGVJZGVudGlmaWVyKGRlZmluaXRpb24pKTtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn1cblxuXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRlY29kZShkZWZpbml0aW9uLCAuLi5hcmdzKSB7XG4gIGlmICghdXRpbHMuaXNSZWZlcmVuY2UoZGVmaW5pdGlvbikpIHtcbiAgICByZXR1cm4gZGVjb2RlVmFsdWUoZGVmaW5pdGlvbiwgLi4uYXJncyk7XG4gIH1cblxuICBzd2l0Y2ggKHV0aWxzLnJlZmVyZW5jZVR5cGUoZGVmaW5pdGlvbikpIHtcbiAgICBjYXNlIFwibWVtb3J5XCI6XG4gICAgICByZXR1cm4gZGVjb2RlTWVtb3J5UmVmZXJlbmNlKGRlZmluaXRpb24sIC4uLmFyZ3MpO1xuICAgIGNhc2UgXCJzdG9yYWdlXCI6XG4gICAgICByZXR1cm4gZGVjb2RlU3RvcmFnZVJlZmVyZW5jZShkZWZpbml0aW9uLCAuLi5hcmdzKTtcbiAgICBkZWZhdWx0OlxuICAgICAgZGVidWcoXCJVbmtub3duIHJlZmVyZW5jZSBjYXRlZ29yeTogJXNcIiwgdXRpbHMudHlwZUlkZW50aWZpZXIoZGVmaW5pdGlvbikpO1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9kYXRhL2RlY29kZS9pbmRleC5qcyIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tIFwiZGVidWdcIjtcbmNvbnN0IGRlYnVnID0gZGVidWdNb2R1bGUoXCJkZWJ1Z2dlcjpkYXRhOmRlY29kZTptZW1vcnlcIik7XG5cbmltcG9ydCB7IEJpZ051bWJlciB9IGZyb20gXCJiaWdudW1iZXIuanNcIjtcblxuaW1wb3J0ICogYXMgdXRpbHMgZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7IFdPUkRfU0laRSB9IGZyb20gXCIuL3V0aWxzXCI7XG5cbi8qKlxuICogcmVhZCB3b3JkIGZyb20gbWVtb3J5XG4gKlxuICogcmVxdWlyZXMgYGJ5dGVgIHRvIGJlIGEgbXVsdGlwbGUgb2YgV09SRF9TSVpFICgzMilcbiAqXG4gKiBAcGFyYW0gbWVtb3J5IC0gVWludDhBcnJheVxuICogQHJldHVybiB7QmlnTnVtYmVyfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVhZChtZW1vcnksIGJ5dGUpIHtcbiAgcmV0dXJuIHJlYWRCeXRlcyhtZW1vcnksIGJ5dGUsIFdPUkRfU0laRSk7XG59XG5cbi8qKlxuICogcmVhZCA8Ynl0ZXM+IGFtb3VudCBvZiBieXRlcyBmcm9tIG1lbW9yeSwgc3RhcnRpbmcgYXQgYnl0ZSA8c3RhcnQ+XG4gKlxuICogQHBhcmFtIG1lbW9yeSAtIFVpbnQ4QXJyYXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlYWRCeXRlcyhtZW1vcnksIGJ5dGUsIGxlbmd0aCkge1xuICBieXRlID0gdXRpbHMudG9CaWdOdW1iZXIoYnl0ZSk7XG4gIGxlbmd0aCA9IHV0aWxzLnRvQmlnTnVtYmVyKGxlbmd0aCk7XG5cbiAgaWYgKGJ5dGUudG9OdW1iZXIoKSA+PSBtZW1vcnkubGVuZ3RoKSB7XG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KGxlbmd0aCA/IGxlbmd0aC50b051bWJlcigpIDogMCk7XG4gIH1cblxuICBpZiAobGVuZ3RoID09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBuZXcgVWludDhBcnJheShtZW1vcnkuYnVmZmVyLCBieXRlLnRvTnVtYmVyKCkpO1xuICB9XG5cbiAgLy8gZ3JhYiBgbGVuZ3RoYCBieXRlcyBubyBtYXR0ZXIgd2hhdCwgaGVyZSBmaWxsIHRoaXMgYXJyYXlcbiAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoLnRvTnVtYmVyKCkpO1xuXG4gIC8vIGlmIHdlJ3JlIHJlYWRpbmcgcGFzdCB0aGUgZW5kIG9mIG1lbW9yeSwgdHJ1bmNhdGUgdGhlIGxlbmd0aCB0byByZWFkXG4gIGxldCBleGNlc3MgPSBieXRlLnBsdXMobGVuZ3RoKS5taW51cyhtZW1vcnkubGVuZ3RoKS50b051bWJlcigpO1xuICBpZiAoZXhjZXNzID4gMCkge1xuICAgIGxlbmd0aCA9IG5ldyBCaWdOdW1iZXIobWVtb3J5Lmxlbmd0aCkubWludXMoYnl0ZSk7XG4gIH1cblxuICBsZXQgZXhpc3RpbmcgPSBuZXcgVWludDhBcnJheShtZW1vcnkuYnVmZmVyLCBieXRlLnRvTnVtYmVyKCksIGxlbmd0aC50b051bWJlcigpKTtcblxuICBieXRlcy5zZXQoZXhpc3RpbmcpO1xuXG4gIHJldHVybiBieXRlcztcbn1cblxuLyoqXG4gKiBTcGxpdCBtZW1vcnkgaW50byBjaHVua3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNodW5rKG1lbW9yeSwgc2l6ZSA9IFdPUkRfU0laRSkge1xuICBsZXQgY2h1bmtzID0gW107XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZW1vcnkubGVuZ3RoOyBpICs9IHNpemUpIHtcbiAgICBsZXQgY2h1bmsgPSByZWFkQnl0ZXMobWVtb3J5LCBpLCBzaXplKTtcbiAgICBjaHVua3MucHVzaChjaHVuayk7XG4gIH1cblxuICByZXR1cm4gY2h1bmtzO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9kYXRhL2RlY29kZS9tZW1vcnkuanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6ZGF0YTpkZWNvZGU6c3RvcmFnZVwiKTtcblxuaW1wb3J0IHsgV09SRF9TSVpFIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCAqIGFzIHV0aWxzIGZyb20gXCIuL3V0aWxzXCI7XG5cblxuLyoqXG4gKiByZWFkIHNsb3QgZnJvbSBzdG9yYWdlXG4gKlxuICogQHBhcmFtIHNsb3QgLSBiaWcgbnVtYmVyIG9yIGFycmF5IG9mIHJlZ3VsYXIgbnVtYmVyc1xuICogQHBhcmFtIG9mZnNldCAtIGZvciBhcnJheSwgb2Zmc2V0IGZyb20gdGhlIGtlY2NhayBkZXRlcm1pbmVkIGxvY2F0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWFkKHN0b3JhZ2UsIHNsb3QsIG9mZnNldCA9IDApIHtcbiAgaWYgKHNsb3QgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgIHNsb3QgPSB1dGlscy5rZWNjYWsyNTYoLi4uc2xvdC5tYXAodXRpbHMudG9CaWdOdW1iZXIpKTtcbiAgfVxuXG4gIHNsb3QgPSB1dGlscy50b0JpZ051bWJlcihzbG90KS5wbHVzKG9mZnNldCk7XG5cbiAgZGVidWcoXCJyZWFkaW5nIHNsb3Q6ICVvXCIsIHV0aWxzLnRvSGV4U3RyaW5nKHNsb3QpKTtcblxuICBsZXQgd29yZCA9IHN0b3JhZ2VbdXRpbHMudG9IZXhTdHJpbmcoc2xvdCwgV09SRF9TSVpFKV0gfHxcbiAgICBuZXcgVWludDhBcnJheShXT1JEX1NJWkUpO1xuXG4gIGRlYnVnKFwid29yZCAlb1wiLCB3b3JkKTtcbiAgcmV0dXJuIHdvcmRcbn1cblxuLyoqXG4gKiByZWFkIGFsbCBieXRlcyBpbiBzb21lIHJhbmdlLlxuICpcbiAqIHBhcmFtZXRlcnMgYGZyb21gIGFuZCBgdG9gIGFyZSBvYmplY3RzIHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICpcbiAqICAgc2xvdCAtIChyZXF1aXJlZCkgZWl0aGVyIGEgYmlnbnVtYmVyIG9yIGEgXCJwYXRoXCIgYXJyYXkgb2YgaW50ZWdlciBvZmZzZXRzXG4gKlxuICogICAgIHBhdGggYXJyYXkgdmFsdWVzIGdldCBjb252ZXJ0ZWQgaW50byBrZWNjYWsyNTYgaGFzaCBhcyBwZXIgc29saWRpdHlcbiAqICAgICBzdG9yYWdlIGFsbG9jYXRpb24gbWV0aG9kXG4gKlxuICogICAgIHJlZjogaHR0cHM6Ly9zb2xpZGl0eS5yZWFkdGhlZG9jcy5pby9lbi92MC40LjIzL21pc2NlbGxhbmVvdXMuaHRtbCNsYXlvdXQtb2Ytc3RhdGUtdmFyaWFibGVzLWluLXN0b3JhZ2VcbiAqICAgICAoc2VhcmNoIFwiY29uY2F0ZW5hdGlvblwiKVxuICpcbiAqICBvZmZzZXQgLSAoZGVmYXVsdDogMCkgc2xvdCBvZmZzZXRcbiAqXG4gKiAgaW5kZXggLSAoZGVmYXVsdDogMCkgYnl0ZSBpbmRleCBpbiB3b3JkXG4gKlxuICogQHBhcmFtIGZyb20gLSBsb2NhdGlvbiAoc2VlIF4pXG4gKiBAcGFyYW0gdG8gLSBsb2NhdGlvbiAoc2VlIF4pLiBpbmNsdXNpdmUuXG4gKiBAcGFyYW0gbGVuZ3RoIC0gaW5zdGVhZCBvZiBgdG9gLCBudW1iZXIgb2YgYnl0ZXMgYWZ0ZXIgYGZyb21gXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWFkUmFuZ2Uoc3RvcmFnZSwge2Zyb20sIHRvLCBsZW5ndGh9KSB7XG4gIGlmICghbGVuZ3RoICYmICF0byB8fCBsZW5ndGggJiYgdG8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJtdXN0IHNwZWNpZnkgZXhhY3RseSBvbmUgYHRvYHxgbGVuZ3RoYFwiKTtcbiAgfVxuXG4gIGZyb20gPSB7XG4gICAgLi4uZnJvbSxcbiAgICBvZmZzZXQ6IGZyb20ub2Zmc2V0IHx8IDBcbiAgfTtcblxuICBpZiAobGVuZ3RoKSB7XG4gICAgdG8gPSB7XG4gICAgICBzbG90OiBmcm9tLnNsb3QsXG4gICAgICBvZmZzZXQ6IGZyb20ub2Zmc2V0ICsgTWF0aC5mbG9vcigoZnJvbS5pbmRleCArIGxlbmd0aCAtIDEpIC8gV09SRF9TSVpFKSxcbiAgICAgIGluZGV4OiAoZnJvbS5pbmRleCArIGxlbmd0aCAtIDEpICUgV09SRF9TSVpFXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICB0byA9IHtcbiAgICAgIC4uLnRvLFxuICAgICAgb2Zmc2V0OiB0by5vZmZzZXQgfHwgMFxuICAgIH1cbiAgfVxuXG4gIGRlYnVnKFwicmVhZFJhbmdlICVvXCIsIHtmcm9tLHRvfSk7XG5cbiAgY29uc3QgdG90YWxXb3JkcyA9IHRvLm9mZnNldCAtIGZyb20ub2Zmc2V0ICsgMTtcbiAgZGVidWcoXCJ0b3RhbFdvcmRzICVvXCIsIHRvdGFsV29yZHMpO1xuXG4gIGxldCBkYXRhID0gbmV3IFVpbnQ4QXJyYXkodG90YWxXb3JkcyAqIFdPUkRfU0laRSk7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbFdvcmRzOyBpKyspIHtcbiAgICBsZXQgb2Zmc2V0ID0gaSArIGZyb20ub2Zmc2V0O1xuICAgIGRhdGEuc2V0KHJlYWQoc3RvcmFnZSwgZnJvbS5zbG90LCBvZmZzZXQpLCBpICogV09SRF9TSVpFKTtcbiAgfVxuICBkZWJ1ZyhcIndvcmRzICVvXCIsIGRhdGEpO1xuXG4gIGRhdGEgPSBkYXRhLnNsaWNlKGZyb20uaW5kZXgsICh0b3RhbFdvcmRzIC0gMSkgKiBXT1JEX1NJWkUgKyB0by5pbmRleCArIDEpO1xuXG4gIGRlYnVnKFwiZGF0YTogJW9cIiwgZGF0YSk7XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvZGF0YS9kZWNvZGUvc3RvcmFnZS5qcyIsImV4cG9ydCBjb25zdCBWSVNJVCA9IFwiVklTSVRcIjtcbmV4cG9ydCBmdW5jdGlvbiB2aXNpdChzb3VyY2VJZCwgYXN0KSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogVklTSVQsXG4gICAgc291cmNlSWQsIGFzdFxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBET05FX1ZJU0lUSU5HID0gXCJET05FX1ZJU0lUSU5HXCI7XG5leHBvcnQgZnVuY3Rpb24gZG9uZVZpc2l0aW5nKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IERPTkVfVklTSVRJTkdcbiAgfTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvYXN0L2FjdGlvbnMvaW5kZXguanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6Y29udHJvbGxlcjpzYWdhc1wiKTtcblxuaW1wb3J0IHsgcHV0LCBjYWxsLCByYWNlLCB0YWtlLCBzZWxlY3QgfSBmcm9tICdyZWR1eC1zYWdhL2VmZmVjdHMnO1xuXG5pbXBvcnQgeyBwcmVmaXhOYW1lIH0gZnJvbSBcImxpYi9oZWxwZXJzXCI7XG5cbmltcG9ydCAqIGFzIHRyYWNlIGZyb20gXCJsaWIvdHJhY2Uvc2FnYXNcIjtcblxuaW1wb3J0ICogYXMgYWN0aW9ucyBmcm9tIFwiLi4vYWN0aW9uc1wiO1xuXG5pbXBvcnQgY29udHJvbGxlciBmcm9tIFwiLi4vc2VsZWN0b3JzXCI7XG5cbmNvbnN0IENPTlRST0xfU0FHQVMgPSB7XG4gIFthY3Rpb25zLkFEVkFOQ0VdOiBhZHZhbmNlLFxuICBbYWN0aW9ucy5TVEVQX05FWFRdOiBzdGVwTmV4dCxcbiAgW2FjdGlvbnMuU1RFUF9PVkVSXTogc3RlcE92ZXIsXG4gIFthY3Rpb25zLlNURVBfSU5UT106IHN0ZXBJbnRvLFxuICBbYWN0aW9ucy5TVEVQX09VVF06IHN0ZXBPdXQsXG4gIFthY3Rpb25zLkNPTlRJTlVFX1VOVElMXTogY29udGludWVVbnRpbFxufTtcblxuLyoqIEFTVCBub2RlIHR5cGVzIHRoYXQgYXJlIHNraXBwZWQgdG8gZmlsdGVyIG91dCBzb21lIG5vaXNlICovXG5jb25zdCBTS0lQUEVEX1RZUEVTID0gbmV3IFNldChbXG4gIFwiQ29udHJhY3REZWZpbml0aW9uXCIsXG4gIFwiVmFyaWFibGVEZWNsYXJhdGlvblwiLFxuXSk7XG5cbmV4cG9ydCBmdW5jdGlvbiogc2FnYSgpIHtcbiAgd2hpbGUgKHRydWUpIHtcbiAgICBkZWJ1ZyhcIndhaXRpbmcgZm9yIGNvbnRyb2wgYWN0aW9uXCIpO1xuICAgIGxldCBhY3Rpb24gPSB5aWVsZCB0YWtlKE9iamVjdC5rZXlzKENPTlRST0xfU0FHQVMpKTtcbiAgICBkZWJ1ZyhcImdvdCBjb250cm9sIGFjdGlvblwiKTtcbiAgICBsZXQgc2FnYSA9IENPTlRST0xfU0FHQVNbYWN0aW9uLnR5cGVdO1xuXG4gICAgeWllbGQgcHV0KGFjdGlvbnMuYmVnaW5TdGVwKGFjdGlvbi50eXBlKSk7XG5cbiAgICB5aWVsZCByYWNlKHtcbiAgICAgIGV4ZWM6IGNhbGwoc2FnYSwgYWN0aW9uKSxcbiAgICAgIGludGVycnVwdDogdGFrZShhY3Rpb25zLklOVEVSUlVQVClcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBwcmVmaXhOYW1lKFwiY29udHJvbGxlclwiLCBzYWdhKTtcblxuLyoqXG4gKiBBZHZhbmNlIHRoZSBzdGF0ZSBieSBvbmUgaW5zdHJ1Y3Rpb25cbiAqL1xuZnVuY3Rpb24qIGFkdmFuY2UoKSB7XG4gIC8vIHNlbmQgYWN0aW9uIHRvIGFkdmFuY2UgdHJhY2VcbiAgeWllbGQgKnRyYWNlLmFkdmFuY2UoKTtcbn1cblxuLyoqXG4gKiBzdGVwTmV4dCAtIHN0ZXAgdG8gdGhlIG5leHQgbG9naWNhbCBjb2RlIHNlZ21lbnRcbiAqXG4gKiBOb3RlOiBJdCBtaWdodCB0YWtlIG11bHRpcGxlIGluc3RydWN0aW9ucyB0byBleHByZXNzIHRoZSBzYW1lIHNlY3Rpb24gb2YgY29kZS5cbiAqIFwiU3RlcHBpbmdcIiwgdGhlbiwgaXMgc3RlcHBpbmcgdG8gdGhlIG5leHQgbG9naWNhbCBpdGVtLCBub3Qgc3RlcHBpbmcgdG8gdGhlIG5leHRcbiAqIGluc3RydWN0aW9uLiBTZWUgYWR2YW5jZSgpIGlmIHlvdSdkIGxpa2UgdG8gYWR2YW5jZSBieSBvbmUgaW5zdHJ1Y3Rpb24uXG4gKi9cbmZ1bmN0aW9uKiBzdGVwTmV4dCAoKSB7XG4gIGNvbnN0IHN0YXJ0aW5nUmFuZ2UgPSB5aWVsZCBzZWxlY3QoY29udHJvbGxlci5jdXJyZW50LmxvY2F0aW9uLnNvdXJjZVJhbmdlKTtcblxuICB2YXIgdXBjb21pbmc7XG5cbiAgZG8ge1xuICAgIC8vIGFkdmFuY2UgYXQgbGVhc3Qgb25jZSBzdGVwXG4gICAgeWllbGQqIGFkdmFuY2UoKTtcblxuICAgIC8vIGFuZCBjaGVjayB0aGUgbmV4dCBzb3VyY2UgcmFuZ2VcbiAgICB1cGNvbWluZyA9IHlpZWxkIHNlbGVjdChjb250cm9sbGVyLmN1cnJlbnQubG9jYXRpb24pO1xuXG4gICAgLy8gaWYgdGhlIG5leHQgc3RlcCdzIHNvdXJjZSByYW5nZSBpcyBzdGlsbCB0aGUgc2FtZSwga2VlcCBnb2luZ1xuICB9IHdoaWxlIChcbiAgICAhdXBjb21pbmcubm9kZSB8fFxuICAgIFNLSVBQRURfVFlQRVMuaGFzKHVwY29taW5nLm5vZGUubm9kZVR5cGUpIHx8XG5cbiAgICB1cGNvbWluZy5zb3VyY2VSYW5nZS5zdGFydCA9PSBzdGFydGluZ1JhbmdlLnN0YXJ0ICYmXG4gICAgdXBjb21pbmcuc291cmNlUmFuZ2UubGVuZ3RoID09IHN0YXJ0aW5nUmFuZ2UubGVuZ3RoXG4gICk7XG59XG5cbi8qKlxuICogc3RlcEludG8gLSBzdGVwIGludG8gdGhlIGN1cnJlbnQgZnVuY3Rpb25cbiAqXG4gKiBDb25jZXB0dWFsbHkgdGhpcyBpcyBlYXN5LCBidXQgZnJvbSBhIHByb2dyYW1taW5nIHN0YW5kcG9pbnQgaXQncyBoYXJkLlxuICogQ29kZSBsaWtlIGBnZXRCYWxhbmNlKG1zZy5zZW5kZXIpYCBtaWdodCBiZSBoaWdobGlnaHRlZCwgYnV0IHRoZXJlIGNvdWxkXG4gKiBiZSBhIG51bWJlciBvZiBkaWZmZXJlbnQgaW50ZXJtZWRpYXRlIHN0ZXBzIChsaWtlIGV2YWx1YXRpbmcgYG1zZy5zZW5kZXJgKVxuICogYmVmb3JlIGBnZXRCYWxhbmNlYCBpcyBzdGVwcGVkIGludG8uIFRoaXMgZnVuY3Rpb24gd2lsbCBzdGVwIGludG8gdGhlIGZpcnN0XG4gKiBmdW5jdGlvbiBhdmFpbGFibGUgKHdoZXJlIGluc3RydWN0aW9uLmp1bXAgPT0gXCJpXCIpLCBpZ25vcmluZyBhbnkgaW50ZXJtZWRpYXRlXG4gKiBzdGVwcyB0aGF0IGZhbGwgd2l0aGluIHRoZSBzYW1lIGNvZGUgcmFuZ2UuIElmIHRoZXJlJ3MgYSBzdGVwIGVuY291bnRlcmVkXG4gKiB0aGF0IGV4aXN0cyBvdXRzaWRlIG9mIHRoZSByYW5nZSwgdGhlbiBzdGVwSW50byB3aWxsIG9ubHkgZXhlY3V0ZSB1bnRpbCB0aGF0XG4gKiBzdGVwLlxuICovXG5mdW5jdGlvbiogc3RlcEludG8gKCkge1xuICBpZiAoeWllbGQgc2VsZWN0KGNvbnRyb2xsZXIuY3VycmVudC53aWxsSnVtcCkpIHtcbiAgICB5aWVsZCogc3RlcE5leHQoKTtcblxuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh5aWVsZCBzZWxlY3QoY29udHJvbGxlci5jdXJyZW50LmxvY2F0aW9uLmlzTXVsdGlsaW5lKSkge1xuICAgIHlpZWxkKiBzdGVwT3ZlcigpO1xuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgc3RhcnRpbmdEZXB0aCA9IHlpZWxkIHNlbGVjdChjb250cm9sbGVyLmN1cnJlbnQuZnVuY3Rpb25EZXB0aCk7XG4gIGNvbnN0IHN0YXJ0aW5nUmFuZ2UgPSB5aWVsZCBzZWxlY3QoY29udHJvbGxlci5jdXJyZW50LmxvY2F0aW9uLnNvdXJjZVJhbmdlKTtcbiAgdmFyIGN1cnJlbnREZXB0aDtcbiAgdmFyIGN1cnJlbnRSYW5nZTtcblxuICBkbyB7XG4gICAgeWllbGQqIHN0ZXBOZXh0KCk7XG5cbiAgICBjdXJyZW50RGVwdGggPSB5aWVsZCBzZWxlY3QoY29udHJvbGxlci5jdXJyZW50LmZ1bmN0aW9uRGVwdGgpO1xuICAgIGN1cnJlbnRSYW5nZSA9IHlpZWxkIHNlbGVjdChjb250cm9sbGVyLmN1cnJlbnQubG9jYXRpb24uc291cmNlUmFuZ2UpO1xuXG4gIH0gd2hpbGUgKFxuICAgIC8vIHRoZSBmdW5jdGlvbiBzdGFjayBoYXMgbm90IGluY3JlYXNlZCxcbiAgICBjdXJyZW50RGVwdGggPD0gc3RhcnRpbmdEZXB0aCAmJlxuXG4gICAgLy8gdGhlIGN1cnJlbnQgc291cmNlIHJhbmdlIGJlZ2lucyBvbiBvciBhZnRlciB0aGUgc3RhcnRpbmcgcmFuZ2VcbiAgICBjdXJyZW50UmFuZ2Uuc3RhcnQgPj0gc3RhcnRpbmdSYW5nZS5zdGFydCAmJlxuXG4gICAgLy8gYW5kIHRoZSBjdXJyZW50IHJhbmdlIGVuZHMgb24gb3IgYmVmb3JlIHRoZSBzdGFydGluZyByYW5nZSBlbmRzXG4gICAgKGN1cnJlbnRSYW5nZS5zdGFydCArIGN1cnJlbnRSYW5nZS5sZW5ndGgpIDw9XG4gICAgICAoc3RhcnRpbmdSYW5nZS5zdGFydCArIHN0YXJ0aW5nUmFuZ2UubGVuZ3RoKVxuICApO1xufVxuXG4vKipcbiAqIFN0ZXAgb3V0IG9mIHRoZSBjdXJyZW50IGZ1bmN0aW9uXG4gKlxuICogVGhpcyB3aWxsIHJ1biB1bnRpbCB0aGUgZGVidWdnZXIgZW5jb3VudGVycyBhIGRlY3JlYXNlIGluIGZ1bmN0aW9uIGRlcHRoLlxuICovXG5mdW5jdGlvbiogc3RlcE91dCAoKSB7XG4gIGlmICh5aWVsZCBzZWxlY3QoY29udHJvbGxlci5jdXJyZW50LmxvY2F0aW9uLmlzTXVsdGlsaW5lKSkge1xuICAgIHlpZWxkICpzdGVwT3ZlcigpO1xuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgc3RhcnRpbmdEZXB0aCA9IHlpZWxkIHNlbGVjdChjb250cm9sbGVyLmN1cnJlbnQuZnVuY3Rpb25EZXB0aCk7XG4gIHZhciBjdXJyZW50RGVwdGg7XG5cbiAgZG8ge1xuICAgIHlpZWxkKiBzdGVwTmV4dCgpO1xuXG4gICAgY3VycmVudERlcHRoID0geWllbGQgc2VsZWN0KGNvbnRyb2xsZXIuY3VycmVudC5mdW5jdGlvbkRlcHRoKTtcblxuICB9IHdoaWxlKGN1cnJlbnREZXB0aCA+PSBzdGFydGluZ0RlcHRoKTtcbn1cblxuLyoqXG4gKiBzdGVwT3ZlciAtIHN0ZXAgb3ZlciB0aGUgY3VycmVudCBsaW5lXG4gKlxuICogU3RlcCBvdmVyIHRoZSBjdXJyZW50IGxpbmUuIFRoaXMgd2lsbCBzdGVwIHRvIHRoZSBuZXh0IGluc3RydWN0aW9uIHRoYXRcbiAqIGV4aXN0cyBvbiBhIGRpZmZlcmVudCBsaW5lIG9mIGNvZGUgd2l0aGluIHRoZSBzYW1lIGZ1bmN0aW9uIGRlcHRoLlxuICovXG5mdW5jdGlvbiogc3RlcE92ZXIgKCkge1xuICBjb25zdCBzdGFydGluZ0RlcHRoID0geWllbGQgc2VsZWN0KGNvbnRyb2xsZXIuY3VycmVudC5mdW5jdGlvbkRlcHRoKTtcbiAgY29uc3Qgc3RhcnRpbmdSYW5nZSA9IHlpZWxkIHNlbGVjdChjb250cm9sbGVyLmN1cnJlbnQubG9jYXRpb24uc291cmNlUmFuZ2UpO1xuICB2YXIgY3VycmVudERlcHRoO1xuICB2YXIgY3VycmVudFJhbmdlO1xuXG4gIGRvIHtcbiAgICB5aWVsZCogc3RlcE5leHQoKTtcblxuICAgIGN1cnJlbnREZXB0aCA9IHlpZWxkIHNlbGVjdChjb250cm9sbGVyLmN1cnJlbnQuZnVuY3Rpb25EZXB0aCk7XG4gICAgY3VycmVudFJhbmdlID0geWllbGQgc2VsZWN0KGNvbnRyb2xsZXIuY3VycmVudC5sb2NhdGlvbi5zb3VyY2VSYW5nZSk7XG5cbiAgfSB3aGlsZSAoXG4gICAgLy8ga2VlcCBzdGVwcGluZyBwcm92aWRlZDpcbiAgICAvL1xuICAgIC8vIHdlIGhhdmVuJ3QganVtcGVkIG91dFxuICAgICEoY3VycmVudERlcHRoIDwgc3RhcnRpbmdEZXB0aCkgJiZcblxuICAgIC8vIGVpdGhlcjogZnVuY3Rpb24gZGVwdGggaXMgZ3JlYXRlciB0aGFuIHN0YXJ0aW5nIChpZ25vcmUgZnVuY3Rpb24gY2FsbHMpXG4gICAgLy8gb3IsIGlmIHdlJ3JlIGF0IHRoZSBzYW1lIGRlcHRoLCBrZWVwIHN0ZXBwaW5nIHVudGlsIHdlJ3JlIG9uIGEgbmV3XG4gICAgLy8gbGluZS5cbiAgICAoY3VycmVudERlcHRoID4gc3RhcnRpbmdEZXB0aCB8fFxuICAgICAgY3VycmVudFJhbmdlLmxpbmVzLnN0YXJ0LmxpbmUgPT0gc3RhcnRpbmdSYW5nZS5saW5lcy5zdGFydC5saW5lKVxuICApXG59XG5cbi8qKlxuICogY29udGludWVVbnRpbCAtIHN0ZXAgdGhyb3VnaCBleGVjdXRpb24gdW50aWwgYSBicmVha3BvaW50XG4gKlxuICogQHBhcmFtIGJyZWFrcG9pbnRzIC0gYXJyYXkgb2YgYnJlYWtwb2ludHMgKHsgLi4uY2FsbCwgbGluZSB9KVxuICovXG5mdW5jdGlvbiAqY29udGludWVVbnRpbCAoe2JyZWFrcG9pbnRzfSkge1xuICB2YXIgY3VycmVudENhbGw7XG4gIHZhciBjdXJyZW50TG9jYXRpb247XG5cbiAgbGV0IGJyZWFrcG9pbnRIaXQgPSBmYWxzZTtcblxuICBkbyB7XG4gICAgeWllbGQqIHN0ZXBOZXh0KCk7XG5cbiAgICBjdXJyZW50Q2FsbCA9IHlpZWxkIHNlbGVjdChjb250cm9sbGVyLmN1cnJlbnQuZXhlY3V0aW9uQ29udGV4dCk7XG4gICAgY3VycmVudExvY2F0aW9uID0geWllbGQgc2VsZWN0KGNvbnRyb2xsZXIuY3VycmVudC5sb2NhdGlvbik7XG5cbiAgICBicmVha3BvaW50SGl0ID0gYnJlYWtwb2ludHNcbiAgICAgIC5maWx0ZXIoICh7YWRkcmVzcywgYmluYXJ5LCBsaW5lLCBub2RlfSkgPT5cbiAgICAgICAgKFxuICAgICAgICAgIGFkZHJlc3MgPT0gY3VycmVudENhbGwuYWRkcmVzcyB8fFxuICAgICAgICAgIGJpbmFyeSA9PSBjdXJyZW50Q2FsbC5iaW5hcnlcbiAgICAgICAgKSAmJiAoXG4gICAgICAgICAgbGluZSA9PSBjdXJyZW50TG9jYXRpb24uc291cmNlUmFuZ2UubGluZXMuc3RhcnQubGluZSB8fFxuICAgICAgICAgIG5vZGUgPT0gY3VycmVudExvY2F0aW9uLm5vZGUuaWRcbiAgICAgICAgKVxuICAgICAgKVxuICAgICAgLmxlbmd0aCA+IDA7XG5cbiAgfSB3aGlsZSAoIWJyZWFrcG9pbnRIaXQpO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9jb250cm9sbGVyL3NhZ2FzL2luZGV4LmpzIiwiaW1wb3J0IGRlYnVnTW9kdWxlIGZyb20gXCJkZWJ1Z1wiO1xuY29uc3QgZGVidWcgPSBkZWJ1Z01vZHVsZShcImRlYnVnZ2VyOmNvbnRyb2xsZXI6c2FnYXNcIik7XG5cbmltcG9ydCB7IGNyZWF0ZVNlbGVjdG9yVHJlZSwgY3JlYXRlTGVhZiB9IGZyb20gXCJyZXNlbGVjdC10cmVlXCI7XG5cbmltcG9ydCBldm0gZnJvbSBcImxpYi9ldm0vc2VsZWN0b3JzXCI7XG5pbXBvcnQgc29saWRpdHkgZnJvbSBcImxpYi9zb2xpZGl0eS9zZWxlY3RvcnNcIjtcbmltcG9ydCBhc3QgZnJvbSBcImxpYi9hc3Qvc2VsZWN0b3JzXCI7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuY29uc3QgaWRlbnRpdHkgPSAoeCkgPT4geFxuXG4vKipcbiAqIGNvbnRyb2xsZXJcbiAqL1xuY29uc3QgY29udHJvbGxlciA9IGNyZWF0ZVNlbGVjdG9yVHJlZSh7XG5cbiAgLyoqXG4gICAqIGNvbnRyb2xsZXIuY3VycmVudFxuICAgKi9cbiAgY3VycmVudDoge1xuICAgIC8qKlxuICAgICAqIGNvbnRyb2xsZXIuY3VycmVudC5mdW5jdGlvbkRlcHRoXG4gICAgICovXG4gICAgZnVuY3Rpb25EZXB0aDogY3JlYXRlTGVhZihbc29saWRpdHkuY3VycmVudC5mdW5jdGlvbkRlcHRoXSwgaWRlbnRpdHkpLFxuXG4gICAgLyoqXG4gICAgICogY29udHJvbGxlci5jdXJyZW50LmV4ZWN1dGlvbkNvbnRleHRcbiAgICAgKi9cbiAgICBleGVjdXRpb25Db250ZXh0OiBjcmVhdGVMZWFmKFtldm0uY3VycmVudC5jYWxsXSwgaWRlbnRpdHkpLFxuXG4gICAgLyoqXG4gICAgICogY29udHJvbGxlci5jdXJyZW50LndpbGxKdW1wXG4gICAgICovXG4gICAgd2lsbEp1bXA6IGNyZWF0ZUxlYWYoW2V2bS5jdXJyZW50LnN0ZXAuaXNKdW1wXSwgaWRlbnRpdHkpLFxuXG4gICAgLyoqXG4gICAgICogY29udHJvbGxlci5jdXJyZW50LmxvY2F0aW9uXG4gICAgICovXG4gICAgbG9jYXRpb246IHtcbiAgICAgIC8qKlxuICAgICAgICogY29udHJvbGxlci5jdXJyZW50LmxvY2F0aW9uLnNvdXJjZVJhbmdlXG4gICAgICAgKi9cbiAgICAgIHNvdXJjZVJhbmdlOiBjcmVhdGVMZWFmKFtzb2xpZGl0eS5jdXJyZW50LnNvdXJjZVJhbmdlXSwgaWRlbnRpdHkpLFxuXG4gICAgICAvKipcbiAgICAgICAqIGNvbnRyb2xsZXIuY3VycmVudC5sb2NhdGlvbi5ub2RlXG4gICAgICAgKi9cbiAgICAgIG5vZGU6IGNyZWF0ZUxlYWYoW2FzdC5jdXJyZW50Lm5vZGVdLCBpZGVudGl0eSksXG5cbiAgICAgIC8qKlxuICAgICAgICogY29udHJvbGxlci5jdXJyZW50LmxvY2F0aW9uLmlzTXVsdGlsaW5lXG4gICAgICAgKi9cbiAgICAgIGlzTXVsdGlsaW5lOiBjcmVhdGVMZWFmKFtzb2xpZGl0eS5jdXJyZW50LmlzTXVsdGlsaW5lXSwgaWRlbnRpdHkpLFxuICAgIH1cbiAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGNvbnRyb2xsZXI7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL2NvbnRyb2xsZXIvc2VsZWN0b3JzL2luZGV4LmpzIiwiaW1wb3J0IGRlYnVnTW9kdWxlIGZyb20gXCJkZWJ1Z1wiO1xuY29uc3QgZGVidWcgPSBkZWJ1Z01vZHVsZShcImRlYnVnZ2VyOnNvbGlkaXR5OnNhZ2FzXCIpO1xuXG5pbXBvcnQgeyBjYWxsLCBwdXQsIHRha2UsIHNlbGVjdCB9IGZyb20gXCJyZWR1eC1zYWdhL2VmZmVjdHNcIjtcbmltcG9ydCB7IHByZWZpeE5hbWUgfSBmcm9tIFwibGliL2hlbHBlcnNcIjtcblxuaW1wb3J0ICogYXMgYWN0aW9ucyBmcm9tIFwiLi4vYWN0aW9uc1wiO1xuaW1wb3J0IHsgVElDSyB9IGZyb20gXCJsaWIvdHJhY2UvYWN0aW9uc1wiO1xuXG5pbXBvcnQgc29saWRpdHkgZnJvbSBcIi4uL3NlbGVjdG9yc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gKmFkZFNvdXJjZShzb3VyY2UsIHNvdXJjZVBhdGgsIGFzdCkge1xuICB5aWVsZCBwdXQoYWN0aW9ucy5hZGRTb3VyY2Uoc291cmNlLCBzb3VyY2VQYXRoLCBhc3QpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uICphZGRTb3VyY2VNYXAoYmluYXJ5LCBzb3VyY2VNYXApIHtcbiAgeWllbGQgcHV0KGFjdGlvbnMuYWRkU291cmNlTWFwKGJpbmFyeSwgc291cmNlTWFwKSk7XG59XG5cbmZ1bmN0aW9uKiBmdW5jdGlvbkRlcHRoU2FnYSAoKSB7XG4gIHdoaWxlICh0cnVlKSB7XG4gICAgeWllbGQgdGFrZShUSUNLKTtcbiAgICBkZWJ1ZyhcImdvdCBUSUNLXCIpO1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IHlpZWxkIHNlbGVjdChzb2xpZGl0eS5jdXJyZW50Lmluc3RydWN0aW9uKTtcbiAgICBkZWJ1ZyhcImluc3RydWN0aW9uOiAlb1wiLCBpbnN0cnVjdGlvbik7XG5cbiAgICBpZiAoeWllbGQgc2VsZWN0KHNvbGlkaXR5LmN1cnJlbnQud2lsbEp1bXApKSB7XG4gICAgICBsZXQganVtcERpcmVjdGlvbiA9IHlpZWxkIHNlbGVjdChzb2xpZGl0eS5jdXJyZW50Lmp1bXBEaXJlY3Rpb24pO1xuXG5cbiAgICAgIHlpZWxkIHB1dChhY3Rpb25zLmp1bXAoanVtcERpcmVjdGlvbikpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIHNhZ2EgKCkge1xuICB5aWVsZCBjYWxsKGZ1bmN0aW9uRGVwdGhTYWdhKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgcHJlZml4TmFtZShcInNvbGlkaXR5XCIsIHNhZ2EpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9zb2xpZGl0eS9zYWdhcy9pbmRleC5qcyIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tIFwiZGVidWdcIjtcbmNvbnN0IGRlYnVnID0gZGVidWdNb2R1bGUoXCJkZWJ1Z2dlcjpldm06c2FnYXNcIik7XG5cbmltcG9ydCB7IGNhbGwsIHB1dCwgdGFrZSwgc2VsZWN0IH0gZnJvbSBcInJlZHV4LXNhZ2EvZWZmZWN0c1wiO1xuaW1wb3J0IHsgcHJlZml4TmFtZSwga2VjY2FrMjU2IH0gZnJvbSBcImxpYi9oZWxwZXJzXCI7XG5cbmltcG9ydCB7IFRJQ0sgfSBmcm9tIFwibGliL3RyYWNlL2FjdGlvbnNcIjtcbmltcG9ydCAqIGFzIGFjdGlvbnMgZnJvbSBcIi4uL2FjdGlvbnNcIjtcblxuaW1wb3J0IGV2bSBmcm9tIFwiLi4vc2VsZWN0b3JzXCI7XG5cbi8qKlxuICogQWRkcyBFVk0gYnl0ZWNvZGUgY29udGV4dFxuICpcbiAqIEByZXR1cm4ge3N0cmluZ30gSUQgKDB4LXByZWZpeGVkIGtlY2NhayBvZiBiaW5hcnkpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiAqYWRkQ29udGV4dChjb250cmFjdE5hbWUsIGJpbmFyeSkge1xuICB5aWVsZCBwdXQoYWN0aW9ucy5hZGRDb250ZXh0KGNvbnRyYWN0TmFtZSwgYmluYXJ5KSk7XG5cbiAgcmV0dXJuIGtlY2NhazI1NihiaW5hcnkpO1xufVxuXG4vKipcbiAqIEFkZHMga25vd24gZGVwbG95ZWQgaW5zdGFuY2Ugb2YgYmluYXJ5IGF0IGFkZHJlc3NcbiAqXG4gKiBAcmV0dXJuIHtzdHJpbmd9IElEICgweC1wcmVmaXhlZCBrZWNjYWsgb2YgYmluYXJ5KVxuICovXG5leHBvcnQgZnVuY3Rpb24gKmFkZEluc3RhbmNlKGFkZHJlc3MsIGJpbmFyeSkge1xuICBsZXQgc2VhcmNoID0geWllbGQgc2VsZWN0KGV2bS5pbmZvLmJpbmFyaWVzLnNlYXJjaCk7XG4gIGxldCB7IGNvbnRleHQgfSA9IHNlYXJjaChiaW5hcnkpO1xuXG4gIHlpZWxkIHB1dChhY3Rpb25zLmFkZEluc3RhbmNlKGFkZHJlc3MsIGNvbnRleHQsIGJpbmFyeSkpO1xuXG4gIHJldHVybiBjb250ZXh0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24qIGJlZ2luKHsgYWRkcmVzcywgYmluYXJ5IH0pIHtcbiAgaWYgKGFkZHJlc3MpIHtcbiAgICB5aWVsZCBwdXQoYWN0aW9ucy5jYWxsKGFkZHJlc3MpKTtcbiAgfSBlbHNlIHtcbiAgICB5aWVsZCBwdXQoYWN0aW9ucy5jcmVhdGUoYmluYXJ5KSk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uKiBjYWxsc3RhY2tTYWdhICgpIHtcbiAgd2hpbGUgKHRydWUpIHtcbiAgICB5aWVsZCB0YWtlKFRJQ0spO1xuICAgIGRlYnVnKFwiZ290IFRJQ0tcIik7XG5cbiAgICBpZiAoeWllbGQgc2VsZWN0KGV2bS5jdXJyZW50LnN0ZXAuaXNDYWxsKSkge1xuICAgICAgZGVidWcoXCJnb3QgY2FsbFwiKTtcbiAgICAgIGxldCBhZGRyZXNzID0geWllbGQgc2VsZWN0KGV2bS5jdXJyZW50LnN0ZXAuY2FsbEFkZHJlc3MpO1xuXG4gICAgICB5aWVsZCBwdXQoYWN0aW9ucy5jYWxsKGFkZHJlc3MpKTtcblxuICAgIH0gZWxzZSBpZiAoeWllbGQgc2VsZWN0KGV2bS5jdXJyZW50LnN0ZXAuaXNDcmVhdGUpKSB7XG4gICAgICBkZWJ1ZyhcImdvdCBjcmVhdGVcIik7XG4gICAgICBsZXQgYmluYXJ5ID0geWllbGQgc2VsZWN0KGV2bS5jdXJyZW50LnN0ZXAuY3JlYXRlQmluYXJ5KTtcblxuICAgICAgeWllbGQgcHV0KGFjdGlvbnMuY3JlYXRlKGJpbmFyeSkpO1xuXG4gICAgfSBlbHNlIGlmICh5aWVsZCBzZWxlY3QoZXZtLmN1cnJlbnQuc3RlcC5pc0hhbHRpbmcpKSB7XG4gICAgICBkZWJ1ZyhcImdvdCByZXR1cm5cIik7XG4gICAgICB5aWVsZCBwdXQoYWN0aW9ucy5yZXR1cm5DYWxsKCkpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIHNhZ2EgKCkge1xuICB5aWVsZCBjYWxsKGNhbGxzdGFja1NhZ2EpO1xufVxuXG5leHBvcnQgZGVmYXVsdCBwcmVmaXhOYW1lKFwiZXZtXCIsIHNhZ2EpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi9ldm0vc2FnYXMvaW5kZXguanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6d2ViMzpzYWdhc1wiKTtcblxuaW1wb3J0IHsgYWxsLCB0YWtlRXZlcnksIGFwcGx5LCBmb3JrLCBqb2luLCB0YWtlLCBwdXQsIHNlbGVjdCB9IGZyb20gJ3JlZHV4LXNhZ2EvZWZmZWN0cyc7XG5pbXBvcnQgeyBwcmVmaXhOYW1lIH0gZnJvbSBcImxpYi9oZWxwZXJzXCI7XG5cbmltcG9ydCAqIGFzIGFjdGlvbnMgZnJvbSBcIi4uL2FjdGlvbnNcIjtcblxuaW1wb3J0IFdlYjNBZGFwdGVyIGZyb20gXCIuLi9hZGFwdGVyXCI7XG5cbmZ1bmN0aW9uKiBmZXRjaFRyYW5zYWN0aW9uSW5mbyhhZGFwdGVyLCB7dHhIYXNofSkge1xuICBkZWJ1ZyhcImluc3BlY3RpbmcgdHJhbnNhY3Rpb25cIik7XG4gIHZhciB0cmFjZTtcbiAgdHJ5IHtcbiAgICB0cmFjZSA9IHlpZWxkIGFwcGx5KGFkYXB0ZXIsIGFkYXB0ZXIuZ2V0VHJhY2UsIFt0eEhhc2hdKTtcbiAgfSBjYXRjaChlKSB7XG4gICAgZGVidWcoXCJwdXR0aW5nIGVycm9yXCIpO1xuICAgIHlpZWxkIHB1dChhY3Rpb25zLmVycm9yKGUpKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBkZWJ1ZyhcImdvdCB0cmFjZVwiKTtcbiAgeWllbGQgcHV0KGFjdGlvbnMucmVjZWl2ZVRyYWNlKHRyYWNlKSk7XG5cbiAgbGV0IHR4ID0geWllbGQgYXBwbHkoYWRhcHRlciwgYWRhcHRlci5nZXRUcmFuc2FjdGlvbiwgW3R4SGFzaF0pO1xuICBpZiAodHgudG8gJiYgdHgudG8gIT0gXCIweDBcIikge1xuICAgIHlpZWxkIHB1dChhY3Rpb25zLnJlY2VpdmVDYWxsKHthZGRyZXNzOiB0eC50b30pKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgcmVjZWlwdCA9IHlpZWxkIGFwcGx5KGFkYXB0ZXIsIGFkYXB0ZXIuZ2V0UmVjZWlwdCwgW3R4SGFzaF0pO1xuICBpZiAocmVjZWlwdC5jb250cmFjdEFkZHJlc3MpIHtcbiAgICB5aWVsZCBwdXQoYWN0aW9ucy5yZWNlaXZlQ2FsbCh7YmluYXJ5OiB0eC5pbnB1dH0pKTtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgXCJDb3VsZCBub3QgZmluZCBjb250cmFjdCBhc3NvY2lhdGVkIHdpdGggdHJhbnNhY3Rpb24uIFwiICtcbiAgICBcIlBsZWFzZSBtYWtlIHN1cmUgeW91J3JlIGRlYnVnZ2luZyBhIHRyYW5zYWN0aW9uIHRoYXQgZXhlY3V0ZXMgYSBcIiArXG4gICAgXCJjb250cmFjdCBmdW5jdGlvbiBvciBjcmVhdGVzIGEgbmV3IGNvbnRyYWN0LlwiXG4gICk7XG59XG5cbmZ1bmN0aW9uKiBmZXRjaEJpbmFyeShhZGFwdGVyLCB7YWRkcmVzc30pIHtcbiAgZGVidWcoXCJmZXRjaGluZyBiaW5hcnkgZm9yICVzXCIsIGFkZHJlc3MpO1xuICBsZXQgYmluYXJ5ID0geWllbGQgYXBwbHkoYWRhcHRlciwgYWRhcHRlci5nZXREZXBsb3llZENvZGUsIFthZGRyZXNzXSk7XG5cbiAgZGVidWcoXCJyZWNlaXZlZCBiaW5hcnkgZm9yICVzXCIsIGFkZHJlc3MpO1xuICB5aWVsZCBwdXQoYWN0aW9ucy5yZWNlaXZlQmluYXJ5KGFkZHJlc3MsIGJpbmFyeSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gKmluc3BlY3RUcmFuc2FjdGlvbih0eEhhc2gsIHByb3ZpZGVyKSB7XG4gIHlpZWxkIHB1dChhY3Rpb25zLmluaXQocHJvdmlkZXIpKTtcbiAgeWllbGQgcHV0KGFjdGlvbnMuaW5zcGVjdCh0eEhhc2gpKTtcblxuICBsZXQgYWN0aW9uID0geWllbGQgdGFrZSggKHt0eXBlfSkgPT5cbiAgICB0eXBlID09IGFjdGlvbnMuUkVDRUlWRV9UUkFDRSB8fCB0eXBlID09IGFjdGlvbnMuRVJST1JfV0VCM1xuICApO1xuICBkZWJ1ZyhcImFjdGlvbiAlb1wiLCBhY3Rpb24pO1xuXG4gIHZhciB0cmFjZTtcbiAgaWYgKGFjdGlvbi50eXBlID09IGFjdGlvbnMuUkVDRUlWRV9UUkFDRSkge1xuICAgIHRyYWNlID0gYWN0aW9uLnRyYWNlO1xuICAgIGRlYnVnKFwicmVjZWl2ZWQgdHJhY2VcIik7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHsgZXJyb3I6IGFjdGlvbi5lcnJvciB9O1xuICB9XG5cbiAgbGV0IHthZGRyZXNzLCBiaW5hcnl9ID0geWllbGQgdGFrZShhY3Rpb25zLlJFQ0VJVkVfQ0FMTCk7XG4gIGRlYnVnKFwicmVjZWl2ZWQgY2FsbFwiKTtcblxuICByZXR1cm4geyB0cmFjZSwgYWRkcmVzcywgYmluYXJ5IH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiAqb2J0YWluQmluYXJpZXMoYWRkcmVzc2VzKSB7XG4gIGxldCB0YXNrcyA9IHlpZWxkIGFsbChcbiAgICBhZGRyZXNzZXMubWFwKCAoYWRkcmVzcykgPT4gZm9yayhyZWNlaXZlQmluYXJ5LCBhZGRyZXNzKSApXG4gICk7XG5cbiAgZGVidWcoXCJyZXF1ZXN0aW5nIGJpbmFyaWVzXCIpO1xuICB5aWVsZCBhbGwoXG4gICAgYWRkcmVzc2VzLm1hcCggKGFkZHJlc3MpID0+IHB1dChhY3Rpb25zLmZldGNoQmluYXJ5KGFkZHJlc3MpKSApXG4gICk7XG5cbiAgbGV0IGJpbmFyaWVzID0gW107XG4gIGJpbmFyaWVzID0geWllbGQgYWxsKFxuICAgIHRhc2tzLm1hcCh0YXNrID0+IGpvaW4odGFzaykpXG4gICk7XG5cbiAgZGVidWcoXCJiaW5hcmllcyAlb1wiLCBiaW5hcmllcyk7XG5cbiAgcmV0dXJuIGJpbmFyaWVzO1xufVxuXG5mdW5jdGlvbiAqcmVjZWl2ZUJpbmFyeShhZGRyZXNzKSB7XG4gIGxldCB7YmluYXJ5fSA9IHlpZWxkIHRha2UoKGFjdGlvbikgPT4gKFxuICAgIGFjdGlvbi50eXBlID09IGFjdGlvbnMuUkVDRUlWRV9CSU5BUlkgJiZcbiAgICBhY3Rpb24uYWRkcmVzcyA9PSBhZGRyZXNzXG4gICkpO1xuICBkZWJ1ZyhcImdvdCBiaW5hcnkgZm9yICVzXCIsIGFkZHJlc3MpO1xuXG4gIHJldHVybiBiaW5hcnk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiogc2FnYSgpIHtcbiAgLy8gd2FpdCBmb3Igd2ViMyBpbml0IHNpZ25hbFxuICBsZXQge3Byb3ZpZGVyfSA9IHlpZWxkIHRha2UoYWN0aW9ucy5JTklUX1dFQjMpO1xuICBsZXQgYWRhcHRlciA9IG5ldyBXZWIzQWRhcHRlcihwcm92aWRlcik7XG5cbiAgeWllbGQgdGFrZUV2ZXJ5KGFjdGlvbnMuSU5TUEVDVCwgZmV0Y2hUcmFuc2FjdGlvbkluZm8sIGFkYXB0ZXIpO1xuICB5aWVsZCB0YWtlRXZlcnkoYWN0aW9ucy5GRVRDSF9CSU5BUlksIGZldGNoQmluYXJ5LCBhZGFwdGVyKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgcHJlZml4TmFtZShcIndlYjNcIiwgc2FnYSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL3dlYjMvc2FnYXMvaW5kZXguanMiLCJleHBvcnQgY29uc3QgSU5JVF9XRUIzID0gXCJJTklUX1dFQjNcIjtcbmV4cG9ydCBmdW5jdGlvbiBpbml0KHByb3ZpZGVyKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogSU5JVF9XRUIzLFxuICAgIHByb3ZpZGVyXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IElOU1BFQ1QgPSBcIklOU1BFQ1RfVFJBTlNBQ1RJT05cIjtcbmV4cG9ydCBmdW5jdGlvbiBpbnNwZWN0KHR4SGFzaCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IElOU1BFQ1QsXG4gICAgdHhIYXNoXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IEZFVENIX0JJTkFSWSA9IFwiRkVUQ0hfQklOQVJZXCI7XG5leHBvcnQgZnVuY3Rpb24gZmV0Y2hCaW5hcnkoYWRkcmVzcykge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IEZFVENIX0JJTkFSWSxcbiAgICBhZGRyZXNzXG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBSRUNFSVZFX0JJTkFSWSA9IFwiUkVDRUlWRV9CSU5BUllcIjtcbmV4cG9ydCBmdW5jdGlvbiByZWNlaXZlQmluYXJ5KGFkZHJlc3MsIGJpbmFyeSkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFJFQ0VJVkVfQklOQVJZLFxuICAgIGFkZHJlc3MsIGJpbmFyeVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBSRUNFSVZFX1RSQUNFID0gXCJSRUNFSVZFX1RSQUNFXCI7XG5leHBvcnQgZnVuY3Rpb24gcmVjZWl2ZVRyYWNlKHRyYWNlKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogUkVDRUlWRV9UUkFDRSxcbiAgICB0cmFjZVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBSRUNFSVZFX0NBTEwgPSBcIlJFQ0VJVkVfQ0FMTFwiO1xuZXhwb3J0IGZ1bmN0aW9uIHJlY2VpdmVDYWxsKHthZGRyZXNzLCBiaW5hcnl9KSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogUkVDRUlWRV9DQUxMLFxuICAgIGFkZHJlc3MsIGJpbmFyeVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBFUlJPUl9XRUIzID0gXCJFUlJPUl9XRUIzXCI7XG5leHBvcnQgZnVuY3Rpb24gZXJyb3IoZXJyb3IpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBFUlJPUl9XRUIzLFxuICAgIGVycm9yXG4gIH07XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL3dlYjMvYWN0aW9ucy9pbmRleC5qcyIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tIFwiZGVidWdcIjtcblxuaW1wb3J0IFdlYjMgZnJvbSBcIndlYjNcIjtcblxuY29uc3QgZGVidWcgPSBkZWJ1Z01vZHVsZShcImRlYnVnZ2VyOndlYjM6YWRhcHRlclwiKTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgV2ViM0FkYXB0ZXIge1xuICBjb25zdHJ1Y3Rvcihwcm92aWRlcikge1xuICAgIHRoaXMud2ViMyA9IG5ldyBXZWIzKHByb3ZpZGVyKTtcbiAgfVxuXG4gIGFzeW5jIGdldFRyYWNlKHR4SGFzaCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSggKGFjY2VwdCwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLndlYjMuY3VycmVudFByb3ZpZGVyLnNlbmQoe1xuICAgICAgICBqc29ucnBjOiBcIjIuMFwiLFxuICAgICAgICBtZXRob2Q6IFwiZGVidWdfdHJhY2VUcmFuc2FjdGlvblwiLFxuICAgICAgICBwYXJhbXM6IFt0eEhhc2gsIHt9XSxcbiAgICAgICAgaWQ6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgICB9LCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgICAgaWYgKGVycikgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgICBpZiAocmVzdWx0LmVycm9yKSByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcihyZXN1bHQuZXJyb3IubWVzc2FnZSkpO1xuICAgICAgICBkZWJ1ZyhcInJlc3VsdDogJW9cIiwgcmVzdWx0KTtcbiAgICAgICAgYWNjZXB0KHJlc3VsdC5yZXN1bHQuc3RydWN0TG9ncyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBhc3luYyBnZXRUcmFuc2FjdGlvbih0eEhhc2gpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoIChhY2NlcHQsIHJlamVjdCkgPT4ge1xuICAgICAgdGhpcy53ZWIzLmV0aC5nZXRUcmFuc2FjdGlvbih0eEhhc2gsIChlcnIsIHR4KSA9PiB7XG4gICAgICAgIGlmIChlcnIpIHJldHVybiByZWplY3QoZXJyKTtcblxuICAgICAgICByZXR1cm4gYWNjZXB0KHR4KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIGFzeW5jIGdldFJlY2VpcHQodHhIYXNoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKCAoYWNjZXB0LCByZWplY3QpID0+IHtcbiAgICAgIHRoaXMud2ViMy5ldGguZ2V0VHJhbnNhY3Rpb25SZWNlaXB0KHR4SGFzaCwgKGVyciwgcmVjZWlwdCkgPT4ge1xuICAgICAgICBpZiAoZXJyKSByZXR1cm4gcmVqZWN0KGVycik7XG5cbiAgICAgICAgcmV0dXJuIGFjY2VwdChyZWNlaXB0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBnZXREZXBsb3llZENvZGUgLSBnZXQgdGhlIGRlcGxveWVkIGNvZGUgZm9yIGFuIGFkZHJlc3MgZnJvbSB0aGUgY2xpZW50XG4gICAqIEBwYXJhbSAge1N0cmluZ30gYWRkcmVzc1xuICAgKiBAcmV0dXJuIHtTdHJpbmd9ICAgICAgICAgZGVwbG95ZWRCaW5hcnlcbiAgICovXG4gIGFzeW5jIGdldERlcGxveWVkQ29kZShhZGRyZXNzKSB7XG4gICAgZGVidWcoXCJnZXR0aW5nIGRlcGxveWVkIGNvZGUgZm9yICVzXCIsIGFkZHJlc3MpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgoYWNjZXB0LCByZWplY3QpID0+IHtcbiAgICAgIHRoaXMud2ViMy5ldGguZ2V0Q29kZShhZGRyZXNzLCAoZXJyLCBkZXBsb3llZEJpbmFyeSkgPT4ge1xuICAgICAgICBpZiAoZXJyKSBkZWJ1ZyhcImVycm9yOiAlb1wiLCBlcnIpO1xuICAgICAgICBpZiAoZXJyKSByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICAgIGRlYnVnKFwiZ290IGRlcGxveWVkIGNvZGUgZm9yICVzXCIsIGFkZHJlc3MpO1xuICAgICAgICBhY2NlcHQoZGVwbG95ZWRCaW5hcnkpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL3dlYjMvYWRhcHRlci5qcyIsImltcG9ydCB7IGNvbWJpbmVSZWR1Y2VycyB9IGZyb20gXCJyZWR1eFwiO1xuXG5pbXBvcnQgZGF0YSBmcm9tIFwibGliL2RhdGEvcmVkdWNlcnNcIjtcbmltcG9ydCBldm0gZnJvbSBcImxpYi9ldm0vcmVkdWNlcnNcIjtcbmltcG9ydCBzb2xpZGl0eSBmcm9tIFwibGliL3NvbGlkaXR5L3JlZHVjZXJzXCI7XG5pbXBvcnQgdHJhY2UgZnJvbSBcImxpYi90cmFjZS9yZWR1Y2Vyc1wiO1xuXG5pbXBvcnQgKiBhcyBhY3Rpb25zIGZyb20gXCIuL2FjdGlvbnNcIjtcblxuZXhwb3J0IGNvbnN0IFdBSVRJTkcgPSBcIldBSVRJTkdcIjtcbmV4cG9ydCBjb25zdCBBQ1RJVkUgPSBcIkFDVElWRVwiO1xuZXhwb3J0IGNvbnN0IEVSUk9SID0gXCJFUlJPUlwiO1xuZXhwb3J0IGNvbnN0IEZJTklTSEVEID0gXCJGSU5JU0hFRFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gc2Vzc2lvbihzdGF0ZSA9IFdBSVRJTkcsIGFjdGlvbikge1xuICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgY2FzZSBhY3Rpb25zLlJFQURZOlxuICAgICAgcmV0dXJuIEFDVElWRTtcblxuICAgIGNhc2UgYWN0aW9ucy5FUlJPUjpcbiAgICAgIHJldHVybiB7IGVycm9yOiBhY3Rpb24uZXJyb3IgfTtcblxuICAgIGNhc2UgYWN0aW9ucy5GSU5JU0g6XG4gICAgICByZXR1cm4gRklOSVNIRUQ7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHN0YXRlO1xuICB9XG59XG5cbmNvbnN0IHJlZHVjZVN0YXRlID0gY29tYmluZVJlZHVjZXJzKHtcbiAgc2Vzc2lvbixcbiAgZGF0YSxcbiAgZXZtLFxuICBzb2xpZGl0eSxcbiAgdHJhY2UsXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgcmVkdWNlU3RhdGU7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL3Nlc3Npb24vcmVkdWNlcnMuanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwiZGVidWdnZXI6ZGF0YTpyZWR1Y2Vyc1wiKTtcblxuaW1wb3J0IHsgY29tYmluZVJlZHVjZXJzIH0gZnJvbSBcInJlZHV4XCI7XG5cbmltcG9ydCAqIGFzIGFjdGlvbnMgZnJvbSBcIi4vYWN0aW9uc1wiO1xuXG5jb25zdCBERUZBVUxUX1NDT1BFUyA9IHtcbiAgYnlJZDoge31cbn07XG5cbmZ1bmN0aW9uIHNjb3BlcyhzdGF0ZSA9IERFRkFVTFRfU0NPUEVTLCBhY3Rpb24pIHtcbiAgdmFyIGNvbnRleHQ7XG4gIHZhciBzY29wZTtcbiAgdmFyIHZhcmlhYmxlcztcblxuICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgY2FzZSBhY3Rpb25zLlNDT1BFOlxuICAgICAgc2NvcGUgPSBzdGF0ZS5ieUlkW2FjdGlvbi5pZF0gfHwge307XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGJ5SWQ6IHtcbiAgICAgICAgICAuLi5zdGF0ZS5ieUlkLFxuXG4gICAgICAgICAgW2FjdGlvbi5pZF06IHtcbiAgICAgICAgICAgIC4uLnNjb3BlLFxuXG4gICAgICAgICAgICBpZDogYWN0aW9uLmlkLFxuICAgICAgICAgICAgc291cmNlSWQ6IGFjdGlvbi5zb3VyY2VJZCxcbiAgICAgICAgICAgIHBhcmVudElkOiBhY3Rpb24ucGFyZW50SWQsXG4gICAgICAgICAgICBwb2ludGVyOiBhY3Rpb24ucG9pbnRlclxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgY2FzZSBhY3Rpb25zLkRFQ0xBUkU6XG4gICAgICBzY29wZSA9IHN0YXRlLmJ5SWRbYWN0aW9uLm5vZGUuc2NvcGVdIHx8IHt9O1xuICAgICAgdmFyaWFibGVzID0gc2NvcGUudmFyaWFibGVzIHx8IFtdO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBieUlkOiB7XG4gICAgICAgICAgLi4uc3RhdGUuYnlJZCxcblxuICAgICAgICAgIFthY3Rpb24ubm9kZS5zY29wZV06IHtcbiAgICAgICAgICAgIC4uLnNjb3BlLFxuXG4gICAgICAgICAgICB2YXJpYWJsZXM6IFtcbiAgICAgICAgICAgICAgLi4udmFyaWFibGVzLFxuXG4gICAgICAgICAgICAgIHtuYW1lOiBhY3Rpb24ubm9kZS5uYW1lLCBpZDogYWN0aW9uLm5vZGUuaWR9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHN0YXRlO1xuICB9XG59XG5cbmNvbnN0IGluZm8gPSBjb21iaW5lUmVkdWNlcnMoe1xuICBzY29wZXNcbn0pO1xuXG5jb25zdCBERUZBVUxUX0FTU0lHTk1FTlRTID0ge1xuICBieUlkOiB7fVxufTtcblxuZnVuY3Rpb24gYXNzaWdubWVudHMoc3RhdGUgPSBERUZBVUxUX0FTU0lHTk1FTlRTLCBhY3Rpb24pIHtcbiAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgIGNhc2UgYWN0aW9ucy5BU1NJR046XG4gICAgICByZXR1cm4ge1xuICAgICAgICBieUlkOiB7XG4gICAgICAgICAgLi4uc3RhdGUuYnlJZCxcblxuICAgICAgICAgIC4uLk9iamVjdC5hc3NpZ24oe30sXG4gICAgICAgICAgICAuLi5PYmplY3QuZW50cmllcyhhY3Rpb24uYXNzaWdubWVudHMpLm1hcChcbiAgICAgICAgICAgICAgKFtpZCwgcmVmXSkgPT4gKHtcbiAgICAgICAgICAgICAgICBbaWRdOiB7XG4gICAgICAgICAgICAgICAgICAuLi5zdGF0ZS5ieUlkW2lkXSxcbiAgICAgICAgICAgICAgICAgIHJlZlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICApXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHN0YXRlO1xuICB9XG59O1xuXG5jb25zdCBwcm9jID0gY29tYmluZVJlZHVjZXJzKHtcbiAgYXNzaWdubWVudHNcbn0pO1xuXG5jb25zdCByZWR1Y2VyID0gY29tYmluZVJlZHVjZXJzKHtcbiAgaW5mbyxcbiAgcHJvY1xufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHJlZHVjZXI7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL2RhdGEvcmVkdWNlcnMuanMiLCJpbXBvcnQgeyBjb21iaW5lUmVkdWNlcnMgfSBmcm9tIFwicmVkdXhcIjtcblxuaW1wb3J0ICogYXMgYWN0aW9ucyBmcm9tIFwiLi9hY3Rpb25zXCI7XG5pbXBvcnQgeyBrZWNjYWsyNTYgfSBmcm9tIFwibGliL2hlbHBlcnNcIjtcblxuY29uc3QgREVGQVVMVF9DT05URVhUUyA9IHtcbiAgYnlDb250ZXh0OiB7fSxcbiAgYnlCaW5hcnk6IHt9XG59O1xuXG5mdW5jdGlvbiBjb250ZXh0cyhzdGF0ZSA9IERFRkFVTFRfQ09OVEVYVFMsIGFjdGlvbikge1xuICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgLypcbiAgICAgKiBBZGRpbmcgYSBuZXcgY29udGV4dFxuICAgICAqL1xuICAgIGNhc2UgYWN0aW9ucy5BRERfQ09OVEVYVDpcbiAgICAgIGxldCB7IGNvbnRyYWN0TmFtZSwgYmluYXJ5IH0gPSBhY3Rpb247XG5cbiAgICAgIGlmIChzdGF0ZS5ieUJpbmFyeVtiaW5hcnldKSB7XG4gICAgICAgIHJldHVybiBzdGF0ZTtcbiAgICAgIH1cblxuICAgICAgbGV0IGNvbnRleHQgPSBrZWNjYWsyNTYoYmluYXJ5KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYnlDb250ZXh0OiB7XG4gICAgICAgICAgLi4uc3RhdGUuYnlDb250ZXh0LFxuXG4gICAgICAgICAgW2NvbnRleHRdOiB7IGNvbnRleHQsIGJpbmFyeSwgY29udHJhY3ROYW1lIH1cbiAgICAgICAgfSxcblxuICAgICAgICBieUJpbmFyeToge1xuICAgICAgICAgIC4uLnN0YXRlLmJ5QmluYXJ5LFxuXG4gICAgICAgICAgW2JpbmFyeV06IHsgY29udGV4dDogY29udGV4dCB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAvKlxuICAgICAqIERlZmF1bHQgY2FzZVxuICAgICAqL1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gc3RhdGU7XG4gIH1cbn1cblxuY29uc3QgREVGQVVMVF9JTlNUQU5DRVMgPSB7XG4gIGJ5QWRkcmVzczoge30sXG4gIGJ5Q29udGV4dDoge31cbn1cblxuZnVuY3Rpb24gaW5zdGFuY2VzKHN0YXRlID0gREVGQVVMVF9JTlNUQU5DRVMsIGFjdGlvbikge1xuICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgLypcbiAgICAgKiBBZGRpbmcgYSBuZXcgYWRkcmVzcyBmb3IgY29udGV4dFxuICAgICAqL1xuICAgIGNhc2UgYWN0aW9ucy5BRERfSU5TVEFOQ0U6XG4gICAgICBsZXQgeyBhZGRyZXNzLCBjb250ZXh0LCBiaW5hcnkgfSA9IGFjdGlvbjtcblxuICAgICAgLy8gZ2V0IGtub3duIGFkZHJlc3NlcyBmb3IgdGhpcyBjb250ZXh0XG4gICAgICBsZXQgb3RoZXJJbnN0YW5jZXMgPSBzdGF0ZS5ieUNvbnRleHRbY29udGV4dF0gfHwgW107XG4gICAgICBsZXQgb3RoZXJBZGRyZXNzZXMgPSBvdGhlckluc3RhbmNlcy5tYXAoKHthZGRyZXNzfSkgPT4gYWRkcmVzcyk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGJ5QWRkcmVzczoge1xuICAgICAgICAgIC4uLnN0YXRlLmJ5QWRkcmVzcyxcblxuICAgICAgICAgIFthZGRyZXNzXTogeyBjb250ZXh0LCBiaW5hcnkgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGJ5Q29udGV4dDoge1xuICAgICAgICAgIC4uLnN0YXRlLmJ5Q29udGV4dCxcblxuICAgICAgICAgIC8vIHJlY29uc3RydWN0IGNvbnRleHQgaW5zdGFuY2VzIHRvIGluY2x1ZGUgbmV3IGFkZHJlc3NcbiAgICAgICAgICBbY29udGV4dF06IEFycmF5LmZyb20obmV3IFNldChvdGhlckFkZHJlc3NlcykuYWRkKGFkZHJlc3MpKVxuICAgICAgICAgICAgLm1hcCgoYWRkcmVzcykgPT4gKHthZGRyZXNzfSkpXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAvKlxuICAgICAqIERlZmF1bHQgY2FzZVxuICAgICAqL1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxufVxuXG5jb25zdCBpbmZvID0gY29tYmluZVJlZHVjZXJzKHtcbiAgY29udGV4dHMsXG4gIGluc3RhbmNlc1xufSk7XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxsc3RhY2soc3RhdGUgPSBbXSwgYWN0aW9uKSB7XG4gIHN3aXRjaChhY3Rpb24udHlwZSkge1xuICAgIGNhc2UgYWN0aW9ucy5DQUxMOlxuICAgICAgbGV0IGFkZHJlc3MgPSBhY3Rpb24uYWRkcmVzcztcbiAgICAgIHJldHVybiBzdGF0ZS5jb25jYXQoWyB7YWRkcmVzc30gXSk7XG5cbiAgICBjYXNlIGFjdGlvbnMuQ1JFQVRFOlxuICAgICAgY29uc3QgYmluYXJ5ID0gYWN0aW9uLmJpbmFyeTtcbiAgICAgIHJldHVybiBzdGF0ZS5jb25jYXQoWyB7YmluYXJ5fSBdKTtcblxuICAgIGNhc2UgYWN0aW9ucy5SRVRVUk46XG4gICAgICByZXR1cm4gc3RhdGUuc2xpY2UoMCwgLTEpOyAvLyBwb3BcblxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gc3RhdGU7XG4gIH07XG59XG5cbmNvbnN0IHByb2MgPSBjb21iaW5lUmVkdWNlcnMoe1xuICBjYWxsc3RhY2tcbn0pO1xuXG5jb25zdCByZWR1Y2VyID0gY29tYmluZVJlZHVjZXJzKHtcbiAgaW5mbyxcbiAgcHJvY1xufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHJlZHVjZXI7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbGliL2V2bS9yZWR1Y2Vycy5qcyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9hcnJheS9mcm9tXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL2FycmF5L2Zyb21cIlxuLy8gbW9kdWxlIGlkID0gODJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgY29tYmluZVJlZHVjZXJzIH0gZnJvbSBcInJlZHV4XCI7XG5cbmltcG9ydCB7IGtlY2NhazI1NiB9IGZyb20gXCJsaWIvaGVscGVyc1wiO1xuXG5pbXBvcnQgKiBhcyBhY3Rpb25zIGZyb20gXCIuL2FjdGlvbnNcIjtcblxuY29uc3QgREVGQVVMVF9TT1VSQ0VTID0ge1xuICBieUlkOiB7fVxufTtcblxuZnVuY3Rpb24gc291cmNlcyhzdGF0ZSA9IERFRkFVTFRfU09VUkNFUywgYWN0aW9uKSB7XG4gIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAvKlxuICAgICAqIEFkZGluZyBhIG5ldyBzb3VyY2VcbiAgICAgKi9cbiAgICBjYXNlIGFjdGlvbnMuQUREX1NPVVJDRTpcbiAgICAgIGxldCB7IGFzdCwgc291cmNlLCBzb3VyY2VQYXRoIH0gPSBhY3Rpb247XG5cbiAgICAgIGxldCBpZCA9IE9iamVjdC5rZXlzKHN0YXRlLmJ5SWQpLmxlbmd0aDtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYnlJZDoge1xuICAgICAgICAgIC4uLnN0YXRlLmJ5SWQsXG5cbiAgICAgICAgICBbaWRdOiB7XG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIGFzdCxcbiAgICAgICAgICAgIHNvdXJjZSxcbiAgICAgICAgICAgIHNvdXJjZVBhdGhcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIC8qXG4gICAgICogRGVmYXVsdCBjYXNlXG4gICAgICovXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBzdGF0ZTtcbiAgfVxufVxuXG5cbmNvbnN0IERFRkFVTFRfU09VUkNFTUFQUyA9IHtcbiAgYnlDb250ZXh0OiB7fVxufTtcblxuZnVuY3Rpb24gc291cmNlTWFwcyhzdGF0ZSA9IERFRkFVTFRfU09VUkNFTUFQUywgYWN0aW9uKSB7XG4gIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAvKlxuICAgICAqIEFkZGluZyBhIG5ldyBzb3VyY2VNYXBcbiAgICAgKi9cbiAgICBjYXNlIGFjdGlvbnMuQUREX1NPVVJDRU1BUDpcbiAgICAgIGxldCB7IGJpbmFyeSwgc291cmNlTWFwIH0gPSBhY3Rpb247XG4gICAgICBsZXQgY29udGV4dCA9IGtlY2NhazI1NihiaW5hcnkpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBieUNvbnRleHQ6IHtcbiAgICAgICAgICAuLi5zdGF0ZS5ieUNvbnRleHQsXG5cbiAgICAgICAgICBbY29udGV4dF06IHtcbiAgICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgICBzb3VyY2VNYXBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAvKlxuICAgICAqIERlZmF1bHQgQ2FzZVxuICAgICAqL1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gc3RhdGU7XG4gIH1cbn1cblxuY29uc3QgaW5mbyA9IGNvbWJpbmVSZWR1Y2Vycyh7XG4gIHNvdXJjZXMsXG4gIHNvdXJjZU1hcHNcbn0pO1xuXG5leHBvcnQgZnVuY3Rpb24gZnVuY3Rpb25EZXB0aChzdGF0ZSA9IDEsIGFjdGlvbikge1xuICBpZiAoYWN0aW9uLnR5cGUgPT09IGFjdGlvbnMuSlVNUCkge1xuICAgIGNvbnN0IGRlbHRhID0gc3BlbHVuayhhY3Rpb24uanVtcERpcmVjdGlvbilcbiAgICByZXR1cm4gc3RhdGUgKyBkZWx0YTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cbn1cblxuZnVuY3Rpb24gc3BlbHVuayhqdW1wKSB7XG4gIGlmIChqdW1wID09IFwiaVwiKSB7XG4gICAgcmV0dXJuIDE7XG4gIH0gZWxzZSBpZiAoanVtcCA9PSBcIm9cIikge1xuICAgIHJldHVybiAtMTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gMDtcbiAgfVxufVxuXG5jb25zdCBwcm9jID0gY29tYmluZVJlZHVjZXJzKHtcbiAgZnVuY3Rpb25EZXB0aFxufSk7XG5cbmNvbnN0IHJlZHVjZXIgPSBjb21iaW5lUmVkdWNlcnMoe1xuICBpbmZvLFxuICBwcm9jXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgcmVkdWNlcjtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsaWIvc29saWRpdHkvcmVkdWNlcnMuanMiLCJpbXBvcnQgeyBjb21iaW5lUmVkdWNlcnMgfSBmcm9tIFwicmVkdXhcIjtcblxuaW1wb3J0ICogYXMgYWN0aW9ucyBmcm9tIFwiLi9hY3Rpb25zXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBpbmRleChzdGF0ZSA9IDAsIGFjdGlvbikge1xuICBpZiAoYWN0aW9uLnR5cGUgPT0gYWN0aW9ucy5UT0NLIHx8IGFjdGlvbi50eXBlID09IGFjdGlvbnMuRU5EX09GX1RSQUNFKSB7XG4gICAgcmV0dXJuIHN0YXRlICsgMTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0ZXBzKHN0YXRlID0gbnVsbCwgYWN0aW9uKSB7XG4gIGlmIChhY3Rpb24udHlwZSA9PSBhY3Rpb25zLlNBVkVfU1RFUFMpIHtcbiAgICByZXR1cm4gYWN0aW9uLnN0ZXBzO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxufVxuXG5jb25zdCBpbmZvID0gY29tYmluZVJlZHVjZXJzKHtcbiAgc3RlcHNcbn0pXG5cbmNvbnN0IHByb2MgPSBjb21iaW5lUmVkdWNlcnMoe1xuICBpbmRleFxufSlcblxuY29uc3QgcmVkdWNlciA9IGNvbWJpbmVSZWR1Y2Vycyh7XG4gIGluZm8sXG4gIHByb2Ncbn0pO1xuXG5leHBvcnQgZGVmYXVsdCByZWR1Y2VyO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGxpYi90cmFjZS9yZWR1Y2Vycy5qcyIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tIFwiZGVidWdcIjtcbmNvbnN0IGRlYnVnID0gZGVidWdNb2R1bGUoXCJ0ZXN0OmNvbnRleHRcIik7XG5cbmltcG9ydCB7IGFzc2VydCB9IGZyb20gXCJjaGFpXCI7XG5cbmltcG9ydCBHYW5hY2hlIGZyb20gXCJnYW5hY2hlLWNsaVwiO1xuaW1wb3J0IFdlYjMgZnJvbSBcIndlYjNcIjtcblxuaW1wb3J0IHsgcHJlcGFyZUNvbnRyYWN0cyB9IGZyb20gXCIuL2hlbHBlcnNcIjtcbmltcG9ydCBEZWJ1Z2dlciBmcm9tIFwibGliL2RlYnVnZ2VyXCI7XG5cbmltcG9ydCBzZXNzaW9uU2VsZWN0b3IgZnJvbSBcImxpYi9zZXNzaW9uL3NlbGVjdG9yc1wiO1xuaW1wb3J0IHRyYWNlIGZyb20gXCJsaWIvdHJhY2Uvc2VsZWN0b3JzXCI7XG5cbmNvbnN0IF9fT1VURVIgPSBgXG5wcmFnbWEgc29saWRpdHkgXjAuNC4xODtcblxuaW1wb3J0IFwiLi9Jbm5lckNvbnRyYWN0LnNvbFwiO1xuXG5jb250cmFjdCBPdXRlckNvbnRyYWN0IHtcbiAgZXZlbnQgT3V0ZXIoKTtcblxuICBJbm5lckNvbnRyYWN0IGlubmVyO1xuXG4gIGZ1bmN0aW9uIE91dGVyQ29udHJhY3QoYWRkcmVzcyBfaW5uZXIpIHB1YmxpYyB7XG4gICAgaW5uZXIgPSBJbm5lckNvbnRyYWN0KF9pbm5lcik7XG4gIH1cblxuICBmdW5jdGlvbiBydW4oKSBwdWJsaWMge1xuICAgIGlubmVyLnJ1bigpO1xuXG4gICAgT3V0ZXIoKTtcbiAgfVxufVxuYDtcblxuY29uc3QgX19JTk5FUiA9IGBcbnByYWdtYSBzb2xpZGl0eSBeMC40LjE4O1xuXG5jb250cmFjdCBJbm5lckNvbnRyYWN0IHtcbiAgZXZlbnQgSW5uZXIoKTtcblxuICBmdW5jdGlvbiBydW4oKSBwdWJsaWMge1xuICAgIElubmVyKCk7XG4gIH1cbn1cbmA7XG5cbmNvbnN0IF9fTUlHUkFUSU9OID0gYFxubGV0IE91dGVyQ29udHJhY3QgPSBhcnRpZmFjdHMucmVxdWlyZShcIk91dGVyQ29udHJhY3RcIik7XG5sZXQgSW5uZXJDb250cmFjdCA9IGFydGlmYWN0cy5yZXF1aXJlKFwiSW5uZXJDb250cmFjdFwiKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihkZXBsb3llcikge1xuICByZXR1cm4gZGVwbG95ZXJcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBkZXBsb3llci5kZXBsb3koSW5uZXJDb250cmFjdCk7XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBJbm5lckNvbnRyYWN0LmRlcGxveWVkKCk7XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbihpbm5lcikge1xuICAgICAgcmV0dXJuIGRlcGxveWVyLmRlcGxveShPdXRlckNvbnRyYWN0LCBpbm5lci5hZGRyZXNzKTtcbiAgICB9KTtcbn07XG5gO1xuXG5sZXQgbWlncmF0aW9ucyA9IHtcbiAgXCIyX2RlcGxveV9jb250cmFjdHMuanNcIjogX19NSUdSQVRJT04sXG59O1xuXG5sZXQgc291cmNlcyA9IHtcbiAgXCJPdXRlckxpYnJhcnkuc29sXCI6IF9fT1VURVIsXG4gIFwiSW5uZXJDb250cmFjdC5zb2xcIjogX19JTk5FUixcbn07XG5cblxuZGVzY3JpYmUoXCJDb250ZXh0c1wiLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBwcm92aWRlcjtcbiAgdmFyIHdlYjM7XG5cbiAgdmFyIGFic3RyYWN0aW9ucztcbiAgdmFyIGFydGlmYWN0cztcblxuICBiZWZvcmUoXCJDcmVhdGUgUHJvdmlkZXJcIiwgYXN5bmMgZnVuY3Rpb24oKSB7XG4gICAgcHJvdmlkZXIgPSBHYW5hY2hlLnByb3ZpZGVyKHtzZWVkOiBcImRlYnVnZ2VyXCIsIGdhc0xpbWl0OiA3MDAwMDAwfSk7XG4gICAgd2ViMyA9IG5ldyBXZWIzKHByb3ZpZGVyKTtcbiAgfSk7XG5cbiAgYmVmb3JlKFwiUHJlcGFyZSBjb250cmFjdHMgYW5kIGFydGlmYWN0c1wiLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnRpbWVvdXQoMzAwMDApO1xuXG4gICAgbGV0IHByZXBhcmVkID0gYXdhaXQgcHJlcGFyZUNvbnRyYWN0cyhwcm92aWRlciwgc291cmNlcywgbWlncmF0aW9ucyk7XG4gICAgYWJzdHJhY3Rpb25zID0gcHJlcGFyZWQuYWJzdHJhY3Rpb25zO1xuICAgIGFydGlmYWN0cyA9IHByZXBhcmVkLmFydGlmYWN0cztcbiAgfSk7XG5cbiAgaXQoXCJyZXR1cm5zIHZpZXcgb2YgYWRkcmVzc2VzIGFmZmVjdGVkXCIsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgb3V0ZXIgPSBhd2FpdCBhYnN0cmFjdGlvbnMuT3V0ZXJDb250cmFjdC5kZXBsb3llZCgpO1xuICAgIGxldCBpbm5lciA9IGF3YWl0IGFic3RyYWN0aW9ucy5Jbm5lckNvbnRyYWN0LmRlcGxveWVkKCk7XG5cbiAgICAvLyBydW4gb3V0ZXIgY29udHJhY3QgbWV0aG9kXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IG91dGVyLnJ1bigpO1xuXG4gICAgYXNzZXJ0LmVxdWFsKDIsIHJlc3VsdC5yZWNlaXB0LmxvZ3MubGVuZ3RoLCBcIlRoZXJlIHNob3VsZCBiZSB0d28gbG9nc1wiKTtcblxuICAgIGxldCB0eEhhc2ggPSByZXN1bHQudHg7XG5cbiAgICBsZXQgYnVnZ2VyID0gYXdhaXQgRGVidWdnZXIuZm9yVHgodHhIYXNoLCB7XG4gICAgICBwcm92aWRlcixcbiAgICAgIGNvbnRyYWN0czogYXJ0aWZhY3RzXG4gICAgfSk7XG4gICAgZGVidWcoXCJkZWJ1Z2dlciByZWFkeVwiKTtcblxuICAgIGxldCBzZXNzaW9uID0gYnVnZ2VyLmNvbm5lY3QoKTtcblxuICAgIGxldCBhZmZlY3RlZEluc3RhbmNlcyA9IHNlc3Npb24udmlldyhzZXNzaW9uU2VsZWN0b3IuaW5mby5hZmZlY3RlZEluc3RhbmNlcyk7XG4gICAgZGVidWcoXCJhZmZlY3RlZEluc3RhbmNlczogJW9cIiwgYWZmZWN0ZWRJbnN0YW5jZXMpO1xuXG4gICAgbGV0IGFmZmVjdGVkQWRkcmVzc2VzID0gT2JqZWN0LmtleXMoYWZmZWN0ZWRJbnN0YW5jZXMpLm1hcChhZGRyZXNzID0+IGFkZHJlc3MudG9Mb3dlckNhc2UoKSk7XG5cbiAgICBhc3NlcnQuZXF1YWwoMiwgYWZmZWN0ZWRBZGRyZXNzZXMubGVuZ3RoKTtcblxuICAgIGFzc2VydC5pbmNsdWRlKFxuICAgICAgYWZmZWN0ZWRBZGRyZXNzZXMsIG91dGVyLmFkZHJlc3MudG9Mb3dlckNhc2UoKSxcbiAgICAgIFwiT3V0ZXJDb250cmFjdCBzaG91bGQgYmUgYW4gYWZmZWN0ZWQgYWRkcmVzc1wiXG4gICAgKTtcblxuICAgIGFzc2VydC5pbmNsdWRlKFxuICAgICAgYWZmZWN0ZWRBZGRyZXNzZXMsIGlubmVyLmFkZHJlc3MudG9Mb3dlckNhc2UoKSxcbiAgICAgIFwiSW5uZXJDb250cmFjdCBzaG91bGQgYmUgYW4gYWZmZWN0ZWQgYWRkcmVzc1wiXG4gICAgKTtcbiAgfSk7XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB0ZXN0L2NvbnRleHQuanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwidGVzdDpkYXRhOmRlY29kZVwiKTtcblxuaW1wb3J0IGV2bSBmcm9tIFwibGliL2V2bS9zZWxlY3RvcnNcIjtcblxuaW1wb3J0IHtcbiAgZ2VuZXJhdGVVaW50cywgZGVzY3JpYmVEZWNvZGluZ1xufSBmcm9tIFwiLi9oZWxwZXJzXCI7XG5cbmNvbnN0IHVpbnRzID0gZ2VuZXJhdGVVaW50cygpO1xuXG5mdW5jdGlvbiBnZW5lcmF0ZUFycmF5KGxlbmd0aCkge1xuICByZXR1cm4gWy4uLkFycmF5KGxlbmd0aCldXG4gICAgLm1hcCgoKSA9PiB1aW50cy5uZXh0KCkudmFsdWUpXG59XG5cbmNvbnN0IGZpeHR1cmVzID0gW3tcbiAgbmFtZTogXCJtdWx0aXBsZUZ1bGxXb3JkQXJyYXlcIixcbiAgdHlwZTogXCJ1aW50W11cIixcbiAgdmFsdWU6IGdlbmVyYXRlQXJyYXkoMykgIC8vIHRha2VzIHVwIDMgd2hvbGUgd29yZHNcbn0sIHtcbiAgbmFtZTogXCJ3aXRoaW5Xb3JkQXJyYXlcIixcbiAgdHlwZTogXCJ1aW50MTZbXVwiLFxuICB2YWx1ZTogZ2VuZXJhdGVBcnJheSgxMCkgIC8vIHRha2VzIHVwID4xLzIgd29yZFxufSwge1xuICBuYW1lOiBcIm11bHRpcGxlUGFydFdvcmRBcnJheVwiLFxuICB0eXBlOiBcInVpbnQ2NFtdXCIsXG4gIHZhbHVlOiBnZW5lcmF0ZUFycmF5KDkpICAvLyB0YWtlcyB1cCAyLjI1IHdvcmRzXG59LCB7XG4gIG5hbWU6IFwiaW5jb252ZW5pZW50bHlXb3JkT2Zmc2V0QXJyYXlcIixcbiAgdHlwZTogXCJ1aW50MjQwW11cIixcbiAgdmFsdWU6IGdlbmVyYXRlQXJyYXkoMykgIC8vIHRha2VzIHVwIH4yLjggd29yZHNcbn0sIHtcbiAgbmFtZTogXCJzaG9ydFN0cmluZ1wiLFxuICB0eXBlOiBcInN0cmluZ1wiLFxuICB2YWx1ZTogXCJoZWxsbyB3b3JsZFwiXG59LCB7XG4gIG5hbWU6IFwibG9uZ1N0cmluZ1wiLFxuICB0eXBlOiBcInN0cmluZ1wiLFxuICB2YWx1ZTogXCJzb2xpZGl0eSBhbGxvY2F0aW9uIGlzIGEgZnVuIGxlc3NvbiBpbiBlbmRpYW5uZXNzXCJcbn1dO1xuXG5cbmRlc2NyaWJlKFwiRGVjb2RpbmdcIiwgZnVuY3Rpb24oKSB7XG5cbiAgLypcbiAgICogU3RvcmFnZSBUZXN0c1xuICAgKi9cbiAgZGVzY3JpYmVEZWNvZGluZyhcbiAgICBcIlN0b3JhZ2UgVmFyaWFibGVzXCIsIGZpeHR1cmVzLCBldm0uY3VycmVudC5zdGF0ZS5zdG9yYWdlLFxuXG4gICAgKGNvbnRyYWN0TmFtZSkgPT4ge1xuICAgICAgcmV0dXJuIGBwcmFnbWEgc29saWRpdHkgXjAuNC4yMztcblxuY29udHJhY3QgJHtjb250cmFjdE5hbWV9IHtcblxuICBldmVudCBEb25lKCk7XG5cbiAgLy8gZGVjbGFyYXRpb25zXG4gICR7Zml4dHVyZXNcbiAgICAubWFwKCAoe3R5cGUsIG5hbWV9KSA9PiBgJHt0eXBlfSAke25hbWV9O2AgKVxuICAgIC5qb2luKFwiXFxuICBcIil9XG5cbiAgZnVuY3Rpb24gcnVuKCkgcHVibGljIHtcbiAgICAke2ZpeHR1cmVzXG4gICAgICAubWFwKCAoe25hbWUsIHZhbHVlfSkgPT4gYCR7bmFtZX0gPSAke0pTT04uc3RyaW5naWZ5KHZhbHVlKX07YCApXG4gICAgICAuam9pbihcIlxcbiAgICBcIil9XG5cbiAgICBlbWl0IERvbmUoKTtcbiAgfVxufVxuYCAgIH1cbiAgKTtcblxuICAvKlxuICAgKiBNZW1vcnkgVGVzdHNcbiAgICovXG4gIGRlc2NyaWJlRGVjb2RpbmcoXG4gICAgXCJNZW1vcnkgVmFyaWFibGVzXCIsIGZpeHR1cmVzLCBldm0uY3VycmVudC5zdGF0ZS5tZW1vcnksXG5cbiAgICAoY29udHJhY3ROYW1lKSA9PiB7XG4gICAgICBjb25zdCBzZXBhcmF0b3IgPSBcIjtcXG4gICAgXCI7XG5cbiAgICAgIGZ1bmN0aW9uIGRlY2xhcmVBc3NpZ24oe25hbWUsIHR5cGUsIHZhbHVlfSkge1xuICAgICAgICBpZiAodHlwZS5pbmRleE9mKFwiW11cIikgIT0gLTEpIHtcbiAgICAgICAgICAvLyBhcnJheSwgbXVzdCBgbmV3YFxuICAgICAgICAgIGxldCBkZWNsYXJlID0gYCR7dHlwZX0gbWVtb3J5ICR7bmFtZX0gPSBuZXcgJHt0eXBlfSgke3ZhbHVlLmxlbmd0aH0pYFxuICAgICAgICAgIGxldCBhc3NpZ25zID0gdmFsdWUubWFwKChrLCBpKSA9PiBgJHtuYW1lfVske2l9XSA9ICR7a31gKTtcbiAgICAgICAgICByZXR1cm4gYCR7ZGVjbGFyZX0ke3NlcGFyYXRvcn0ke2Fzc2lnbnMuam9pbihzZXBhcmF0b3IpfWBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gYCR7dHlwZX0gbWVtb3J5ICR7bmFtZX0gPSAke0pTT04uc3RyaW5naWZ5KHZhbHVlKX1gXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGBwcmFnbWEgc29saWRpdHkgXjAuNC4yMztcblxuY29udHJhY3QgJHtjb250cmFjdE5hbWV9IHtcblxuICBldmVudCBEb25lKCk7XG5cbiAgZnVuY3Rpb24gcnVuKCkgcHVibGljIHtcbiAgICB1aW50IGk7XG4gICAgLy8gZGVjbGFyYXRpb25zXG4gICAgJHtmaXh0dXJlcy5tYXAoZGVjbGFyZUFzc2lnbikuam9pbihzZXBhcmF0b3IpfTtcblxuICAgIGVtaXQgRG9uZSgpO1xuICB9XG59XG5gXG4gICAgfVxuICApO1xufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gdGVzdC9kYXRhL2RlY29kZS9kZWNvZGluZy5qcyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeVwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeVwiXG4vLyBtb2R1bGUgaWQgPSA4N1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwidGVzdDpkYXRhOmRlY29kZTp1dGlsc1wiKTtcblxuaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSBcImNoYWlcIjtcblxuaW1wb3J0IHsgQmlnTnVtYmVyIH0gZnJvbSBcImJpZ251bWJlci5qc1wiO1xuaW1wb3J0ICogYXMgdXRpbHMgZnJvbSBcImxpYi9kYXRhL2RlY29kZS91dGlsc1wiO1xuXG5kZXNjcmliZShcIlV0aWxzXCIsIGZ1bmN0aW9uKCkge1xuICBkZXNjcmliZShcInRvQmlnTnVtYmVyKClcIiwgZnVuY3Rpb24oKSB7XG4gICAgaXQoXCJyZXR1cm5zIGNvcnJlY3QgdmFsdWVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBsZXQgYnl0ZXMgPSBbMHhmNSwgMHhlMiwgMHhjNSwgMHgxN107XG4gICAgICBsZXQgZXhwZWN0ZWRWYWx1ZSA9IG5ldyBCaWdOdW1iZXIoXCJmNWUyYzUxN1wiLCAxNik7XG5cbiAgICAgIGxldCByZXN1bHQgPSB1dGlscy50b0JpZ051bWJlcihieXRlcyk7XG5cbiAgICAgIGFzc2VydC5lcXVhbChyZXN1bHQudG9TdHJpbmcoKSwgZXhwZWN0ZWRWYWx1ZS50b1N0cmluZygpKTtcbiAgICB9KVxuICB9KTtcblxuICBkZXNjcmliZShcInRvU2lnbmVkQmlnTnVtYmVyKClcIiwgZnVuY3Rpb24oKSB7XG4gICAgaXQoXCJyZXR1cm5zIGNvcnJlY3QgbmVnYXRpdmUgdmFsdWVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBsZXQgYnl0ZXMgPSBbMHhmNSwgMHhlMiwgMHhjNSwgMHgxN107ICAvLyBzdGFydHMgd2l0aCAwYjFcbiAgICAgIGxldCByYXcgPSBuZXcgQmlnTnVtYmVyKFwiZjVlMmM1MTdcIiwgMTYpO1xuICAgICAgbGV0IGJpdGZpcHBlZCA9IG5ldyBCaWdOdW1iZXIoXG4gICAgICAgIHJhdy50b1N0cmluZygyKVxuICAgICAgICAgIC5yZXBsYWNlKC8wL2csIFwieFwiKVxuICAgICAgICAgIC5yZXBsYWNlKC8xL2csIFwiMFwiKVxuICAgICAgICAgIC5yZXBsYWNlKC94L2csIFwiMVwiKSxcbiAgICAgICAgMlxuICAgICAgKTtcblxuICAgICAgbGV0IGV4cGVjdGVkVmFsdWUgPSBiaXRmaXBwZWQucGx1cygxKS5uZWdhdGVkKCk7XG5cbiAgICAgIGxldCByZXN1bHQgPSB1dGlscy50b1NpZ25lZEJpZ051bWJlcihieXRlcyk7XG5cbiAgICAgIGFzc2VydC5lcXVhbChyZXN1bHQudG9TdHJpbmcoKSwgZXhwZWN0ZWRWYWx1ZS50b1N0cmluZygpKTtcbiAgICB9KTtcblxuICAgIGl0KFwicmV0dXJucyBjb3JyZWN0IHBvc2l0aXZlIHZhbHVlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgbGV0IGJ5dGVzID0gWzB4MDUsIDB4ZTIsIDB4YzUsIDB4MTddOyAvLyBzdGFydHMgd2l0aCAwYjBcbiAgICAgIGxldCByYXcgPSBuZXcgQmlnTnVtYmVyKFwiMDVlMmM1MTdcIiwgMTYpO1xuICAgICAgbGV0IGV4cGVjdGVkVmFsdWUgPSByYXc7XG5cbiAgICAgIGxldCByZXN1bHQgPSB1dGlscy50b1NpZ25lZEJpZ051bWJlcihieXRlcyk7XG5cbiAgICAgIGFzc2VydC5lcXVhbChyZXN1bHQudG9TdHJpbmcoKSwgZXhwZWN0ZWRWYWx1ZS50b1N0cmluZygpKTtcbiAgICB9KVxuICB9KTtcblxuICBkZXNjcmliZShcInRvSGV4U3RyaW5nKClcIiwgZnVuY3Rpb24oKSB7XG4gICAgaXQoXCJyZXR1cm5zIGNvcnJlY3QgcmVwcmVzZW50YXRpb24gd2l0aCBmdWxsIGJ5dGVzXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgLy8gaWUsIDB4MDAgaW5zdGVhZCBvZiAweDBcbiAgICAgIGFzc2VydC5lcXVhbCh1dGlscy50b0hleFN0cmluZyhbMHgwNSwgMHgxMV0pLCBcIjB4MDUxMVwiKTtcbiAgICAgIGFzc2VydC5lcXVhbCh1dGlscy50b0hleFN0cmluZyhbMHhmZiwgMHgwMCwgMHhmZl0pLCBcIjB4ZmYwMGZmXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJhbGxvd3MgcmVtb3ZpbmcgbGVhZGluZyB6ZXJvZXNcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBhc3NlcnQuZXF1YWwodXRpbHMudG9IZXhTdHJpbmcoWzB4MDAsIDB4MDAsIDB4Y2NdLCB0cnVlKSwgXCIweGNjXCIpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHRlc3QvZGF0YS9kZWNvZGUvdXRpbHMuanMiLCJpbXBvcnQgZGVidWdNb2R1bGUgZnJvbSBcImRlYnVnXCI7XG5jb25zdCBkZWJ1ZyA9IGRlYnVnTW9kdWxlKFwidGVzdDpzb2xpZGl0eVwiKTtcblxuaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSBcImNoYWlcIjtcblxuaW1wb3J0IEdhbmFjaGUgZnJvbSBcImdhbmFjaGUtY2xpXCI7XG5pbXBvcnQgV2ViMyBmcm9tIFwid2ViM1wiO1xuXG5pbXBvcnQgeyBwcmVwYXJlQ29udHJhY3RzIH0gZnJvbSBcIi4vaGVscGVyc1wiO1xuaW1wb3J0IERlYnVnZ2VyIGZyb20gXCJsaWIvZGVidWdnZXJcIjtcblxuaW1wb3J0IGV2bSBmcm9tIFwibGliL2V2bS9zZWxlY3RvcnNcIjtcblxuXG5jb25zdCBfX09VVEVSID0gYFxucHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7XG5cbmltcG9ydCBcIi4vSW5uZXIuc29sXCI7XG5cbmNvbnRyYWN0IE91dGVyIHtcbiAgZXZlbnQgQ2FsbGVkKCk7XG5cbiAgSW5uZXIgaW5uZXI7XG5cbiAgZnVuY3Rpb24gT3V0ZXIoYWRkcmVzcyBfaW5uZXIpIHtcbiAgICBpbm5lciA9IElubmVyKF9pbm5lcik7XG4gIH1cblxuICBmdW5jdGlvbiBydW5TaW5nbGUoKSBwdWJsaWMge1xuICB9XG5cbiAgZnVuY3Rpb24gcnVuKCkgcHVibGljIHtcbiAgICBpbm5lci5ydW4oKTtcbiAgfVxufVxuYDtcblxuXG5jb25zdCBfX0lOTkVSID0gYFxucHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7XG5cbmNvbnRyYWN0IElubmVyIHtcbiAgZnVuY3Rpb24gcnVuKCkgcHVibGljIHtcbiAgfVxufVxuYDtcblxuY29uc3QgX19NSUdSQVRJT04gPSBgXG5sZXQgT3V0ZXIgPSBhcnRpZmFjdHMucmVxdWlyZShcIk91dGVyXCIpO1xubGV0IElubmVyID0gYXJ0aWZhY3RzLnJlcXVpcmUoXCJJbm5lclwiKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihkZXBsb3llcikge1xuICByZXR1cm4gZGVwbG95ZXJcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBkZXBsb3llci5kZXBsb3koSW5uZXIpO1xuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gSW5uZXIuZGVwbG95ZWQoKTtcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKGlubmVyKSB7XG4gICAgICByZXR1cm4gZGVwbG95ZXIuZGVwbG95KE91dGVyLCBpbm5lci5hZGRyZXNzKTtcbiAgICB9KTtcbn07XG5gO1xuXG5sZXQgc291cmNlcyA9IHtcbiAgXCJJbm5lci5zb2xcIjogX19JTk5FUixcbiAgXCJPdXRlci5zb2xcIjogX19PVVRFUixcbn1cblxubGV0IG1pZ3JhdGlvbnMgPSB7XG4gIFwiMl9kZXBsb3lfY29udHJhY3RzLmpzXCI6IF9fTUlHUkFUSU9OLFxufTtcblxuZGVzY3JpYmUoXCJFVk0gRGVidWdnaW5nXCIsIGZ1bmN0aW9uKCkge1xuICB2YXIgcHJvdmlkZXI7XG4gIHZhciB3ZWIzO1xuXG4gIHZhciBhYnN0cmFjdGlvbnM7XG4gIHZhciBhcnRpZmFjdHM7XG4gIHZhciBmaWxlcztcblxuICBiZWZvcmUoXCJDcmVhdGUgUHJvdmlkZXJcIiwgYXN5bmMgZnVuY3Rpb24oKSB7XG4gICAgcHJvdmlkZXIgPSBHYW5hY2hlLnByb3ZpZGVyKHtzZWVkOiBcImRlYnVnZ2VyXCIsIGdhc0xpbWl0OiA3MDAwMDAwfSk7XG4gICAgd2ViMyA9IG5ldyBXZWIzKHByb3ZpZGVyKTtcbiAgfSk7XG5cbiAgYmVmb3JlKFwiUHJlcGFyZSBjb250cmFjdHMgYW5kIGFydGlmYWN0c1wiLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnRpbWVvdXQoMzAwMDApO1xuXG4gICAgbGV0IHByZXBhcmVkID0gYXdhaXQgcHJlcGFyZUNvbnRyYWN0cyhwcm92aWRlciwgc291cmNlcywgbWlncmF0aW9ucylcbiAgICBhYnN0cmFjdGlvbnMgPSBwcmVwYXJlZC5hYnN0cmFjdGlvbnM7XG4gICAgYXJ0aWZhY3RzID0gcHJlcGFyZWQuYXJ0aWZhY3RzO1xuICAgIGZpbGVzID0gcHJlcGFyZWQuZmlsZXM7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiRnVuY3Rpb24gRGVwdGhcIiwgZnVuY3Rpb24oKSB7XG4gICAgaXQoXCJyZW1haW5zIGF0IDEgaW4gYWJzZW5jZSBvZiBjcm9zcy1jb250cmFjdCBjYWxsc1wiLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IG1heEV4cGVjdGVkID0gMTtcblxuICAgICAgbGV0IGluc3RhbmNlID0gYXdhaXQgYWJzdHJhY3Rpb25zLklubmVyLmRlcGxveWVkKCk7XG4gICAgICBsZXQgcmVjZWlwdCA9IGF3YWl0IGluc3RhbmNlLnJ1bigpO1xuICAgICAgbGV0IHR4SGFzaCA9IHJlY2VpcHQudHg7XG5cbiAgICAgIGxldCBidWdnZXIgPSBhd2FpdCBEZWJ1Z2dlci5mb3JUeCh0eEhhc2gsIHtcbiAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgIGZpbGVzLFxuICAgICAgICBjb250cmFjdHM6IGFydGlmYWN0c1xuICAgICAgfSk7XG5cbiAgICAgIGxldCBzZXNzaW9uID0gYnVnZ2VyLmNvbm5lY3QoKTtcbiAgICAgIHZhciBzdGVwcGVkOyAgLy8gc2Vzc2lvbiBzdGVwcGVycyByZXR1cm4gZmFsc2Ugd2hlbiBkb25lXG5cbiAgICAgIGRvIHtcbiAgICAgICAgc3RlcHBlZCA9IHNlc3Npb24uc3RlcE5leHQoKTtcblxuICAgICAgICBsZXQgYWN0dWFsID0gc2Vzc2lvbi52aWV3KGV2bS5jdXJyZW50LmNhbGxzdGFjaykubGVuZ3RoO1xuXG4gICAgICAgIGFzc2VydC5pc0F0TW9zdChhY3R1YWwsIG1heEV4cGVjdGVkKTtcblxuICAgICAgfSB3aGlsZShzdGVwcGVkKTtcblxuICAgIH0pO1xuXG4gICAgaXQoXCJ0cmFja3MgY2FsbHN0YWNrIGNvcnJlY3RseVwiLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICAgIC8vIHByZXBhcmVcbiAgICAgIGxldCBpbnN0YW5jZSA9IGF3YWl0IGFic3RyYWN0aW9ucy5PdXRlci5kZXBsb3llZCgpO1xuICAgICAgbGV0IHJlY2VpcHQgPSBhd2FpdCBpbnN0YW5jZS5ydW4oKTtcbiAgICAgIGxldCB0eEhhc2ggPSByZWNlaXB0LnR4O1xuXG4gICAgICBsZXQgYnVnZ2VyID0gYXdhaXQgRGVidWdnZXIuZm9yVHgodHhIYXNoLCB7XG4gICAgICAgIHByb3ZpZGVyLFxuICAgICAgICBmaWxlcyxcbiAgICAgICAgY29udHJhY3RzOiBhcnRpZmFjdHNcbiAgICAgIH0pO1xuXG4gICAgICBsZXQgc2Vzc2lvbiA9IGJ1Z2dlci5jb25uZWN0KCk7XG5cbiAgICAgIC8vIGZvbGxvdyBjYWxsc3RhY2sgbGVuZ3RoIHZhbHVlcyBpbiBsaXN0XG4gICAgICAvLyBzZWUgc291cmNlIGFib3ZlXG4gICAgICBsZXQgZXhwZWN0ZWREZXB0aFNlcXVlbmNlID0gWzEsMiwxLDBdO1xuICAgICAgbGV0IGFjdHVhbFNlcXVlbmNlID0gW3Nlc3Npb24udmlldyhldm0uY3VycmVudC5jYWxsc3RhY2spLmxlbmd0aF07XG5cbiAgICAgIHZhciBzdGVwcGVkO1xuXG4gICAgICBkbyB7XG4gICAgICAgIHN0ZXBwZWQgPSBzZXNzaW9uLnN0ZXBOZXh0KCk7XG5cbiAgICAgICAgbGV0IGN1cnJlbnREZXB0aCA9IHNlc3Npb24udmlldyhldm0uY3VycmVudC5jYWxsc3RhY2spLmxlbmd0aDtcbiAgICAgICAgbGV0IGxhc3RLbm93biA9IGFjdHVhbFNlcXVlbmNlW2FjdHVhbFNlcXVlbmNlLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGlmIChjdXJyZW50RGVwdGggIT09IGxhc3RLbm93bikge1xuICAgICAgICAgIGFjdHVhbFNlcXVlbmNlLnB1c2goY3VycmVudERlcHRoKTtcbiAgICAgICAgfVxuICAgICAgfSB3aGlsZShzdGVwcGVkKTtcblxuICAgICAgYXNzZXJ0LmRlZXBFcXVhbChhY3R1YWxTZXF1ZW5jZSwgZXhwZWN0ZWREZXB0aFNlcXVlbmNlKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB0ZXN0L2V2bS5qcyIsImltcG9ydCBkZWJ1Z01vZHVsZSBmcm9tIFwiZGVidWdcIjtcbmNvbnN0IGRlYnVnID0gZGVidWdNb2R1bGUoXCJ0ZXN0OnNvbGlkaXR5XCIpO1xuXG5pbXBvcnQgeyBhc3NlcnQgfSBmcm9tIFwiY2hhaVwiO1xuXG5pbXBvcnQgR2FuYWNoZSBmcm9tIFwiZ2FuYWNoZS1jbGlcIjtcbmltcG9ydCBXZWIzIGZyb20gXCJ3ZWIzXCI7XG5cbmltcG9ydCB7IHByZXBhcmVDb250cmFjdHMgfSBmcm9tIFwiLi9oZWxwZXJzXCI7XG5pbXBvcnQgRGVidWdnZXIgZnJvbSBcImxpYi9kZWJ1Z2dlclwiO1xuXG5pbXBvcnQgc29saWRpdHkgZnJvbSBcImxpYi9zb2xpZGl0eS9zZWxlY3RvcnNcIjtcblxuXG5jb25zdCBfX1NJTkdMRV9DQUxMID0gYFxucHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7XG5cbmNvbnRyYWN0IFNpbmdsZUNhbGwge1xuICBldmVudCBDYWxsZWQoKTtcblxuICBmdW5jdGlvbiBydW4oKSBwdWJsaWMge1xuICAgIENhbGxlZCgpO1xuICB9XG59XG5gO1xuXG5cbmNvbnN0IF9fTkVTVEVEX0NBTEwgPSBgcHJhZ21hIHNvbGlkaXR5IF4wLjQuMTg7XG5cbmNvbnRyYWN0IE5lc3RlZENhbGwge1xuICBldmVudCBGaXJzdCgpO1xuICBldmVudCBTZWNvbmQoKTtcblxuICAvLyBydW4oKVxuICAvLyAgIGZpcnN0KCkgICAgMVxuICAvLyAgICAgaW5uZXIoKSAgMlxuICAvLyAgICAgICBldmVudCAgM1xuICAvLyAgICAgICAgICAgICAgMlxuICAvLyAgIHNlY29uZCAgICAgMVxuICAvLyAgICAgZXZlbnQgICAgMlxuICAvLyAgICAgICAgICAgICAgMVxuICBmdW5jdGlvbiBydW4oKSBwdWJsaWMge1xuICAgIGZpcnN0KCk7XG4gICAgc2Vjb25kKCk7XG4gIH1cblxuICBmdW5jdGlvbiBmaXJzdCgpIHB1YmxpYyB7XG4gICAgaW5uZXIoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlubmVyKCkgcHVibGljIHtcbiAgICBGaXJzdCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2Vjb25kKCkgcHVibGljIHtcbiAgICBTZWNvbmQoKTtcbiAgfVxuXG59XG5gO1xuXG5cbmxldCBzb3VyY2VzID0ge1xuICBcIlNpbmdsZUNhbGwuc29sXCI6IF9fU0lOR0xFX0NBTEwsXG4gIFwiTmVzdGVkQ2FsbC5zb2xcIjogX19ORVNURURfQ0FMTCxcbn1cblxuXG5kZXNjcmliZShcIlNvbGlkaXR5IERlYnVnZ2luZ1wiLCBmdW5jdGlvbigpIHtcbiAgdmFyIHByb3ZpZGVyO1xuICB2YXIgd2ViMztcblxuICB2YXIgYWJzdHJhY3Rpb25zO1xuICB2YXIgYXJ0aWZhY3RzO1xuICB2YXIgZmlsZXM7XG5cbiAgYmVmb3JlKFwiQ3JlYXRlIFByb3ZpZGVyXCIsIGFzeW5jIGZ1bmN0aW9uKCkge1xuICAgIHByb3ZpZGVyID0gR2FuYWNoZS5wcm92aWRlcih7c2VlZDogXCJkZWJ1Z2dlclwiLCBnYXNMaW1pdDogNzAwMDAwMH0pO1xuICAgIHdlYjMgPSBuZXcgV2ViMyhwcm92aWRlcik7XG4gIH0pO1xuXG4gIGJlZm9yZShcIlByZXBhcmUgY29udHJhY3RzIGFuZCBhcnRpZmFjdHNcIiwgYXN5bmMgZnVuY3Rpb24oKSB7XG4gICAgdGhpcy50aW1lb3V0KDMwMDAwKTtcblxuICAgIGxldCBwcmVwYXJlZCA9IGF3YWl0IHByZXBhcmVDb250cmFjdHMocHJvdmlkZXIsIHNvdXJjZXMpXG4gICAgYWJzdHJhY3Rpb25zID0gcHJlcGFyZWQuYWJzdHJhY3Rpb25zO1xuICAgIGFydGlmYWN0cyA9IHByZXBhcmVkLmFydGlmYWN0cztcbiAgICBmaWxlcyA9IHByZXBhcmVkLmZpbGVzO1xuICB9KTtcblxuICBpdChcImV4cG9zZXMgZnVuY3Rpb25hbGl0eSB0byBzdG9wIGF0IGJyZWFrcG9pbnRzXCIsIGFzeW5jIGZ1bmN0aW9uKCkge1xuICAgIC8vIHByZXBhcmVcbiAgICBsZXQgaW5zdGFuY2UgPSBhd2FpdCBhYnN0cmFjdGlvbnMuTmVzdGVkQ2FsbC5kZXBsb3llZCgpO1xuICAgIGxldCByZWNlaXB0ID0gYXdhaXQgaW5zdGFuY2UucnVuKCk7XG4gICAgbGV0IHR4SGFzaCA9IHJlY2VpcHQudHg7XG5cbiAgICBsZXQgYnVnZ2VyID0gYXdhaXQgRGVidWdnZXIuZm9yVHgodHhIYXNoLCB7XG4gICAgICBwcm92aWRlcixcbiAgICAgIGZpbGVzLFxuICAgICAgY29udHJhY3RzOiBhcnRpZmFjdHNcbiAgICB9KTtcblxuICAgIGxldCBzZXNzaW9uID0gYnVnZ2VyLmNvbm5lY3QoKTtcblxuICAgIC8vIGF0IGBzZWNvbmQoKTtgXG4gICAgbGV0IGJyZWFrcG9pbnQgPSB7IFwiYWRkcmVzc1wiOiBpbnN0YW5jZS5hZGRyZXNzLCBsaW5lOiAxNiB9XG4gICAgbGV0IGJyZWFrcG9pbnRTdG9wcGVkID0gZmFsc2U7XG5cbiAgICBkbyB7XG4gICAgICBzZXNzaW9uLmNvbnRpbnVlVW50aWwoYnJlYWtwb2ludCk7XG5cbiAgICAgIGlmICghc2Vzc2lvbi5maW5pc2hlZCkge1xuICAgICAgICBsZXQgcmFuZ2UgPSBhd2FpdCBzZXNzaW9uLnZpZXcoc29saWRpdHkuY3VycmVudC5zb3VyY2VSYW5nZSk7XG4gICAgICAgIGFzc2VydC5lcXVhbChyYW5nZS5saW5lcy5zdGFydC5saW5lLCAxNik7XG5cbiAgICAgICAgYnJlYWtwb2ludFN0b3BwZWQgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgfSB3aGlsZSghc2Vzc2lvbi5maW5pc2hlZCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiRnVuY3Rpb24gRGVwdGhcIiwgZnVuY3Rpb24oKSB7XG4gICAgaXQoXCJyZW1haW5zIGF0IDEgaW4gYWJzZW5jZSBvZiBpbm5lciBmdW5jdGlvbiBjYWxsc1wiLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IG1heEV4cGVjdGVkID0gMTtcblxuICAgICAgbGV0IGluc3RhbmNlID0gYXdhaXQgYWJzdHJhY3Rpb25zLlNpbmdsZUNhbGwuZGVwbG95ZWQoKTtcbiAgICAgIGxldCByZWNlaXB0ID0gYXdhaXQgaW5zdGFuY2UucnVuKCk7XG4gICAgICBsZXQgdHhIYXNoID0gcmVjZWlwdC50eDtcblxuICAgICAgbGV0IGJ1Z2dlciA9IGF3YWl0IERlYnVnZ2VyLmZvclR4KHR4SGFzaCwge1xuICAgICAgICBwcm92aWRlcixcbiAgICAgICAgZmlsZXMsXG4gICAgICAgIGNvbnRyYWN0czogYXJ0aWZhY3RzXG4gICAgICB9KTtcblxuICAgICAgbGV0IHNlc3Npb24gPSBidWdnZXIuY29ubmVjdCgpO1xuICAgICAgdmFyIHN0ZXBwZWQ7ICAvLyBzZXNzaW9uIHN0ZXBwZXJzIHJldHVybiBmYWxzZSB3aGVuIGRvbmVcblxuICAgICAgZG8ge1xuICAgICAgICBzdGVwcGVkID0gc2Vzc2lvbi5zdGVwTmV4dCgpO1xuXG4gICAgICAgIGxldCBhY3R1YWwgPSBzZXNzaW9uLnZpZXcoc29saWRpdHkuY3VycmVudC5mdW5jdGlvbkRlcHRoKTtcblxuICAgICAgICBhc3NlcnQuaXNBdE1vc3QoYWN0dWFsLCBtYXhFeHBlY3RlZCk7XG5cbiAgICAgIH0gd2hpbGUoc3RlcHBlZCk7XG5cbiAgICB9KTtcblxuICAgIGl0KFwic3BlbHVua3MgY29ycmVjdGx5XCIsIGFzeW5jIGZ1bmN0aW9uKCkge1xuICAgICAgLy8gcHJlcGFyZVxuICAgICAgbGV0IGluc3RhbmNlID0gYXdhaXQgYWJzdHJhY3Rpb25zLk5lc3RlZENhbGwuZGVwbG95ZWQoKTtcbiAgICAgIGxldCByZWNlaXB0ID0gYXdhaXQgaW5zdGFuY2UucnVuKCk7XG4gICAgICBsZXQgdHhIYXNoID0gcmVjZWlwdC50eDtcblxuICAgICAgbGV0IGJ1Z2dlciA9IGF3YWl0IERlYnVnZ2VyLmZvclR4KHR4SGFzaCwge1xuICAgICAgICBwcm92aWRlcixcbiAgICAgICAgZmlsZXMsXG4gICAgICAgIGNvbnRyYWN0czogYXJ0aWZhY3RzXG4gICAgICB9KTtcblxuICAgICAgbGV0IHNlc3Npb24gPSBidWdnZXIuY29ubmVjdCgpO1xuXG4gICAgICAvLyBmb2xsb3cgZnVuY3Rpb25EZXB0aCB2YWx1ZXMgaW4gbGlzdFxuICAgICAgLy8gc2VlIHNvdXJjZSBhYm92ZVxuICAgICAgbGV0IGV4cGVjdGVkRGVwdGhTZXF1ZW5jZSA9IFsxLDIsMywyLDEsMiwxLDBdO1xuICAgICAgbGV0IGFjdHVhbFNlcXVlbmNlID0gW3Nlc3Npb24udmlldyhzb2xpZGl0eS5jdXJyZW50LmZ1bmN0aW9uRGVwdGgpXTtcblxuICAgICAgdmFyIHN0ZXBwZWQ7XG5cbiAgICAgIGRvIHtcbiAgICAgICAgc3RlcHBlZCA9IHNlc3Npb24uc3RlcE5leHQoKTtcblxuICAgICAgICBsZXQgY3VycmVudERlcHRoID0gc2Vzc2lvbi52aWV3KHNvbGlkaXR5LmN1cnJlbnQuZnVuY3Rpb25EZXB0aCk7XG4gICAgICAgIGxldCBsYXN0S25vd24gPSBhY3R1YWxTZXF1ZW5jZVthY3R1YWxTZXF1ZW5jZS5sZW5ndGggLSAxXTtcblxuICAgICAgICBpZiAoY3VycmVudERlcHRoICE9PSBsYXN0S25vd24pIHtcbiAgICAgICAgICBhY3R1YWxTZXF1ZW5jZS5wdXNoKGN1cnJlbnREZXB0aCk7XG4gICAgICAgIH1cbiAgICAgIH0gd2hpbGUoc3RlcHBlZCk7XG5cbiAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsU2VxdWVuY2UsIGV4cGVjdGVkRGVwdGhTZXF1ZW5jZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gdGVzdC9zb2xpZGl0eS5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUM3REE7Ozs7OztBQ0FBOzs7Ozs7QUNBQTs7Ozs7O0FDQUE7Ozs7OztBQ0FBOzs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7O0FDRUE7QUFZQTtBQUNBO0FBZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoQkE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUFMQTtBQUNBO0FBS0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBUEE7QUFDQTtBQVNBOzs7QUFHQTtBQUNBO0FBZEE7QUFDQTtBQWdCQTs7O0FBR0E7QUFDQTtBQXJCQTtBQUNBO0FBeUJBOzs7OztBQUtBO0FBQ0E7QUFoQ0E7QUFDQTtBQWtDQTs7O0FBR0E7QUFDQTtBQXZDQTtBQUNBO0FBeUNBOzs7OztBQUtBO0FBQ0E7QUFEQTtBQS9DQTtBQUNBO0FBbURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWRBO0FBQ0E7QUFpQkE7Ozs7O0FBS0E7QUFHQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUF2QkE7QUFzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQUE7QUFKQTtBQUNBO0FBS0E7OztBQUdBO0FBQ0E7OztBQUdBO0FBQUE7QUFKQTtBQUNBO0FBS0E7OztBQUdBO0FBQUE7QUFUQTtBQUNBO0FBVUE7OztBQUdBO0FBQ0E7QUFBQTtBQURBO0FBQ0E7QUFFQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFGQTtBQURBO0FBQ0E7QUFLQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBREE7QUFFQTtBQUFBO0FBRkE7QUFBQTtBQWZBO0FBUkE7QUFkQTtBQUNBO0FBNENBOzs7QUFHQTtBQUNBO0FBQ0E7OztBQUdBO0FBQUE7QUFMQTtBQUNBO0FBTUE7OztBQUdBO0FBR0E7QUFiQTtBQUNBO0FBZUE7OztBQUdBO0FBR0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRkE7QUFqQ0E7QUFDQTtBQXVDQTs7Ozs7QUFLQTtBQVFBO0FBQ0E7QUFEQTtBQXJEQTtBQUNBO0FBeURBOzs7QUFHQTtBQTdEQTtBQUNBO0FBK0RBOzs7QUFHQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFRQTtBQUNBO0FBREE7QUFmQTtBQUNBO0FBbUJBO0FBcEJBO0FBNUhBO0FBQ0E7QUFtSkE7Ozs7OztBQzVRQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7OztBQVBBO0FBQ0E7QUFPQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUpBO0FBSEE7QUFZQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFBQTtBQUpBO0FBQ0E7QUFLQTs7O0FBR0E7QUFDQTs7O0FBR0E7QUFBQTtBQUpBO0FBQ0E7QUFLQTs7O0FBR0E7QUFBQTtBQUFBO0FBVEE7QUFDQTtBQVdBOzs7QUFHQTtBQUNBO0FBQ0E7OztBQUdBO0FBR0E7QUFBQTtBQVJBO0FBQ0E7QUFVQTs7O0FBR0E7QUFBQTtBQWRBO0FBQ0E7QUFlQTs7O0FBR0E7QUFHQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUZBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFSQTtBQWFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUhBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUhBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUE5QkE7QUFuREE7QUFDQTtBQTZGQTs7O0FBR0E7QUFJQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFDQTtBQVBBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFRQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBZEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBY0E7QUFuSEE7QUFDQTtBQXNIQTs7O0FBR0E7QUFHQTtBQTdIQTtBQUNBO0FBK0hBOzs7QUFHQTtBQUdBO0FBQUE7QUF0SUE7QUFDQTtBQXdJQTs7O0FBR0E7QUFDQTtBQUNBOzs7QUFHQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFoS0E7QUFDQTtBQXVLQTs7O0FBR0E7QUFHQTtBQUFBO0FBOUtBO0FBQ0E7QUFnTEE7OztBQUdBO0FBQUE7QUFwTEE7QUFDQTtBQXFMQTs7O0FBR0E7QUFDQTtBQUFBO0FBREE7QUF6TEE7QUF4QkE7QUFDQTtBQXNOQTs7Ozs7O0FDL09BOzs7Ozs7QUNBQTs7Ozs7O0FDQUE7Ozs7OztBQ0FBOzs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDWUE7QUFrQkE7QUFVQTtBQVNBO0FBOEVBO0FBc0JBO0FBb0JBO0FBSUE7QUFJQTtBQXFCQTtBQWVBO0FBYUE7QUEwQ0E7QUF3QkE7QUFDQTtBQXJTQTtBQUNBOzs7QUFFQTtBQUNBO0FBQUE7QUFDQTs7Ozs7OztBQUpBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUFBO0FBQUE7QUFEQTtBQUlBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUZBO0FBREE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFNQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQVVBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQXdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZBO0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQURBO0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFEQTtBQUdBO0FBREE7QUFHQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFEQTtBQUdBO0FBQ0E7QUFQQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUN4VEE7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2VBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFYQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFhQTtBQUFBO0FBQ0E7QUFDQTtBQWZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQWlCQTtBQUNBO0FBbEJBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBdUJBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQTlCQTtBQWdDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFoQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBOzs7Ozs7QUFpREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7Ozs7OztBQW1CQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQVJBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBOzs7Ozs7QUFZQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQVJBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBOzs7Ozs7QUFZQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFsQkE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTs7Ozs7O0FBc0JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTs7Ozs7O0FBWUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTs7Ozs7O0FBV0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7Ozs7O0FBbEdBO0FBQ0E7QUF2REE7QUFDQTs7O0FBRUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFiQTtBQUNBO0FBb0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQzlEQTtBQUNBOzs7QUFFQTtBQUNBO0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7QUFSQTtBQUNBO0FBU0E7OztBQUdBO0FBQ0E7OztBQUdBO0FBQ0E7OztBQUdBO0FBQUE7QUFBQTtBQUpBO0FBQ0E7QUFNQTs7O0FBR0E7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFBQTtBQVJBO0FBQ0E7QUFVQTs7Ozs7QUFLQTtBQUNBO0FBQUE7QUFqQkE7QUFDQTtBQW1CQTs7Ozs7QUFLQTtBQUdBO0FBNUJBO0FBQ0E7QUE4QkE7Ozs7O0FBS0E7QUFDQTtBQURBO0FBQ0E7QUFyQ0E7QUFkQTtBQUNBO0FBMkRBOzs7Ozs7QUMxRUE7Ozs7OztBQ0FBOzs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQVNBO0FBQ0E7Ozs7QUFJQTtBQUFBO0FBQ0E7QUFBQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FBNEJBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTlCQTtBQUFBOzs7Ozs7QUFDQTtBQUNBO0FBSUE7OztBQU1BO0FBQ0E7Ozs7Ozs7Ozs7O0FBSUE7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUEwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7Ozs7O0FBR0E7Ozs7Ozs7Ozs7OztBQTNFQTs7Ozs7Ozs7Ozs7OztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUFBO0FBTkE7QUFDQTtBQU9BOzs7OztBQUtBO0FBQUE7QUFiQTtBQUNBO0FBY0E7Ozs7O0FBS0E7QUFDQTtBQXJCQTtBQUNBO0FBdUJBOzs7OztBQUtBO0FBQ0E7QUE5QkE7QUFDQTtBQWdDQTs7Ozs7QUFLQTtBQUNBO0FBREE7QUF0Q0E7QUFDQTtBQTJDQTs7Ozs7O0FDOUNBOzs7Ozs7Ozs7Ozs7QUNDQTtBQVFBO0FBUUE7QUFLQTtBQUtBO0FBS0E7QUFoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FDbENBOzs7Ozs7QUNBQTs7Ozs7O0FDQUE7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7QUNDQTtBQVFBO0FBT0E7QUFRQTtBQU9BO0FBL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDcENBO0FBQ0E7OztBQUVBO0FBQ0E7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBYkE7QUFDQTtBQWFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBOzs7QUFHQTtBQUdBO0FBQ0E7QUFEQTtBQVBBO0FBQ0E7QUFXQTs7O0FBR0E7QUFHQTtBQUVBO0FBRkE7QUFsQkE7QUFDQTtBQXVCQTs7O0FBR0E7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFJQTtBQUpBO0FBREE7QUFIQTtBQTNCQTtBQTBDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBREE7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQU5BO0FBQ0E7QUFRQTs7O0FBR0E7QUFDQTtBQUNBOzs7QUFHQTtBQUdBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFKQTtBQUZBO0FBSEE7QUFMQTtBQUNBO0FBdUJBOzs7OztBQUtBO0FBSUE7QUFBQTtBQUFBO0FBSkE7QUF6Q0E7QUFDQTtBQWlEQTs7O0FBR0E7QUFDQTtBQUNBOzs7QUFHQTtBQUFBO0FBQUE7QUFMQTtBQUNBO0FBT0E7OztBQUdBO0FBQ0E7QUFDQTs7O0FBR0E7QUFBQTtBQUFBO0FBTEE7QUFDQTtBQU9BOzs7QUFHQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBREE7QUFMQTtBQUNBO0FBU0E7OztBQUdBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOzs7OztBQUtBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBREE7QUFFQTtBQUpBO0FBQ0E7QUFNQTtBQVJBO0FBQ0E7QUFVQTtBQTVCQTtBQUNBO0FBK0JBOzs7OztBQUtBO0FBTUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFFQTtBQUxBO0FBM0NBO0FBQ0E7QUFvREE7Ozs7O0FBS0E7QUFNQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQU5BO0FBaEVBO0FBQ0E7QUE0RUE7QUFPQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFGQTtBQXBGQTtBQUNBO0FBMkZBO0FBNUZBO0FBdkJBO0FBQ0E7QUFzSEE7OztBQUdBO0FBQ0E7QUFDQTs7O0FBR0E7QUFMQTtBQTNNQTtBQUNBO0FBbU5BOzs7Ozs7QUNoUkE7Ozs7OztBQ0FBOzs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ1NBO0FBY0E7QUF5QkE7QUFDQTtBQWpEQTtBQUNBOzs7QUFFQTtBQUNBOzs7Ozs7O0FBSEE7QUFDQTtBQUlBOzs7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQU1BO0FBTkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFEQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFGQTtBQVBBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFIQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBREE7QUFFQTtBQUFBO0FBRkE7QUFHQTtBQUhBO0FBSUE7Ozs7Ozs7Ozs7OztBQ25FQTtBQVFBO0FBS0E7QUFLQTtBQUtBO0FBS0E7QUFLQTtBQU1BO0FBeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDN0JBO0FBSUE7QUFpRkE7QUFDQTtBQXRHQTtBQUNBOzs7QUFFQTtBQUNBO0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7OztBQUNBO0FBSUE7QUFJQTtBQTZFQTtBQUNBO0FBckdBO0FBQ0E7QUFjQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFDQTtBQW9DQTtBQUNBO0FBREE7QUFDQTtBQUVBO0FBQ0E7QUFEQTtBQUNBO0FBRUE7QUFDQTtBQURBO0FBRUE7QUFGQTtBQUdBO0FBSEE7QUFDQTtBQTVDQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBc0RBO0FBQ0E7QUF4REE7QUFDQTtBQXlEQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFGQTtBQUlBO0FBQ0E7QUEvREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBNEVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUxBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBU0E7Ozs7Ozs7Ozs7OztBQzlHQTtBQVFBO0FBUUE7QUFqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0VBO0FBaUNBO0FBSUE7QUFTQTtBQUNBO0FBdkVBO0FBQ0E7OztBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFjQTtBQU1BO0FBMkJBO0FBSUE7QUFTQTtBQUNBO0FBdEVBO0FBQ0E7QUFRQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBTUE7QUFBQTtBQURBO0FBRUE7QUFBQTtBQVBBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFMQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBTUE7QUFDQTtBQVJBO0FBQUE7QUFDQTtBQURBO0FBVUE7QUFDQTtBQVhBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFlQTtBQUNBO0FBakJBO0FBQUE7QUFDQTtBQURBO0FBbUJBO0FBQ0E7QUFwQkE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBMEJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUxBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBUUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFNQTs7Ozs7Ozs7Ozs7O0FDNUVBO0FBUUE7QUFTQTtBQWxCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOzs7Ozs7Ozs7Ozs7QUN0QkE7QUFRQTtBQVFBO0FBUUE7QUFRQTtBQWpDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7Ozs7QUFOQTtBQUNBO0FBTUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOzs7QUFHQTtBQUdBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFLQTtBQUNBO0FBTkE7QUFDQTtBQVFBO0FBRUE7QUFEQTtBQVpBO0FBSEE7QUFMQTtBQUpBO0FBQ0E7QUFrQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ1FBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFJQTtBQUFBO0FBQUE7QUFKQTtBQUFBO0FBQ0E7QUFEQTtBQU9BO0FBUEE7QUFBQTtBQUNBO0FBREE7QUFRQTtBQUNBO0FBVEE7QUFBQTtBQUNBO0FBREE7QUFXQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQXJCQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBOzs7Ozs7QUF5QkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBSkE7QUFLQTtBQUFBO0FBQ0E7QUFOQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7Ozs7O0FBN0RBO0FBdUVBO0FBQ0E7QUF2RkE7QUFDQTs7O0FBRUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBZkE7QUFDQTtBQWFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUlBO0FBSkE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUhBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFJQTtBQUxBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFxQ0E7QUFDQTtBQUNBO0FBR0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVFBO0FBQ0E7QUFDQTs7Ozs7O0FDekdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNUQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQWRBO0FBQ0E7QUFjQTtBQUNBO0FBNkJBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVFBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFGQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFKQTtBQUFBO0FBT0E7QUFDQTtBQUNBO0FBSEE7QUFDQTtBQVBBO0FBTUE7QUFNQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBSkE7QUFPQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBSUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQXJDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQXVDQTtBQUNBOzs7Ozs7QUNqSEE7Ozs7OztBQ0FBOzs7Ozs7QUNBQTs7Ozs7O0FDQUE7Ozs7OztBQ0FBOzs7Ozs7QUNBQTs7Ozs7O0FDQUE7Ozs7OztBQ0FBOzs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0FBO0FBQ0E7OztBQUVBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBZEE7QUFDQTtBQWNBOzs7QUFHQTtBQUNBOzs7Ozs7O0FBT0E7QUFBQTtBQUNBO0FBQUE7OztBQUdBO0FBQ0E7QUFMQTtBQUFBO0FBQUE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBTEE7QUFEQTtBQVNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7O0FBNkRBO0FBQ0E7QUFDQTs7O0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUF0REE7QUFDQTtBQUNBOzs7QUFNQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBM0RBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUtBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFsQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBbUNBO0FBQ0E7QUFEQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQXpGQTs7Ozs7O0FDbkJBOzs7Ozs7QUNBQTs7Ozs7O0FDQUE7Ozs7OztBQ0FBOzs7Ozs7Ozs7QUNBQTtBQUNBO0FBREE7QUFHQTtBQURBO0FBR0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ05BO0FBQ0E7Ozs7Ozs7QUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDT0E7QUF5Q0E7QUFDQTtBQWxEQTtBQUNBOzs7QUFHQTtBQUNBO0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQU5BO0FBQ0E7QUFDQTtBQUtBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBVEE7QUFZQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFGQTtBQURBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBRkE7QUFNQTtBQU5BO0FBQ0E7QUFRQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQy9FQTs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNpQkE7QUFDQTtBQWxCQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFxREE7QUFPQTtBQXFCQTtBQVVBO0FBTUE7QUFJQTtBQUlBO0FBQ0E7QUExSEE7QUFDQTtBQWVBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUxBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFPQTtBQVJBO0FBQ0E7QUFEQTtBQUNBO0FBVUE7QUFYQTtBQUNBO0FBREE7QUFDQTtBQWFBO0FBQ0E7QUFmQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBZ0JBO0FBQ0E7QUFDQTtBQUNBO0FBcEJBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBc0JBO0FBdkJBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBMkJBO0FBQ0E7QUE1QkE7QUFDQTtBQURBO0FBQ0E7QUE4QkE7QUFDQTtBQWhDQTtBQUNBO0FBREE7QUFDQTtBQWtDQTtBQUNBO0FBcENBO0FBQ0E7QUFEQTtBQUNBO0FBc0NBO0FBQ0E7QUF4Q0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQTJDQTtBQTVDQTtBQUFBO0FBOENBO0FBOUNBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBaURBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBSEE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFNQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQWJBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQWlCQTtBQWpCQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQW9CQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDNURBO0FBZ0JBO0FBQ0E7QUEvRUE7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBO0FBa0JBO0FBb0JBO0FBTUE7QUFJQTtBQWdCQTtBQUNBO0FBOUVBO0FBQ0E7QUFZQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWlCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUNBO0FBSUE7QUFDQTtBQU5BO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFPQTtBQVJBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFjQTtBQWRBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBbUJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUtBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFEQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBTkE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFlQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFGQTtBQUNBO0FBRkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQU1BOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDM0VBO0FBYUE7QUFrQ0E7QUE4RUE7QUFrSEE7QUFDQTtBQTFQQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7OztBQVBBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBREE7QUFHQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCQTtBQTBCQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQURBO0FBRkE7QUFDQTtBQU1BO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBSEE7QUFIQTtBQUNBO0FBV0E7QUF2QkE7QUFDQTtBQWdDQTtBQUNBO0FBQ0E7QUFDQTtBQXJFQTtBQXdFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBQ0E7QUFRQTtBQUNBO0FBRUE7QUFFQTtBQUdBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFkQTtBQWlCQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBbEJBO0FBQ0E7QUF1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFSQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUZBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUF0R0E7QUF3R0E7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVNBOzs7Ozs7Ozs7Ozs7QUN2UEE7QUFTQTtBQStCQTtBQUNBO0FBekRBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFMQTtBQUNBO0FBTUE7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3BEQTtBQXFDQTtBQUNBO0FBbkRBO0FBQ0E7OztBQUVBO0FBQ0E7QUFBQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7OztBQUpBO0FBQ0E7QUFLQTs7Ozs7O0FBTUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFxQkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFEQTtBQU9BO0FBRUE7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDMUZBO0FBUUE7QUFUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDZUE7QUFDQTtBQTdCQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBO0FBcUJBO0FBWUE7QUFrQ0E7QUEwQ0E7QUF3QkE7QUErQkE7QUFDQTtBQWhNQTtBQUNBO0FBV0E7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUlBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBR0E7QUFKQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQVVBO0FBQ0E7QUFGQTtBQUNBO0FBVkE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBZUE7QUFDQTtBQUNBOzs7O0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBSUE7Ozs7Ozs7QUFPQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFxQkE7Ozs7Ozs7Ozs7OztBQVlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBeUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFoQ0E7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBb0NBOzs7OztBQUtBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWlCQTs7Ozs7O0FBTUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFyQkE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBeUJBOzs7OztBQUtBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQVdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQURBO0FBQ0E7QUFiQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7Ozs7Ozs7Ozs7OztBQ2hNQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQVBBO0FBQ0E7QUFPQTs7O0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7O0FBR0E7QUFkQTtBQW5CQTtBQUxBO0FBQ0E7QUEwQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDakRBO0FBSUE7QUFvQkE7QUFDQTtBQXBDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQTtBQUlBO0FBSUE7QUFnQkE7QUFDQTtBQW5DQTtBQUNBO0FBU0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBSEE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBSUE7QUFDQTtBQU5BO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFlQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBOzs7Ozs7Ozs7Ozs7Ozs7OztBQ3ZCQTtBQVdBO0FBU0E7QUFRQTtBQXdCQTtBQUNBO0FBckVBO0FBQ0E7OztBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU1BO0FBV0E7QUFTQTtBQVFBO0FBd0JBO0FBQ0E7QUFwRUE7QUFDQTtBQVNBOzs7OztBQUtBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBS0E7Ozs7O0FBS0E7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBUUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFPQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBSkE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBS0E7QUFOQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVdBO0FBWkE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFpQkE7QUFsQkE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBdUJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBR0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDckJBO0FBdUJBO0FBOEJBO0FBQ0E7QUF6R0E7QUFDQTs7O0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQTtBQWlDQTtBQVFBO0FBdUJBO0FBb0JBO0FBVUE7QUFDQTtBQXhHQTtBQUNBO0FBUUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBS0E7QUFOQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBVUE7QUFYQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBZ0NBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFHQTtBQUpBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFPQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBSUE7QUFBQTtBQUpBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFNQTtBQUNBO0FBUkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVVBO0FBQ0E7QUFaQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFpQkE7QUFDQTtBQW5CQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQXNCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFGQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBSUE7QUFMQTtBQUFBO0FBT0E7QUFQQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFZQTtBQVpBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFjQTtBQUNBO0FBaEJBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBbUJBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBSUE7QUFDQTtBQU5BO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBU0E7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVFBOzs7Ozs7Ozs7Ozs7QUNoSEE7QUFRQTtBQVFBO0FBUUE7QUFRQTtBQVFBO0FBUUE7QUFqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3REQTtBQUNBOzs7QUFDQTtBQUNBOzs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBOzs7O0FBQ0E7Ozs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFEQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFjQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQURBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQVFBOzs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBREE7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBUUE7Ozs7OztBQUtBOzs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQURBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFqREE7Ozs7Ozs7Ozs7Ozs7QUNRQTtBQUNBO0FBZkE7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7QUFEQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBQ0E7QUFPQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3RDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBTEE7QUFDQTtBQUtBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQURBO0FBQ0E7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBTkE7QUFEQTtBQUNBO0FBZUE7QUFDQTtBQXhDQTtBQTBDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFIQTtBQUxBO0FBREE7QUFDQTtBQWdCQTtBQUNBO0FBcEJBO0FBc0JBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNUQTtBQUNBO0FBOUZBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTs7O0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQVBBO0FBQ0E7QUFhQTs7O0FBR0E7QUFDQTtBQS9CQTtBQWlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTs7O0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUtBO0FBTEE7QUFQQTtBQUNBO0FBZUE7OztBQUdBO0FBQ0E7QUEvQkE7QUFrQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFiQTtBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTs7Ozs7O0FDeEhBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDK0VBO0FBQ0E7QUFoRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTs7O0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNBO0FBUUE7OztBQWJBO0FBaUJBO0FBMUJBO0FBNEJBO0FBQ0E7QUFFQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTs7O0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFGQTtBQUpBO0FBQ0E7QUFVQTs7O0FBR0E7QUFDQTtBQXZCQTtBQXlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7Ozs7Ozs7Ozs7OztBQ3ZHQTtBQVFBO0FBQ0E7QUFiQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2pDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBWkE7QUFDQTtBQVlBO0FBQ0E7QUFxQkE7QUFDQTtBQVdBO0FBQ0E7QUFpQkE7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFOQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBT0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFGQTtBQUFBO0FBQ0E7QUFEQTtBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQVRBO0FBQUE7QUFZQTtBQUNBO0FBRkE7QUFDQTtBQVpBO0FBV0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQWhDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQW9DQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNwSUE7QUFDQTs7O0FBRUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBTEE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFIQTtBQUNBO0FBTUE7QUFDQTtBQUNBOzs7QUFHQTtBQUlBO0FBUUE7QUFBQTtBQUFBO0FBQUE7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQU1BO0FBQ0E7QUFFQTs7O0FBR0E7QUFJQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZUE7QUFFQTs7Ozs7O0FDL0dBOzs7Ozs7Ozs7QUNBQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBOzs7OztBQU5BO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDN0RBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBO0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7QUFYQTtBQUNBO0FBWUE7QUFDQTtBQXVCQTtBQUNBO0FBUUE7QUFDQTtBQWlCQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFJQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFBQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBUUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFIQTtBQUFBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFMQTtBQUFBO0FBUUE7QUFDQTtBQUNBO0FBSEE7QUFDQTtBQVJBO0FBT0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUF4QkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQTBCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBRkE7QUFBQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBSkE7QUFBQTtBQU9BO0FBQ0E7QUFDQTtBQUhBO0FBQ0E7QUFQQTtBQU1BO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWtDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7OztBQy9KQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7Ozs7O0FBWEE7QUFDQTtBQVlBO0FBQ0E7QUFZQTtBQUNBO0FBa0NBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFJQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFBQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBUUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFFQTtBQUZBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUpBO0FBQUE7QUFPQTtBQUNBO0FBQ0E7QUFIQTtBQUNBO0FBUEE7QUFNQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBakJBO0FBbUJBO0FBQ0E7QUFwQkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBc0JBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQTFCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBOEJBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBSEE7QUFBQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBTEE7QUFBQTtBQVFBO0FBQ0E7QUFDQTtBQUhBO0FBQ0E7QUFSQTtBQU9BO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBeEJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUEwQkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFFQTtBQUZBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUpBO0FBQUE7QUFPQTtBQUNBO0FBQ0E7QUFIQTtBQUNBO0FBUEE7QUFNQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFrQ0E7QUFDQTs7OztBIiwic291cmNlUm9vdCI6IiJ9